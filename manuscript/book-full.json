{
  "sections": [
    {
      "sectionTitle": "Introduction",
      "lectures": [
        {
          "lectureTitle": "Hello new friend 👋",
          "lectureBody": "    <h1 id=\"introduction\">Introduction</h1>\n    <p>Hello new friend! 👋</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/6300d21408f5e9f0c8f5698d266fb258.jpg\"\n        alt=\"This is me, Swizec\"\n      />\n      <figcaption>This is me, Swizec</figcaption>\n    </figure>\n    <p>\n      Welcome to what I hope is the best and most fun React and D3 learning\n      resource on the internet. No TODO apps here, just fun interactive stuff\n      that makes you look great at a dinner party.\n    </p>\n    <p>\n      After an hour with <em>React + D3</em>, you’ll know how to make React and\n      D3.js play together. You’ll know how to create composable data\n      visualizations. Understand <em>why</em> that’s a good idea, and you will\n      have the tools to build your own library of interactive visualization\n      components. Or use <em>and understand</em> somebody else’s.\n    </p>\n    <p>It’s going to be fun!</p>\n    <p>\n      I believe learning new tech should be exciting, so I did my best to\n      inject joy whenever I could.\n    </p>\n    <p>\n      250+ pages as a book, 8 example apps, near 8 hours of video, a bunch of\n      skill building blocks. 👌\n    </p>\n    <p>Going through this course you will:</p>\n    <ul>\n      <li>build a bunch of reusable visualization components</li>\n      <li>build an interactive data dashboard</li>\n      <li>learn about reusable animation components</li>\n      <li>learn the basics of D3.js</li>\n      <li>master React</li>\n      <li>learn the basics of Redux and MobX</li>\n      <li>look into rendering rich animations on canvas</li>\n      <li>explore React alternatives like Preact and Inferno</li>\n      <li>learn about server-side rendering</li>\n      <li>learn a few basics of data science</li>\n      <li>learn some WebGL and 3D rendering</li>\n    </ul>\n    <p>\n      You might be thinking\n      <em\n        >“How the hell does this all fit together to help me build interactive\n        graphs and charts?”</em\n      >. They’re building blocks!\n    </p>\n    <p>\n      First I will show you the basics. Stuff like how to make React and D3\n      like each other, how to approach rendering, what to do with state.\n    </p>\n    <p>Then you’ll build a big project to see how it all fits together.</p>\n    <p>\n      When you’re comfortable with React and D3 working together, I will show\n      you animation. Cool things like how to approach updating components with\n      fine grained control and how to do transitions. I’ll show you how tricks\n      from the gaming industry work on the web.\n    </p>\n    <p>Short on time? Don’t worry.</p>\n    <p>\n      The initial examples work in CodeSandbox, a web-based IDE. Read the\n      explanation, run the code, master enough React to be dangerous. You won’t\n      even have to leave the browser.\n    </p>\n    <p>\n      In about an hour, you’ll know React and D3 well enough to explore on your\n      own, to sell the tech to your boss and your team, and to assess if the\n      React+D3 combination fits your needs.\n    </p>\n    <p>I believe learning new tech should be exciting.</p>\n    <h1 id=\"foreword\">Foreword</h1>\n    <p>\n      I wrote the first version of React+D3 in Spring 2015 as a dare. Can I\n      learn a thing and write a book in a month? Yes.\n    </p>\n    <p>\n      That first version was 91 pages long and sold a few hundred copies. Great\n      success!\n    </p>\n    <p>\n      You are reading, and watching, the pinnacle of how this material has\n      evolved over almost 4 years. 4 years I’ve been working on this. Not every\n      day, not all the time.\n    </p>\n    <p>\n      Little experiments here and there, launches and relaunches about once a\n      year. Learning how to do video, exploring new approaches, hosting\n      in-person workshops.\n    </p>\n    <p>A lot has changed.</p>\n    <p>\n      React isn’t what it used to be. The internals are different, the API is\n      easier to use. Hooks just flipped everything on its head all over again.\n      Suspense and async rendering are here and getting even better.\n    </p>\n    <p>\n      D3 has seen less change, but still went through major improvements. It’s\n      easier to use now. Easier to understand. More modern.\n    </p>\n    <p>\n      It feels like the web development world is a different place in late 2018\n      than it was in early 2015. It really does. Look at my code from 3 years\n      ago and I think\n      <em>“What!? We used to live like this? This is horrible”</em>\n    </p>\n    <p>\n      Almost 200 people bought this version of React+D3 in preorders alone. It\n      started as a book update and grew into a proper online course.\n    </p>\n    <p>\n      If you’re one of those early supporters, thank you! You are the best.\n      Without you this never would have happened. 🙏\n    </p>\n    <hr />\n    <p>\n      Because I think it’s interesting, here’s what I had to say about that\n      first version back in 2015:\n    </p>\n    <blockquote>\n      <p>\n        I wrote this book for you as an experiment. The theory we’re testing is\n        that technical content works better as a short e-book than as a long\n        article.\n      </p>\n    </blockquote>\n    <blockquote>\n      <p>\n        You see, the issue with online articles is that they live and die by\n        their length. As soon as you surpass 700 words, everything falls apart.\n        Readers wander off to a different tab in search of memes and funny\n        tweets, never to come back.\n      </p>\n    </blockquote>\n    <blockquote>\n      <p>\n        This hurts my precious writer’s ego, but more importantly, it sucks for\n        you. If you’re not reading, you’re not learning.\n      </p>\n    </blockquote>\n    <blockquote>\n      <p>So here we both are.</p>\n    </blockquote>\n    <blockquote>\n      <p>\n        I’m counting on you to take some time away from the internet, to sit\n        down and read. I’m counting on you to follow the examples. I’m counting\n        on you to <em>learn</em>.\n      </p>\n    </blockquote>\n    <blockquote>\n      <p>\n        You’re counting on me to have invested more time, effort, and care in\n        crafting this than I would have invested in an article. I have.\n      </p>\n    </blockquote>\n    <blockquote>\n      <p>\n        I’ve tried to keep this book as concise as possible. iA Writer\n        estimates it will take you about an hour to read <em>React+d3.js</em>,\n        but playing with the examples might take some time, too.\n      </p>\n    </blockquote>\n    <p>\n      A lot of that still rings true. People are distracted, busy, the internet\n      is shiny. It’s hard to sit down and learn stuff.\n    </p>\n    <p>\n      The most common feedback I get from students goes something like this 👇\n    </p>\n    <blockquote>\n      <p>\n        Loving your book! It’s amazing. So clear and concise and relatable. But\n        I read 20 pages, then my wife had a kid, my boss pulled the project,\n        and I’m doing backend now. But truly amazing. I’m gonna get back to it\n        as soon as I can!\n      </p>\n    </blockquote>\n    <p>Sometimes they do.</p>\n    <p>\n      That’s okay. Life happens. I understand. Hell, I procrastinated for\n      months before sitting down to update this stuff 😃\n    </p>\n    <p>\n      I recommend you go through the basic chapters at least. The little\n      building blocks. You can do that in an afternoon or two. It’s worth it, I\n      promise.\n    </p>"
        },
        {
          "lectureTitle": "What you need to know",
          "lectureBody": "    <h1 id=\"what-you-need-to-know\">What you need to know</h1>\n    <p>\n      I’m going to assume you already know how to code and that you’re great\n      with JavaScript. Many books have been written to teach the basics of\n      JavaScript; this is not one of them.\n    </p>\n    <p>\n      If you’re struggling with modern JavaScript syntax, I suggest visiting my\n      <a href=\"https://es6cheatsheet.com\">Interactive ES6 Cheatsheet</a>\n    </p>\n    <p>\n      I’m assuming you’ve tried D3 before, or at least heard of it. You don’t\n      have to know how D3 works, or understand what the code you copy pasted to\n      meet a deadline does. I’ll show you all you need to know.\n    </p>\n    <p>\n      If you want to learn D3 in depth, there’s plenty of great resources out\n      there. For example, the third edition of my first ever book,\n      <a\n        href=\"https://www.packtpub.com/web-development/d3js-4x-data-visualization-third-edition\"\n        >D3.js 4.x Data Visualization - Third Edition</a\n      >. Written by Ændrew Rininsland with some chapters left from yours truly.\n    </p>\n    <p>\n      As for React, same deal: I expect you have some idea how to use it, but\n      you’ll be fine even if this is your first time looking at React. We’ll go\n      through everything you need to know as it’s happening.\n    </p>\n    <p>\n      All examples in React + D3 use modern JavaScript. That is JavaScript from\n      ES6 – ES2015 – and beyond. No special mods, just stuff you get by default\n      in all React projects in recent years. Even if some syntax isn’t in the\n      standard yet.\n    </p>\n    <p>I’m going to explain any new syntax that we use.</p>"
        },
        {
          "lectureTitle": "How to approach React for Dataviz",
          "lectureBody": "    <h2 id=\"how-to-approach-react-for-data-visualization\">\n      How to approach React for Data Visualization\n    </h2>\n    <p>\n      I recommend starting with an idea, a problem. Something you want to\n      build. A dataset you want to play with. A feature you want to add to your\n      app.\n    </p>\n    <p>\n      That makes it easier. Helps focus your brain. Notice things in this\n      course that help <em>you</em> specifically.\n    </p>\n    <p>\n      From there, I think you should see how much time you’ve got. The course\n      is designed so you can go over the important stuff in a couple hours.\n      Watch a video, read some text, try some code. See how it feels.\n    </p>\n    <p>\n      If the best way is a daily practice, 20 minutes after work, 5 minutes on\n      the pooper, do that. If you’re more of a sit down and cram it out kind of\n      person, a nice Sunday afternoon with some coffee will do just fine.\n    </p>\n    <p>But don’t make it a chore. We’re here to have fun 😃</p>\n    <p>Two suggestions ✌️:</p>\n    <ol type=\"1\">\n      <li>\n        <em>Try</em> the example code. Don’t just copy-paste; type it and\n        execute it. Execute frequently. If something doesn’t fit together, look\n        at the linked Github repositories or solved CodeSandboxes. Each project\n        has one.\n      </li>\n      <li>If you know something, skip that section. You’re awesome. ❤️</li>\n    </ol>\n    <p>React + D3 is based on code samples. They look like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb1\"\n      data-caption=\"Some code\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb1-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> foo <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;bar&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb1-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">foo <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;more stuff&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Each code sample starts with a commented out file path. That’s the file\n      you’re editing. Like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb2\"\n      data-caption=\"Code samples have file paths\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb2-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ./src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb2-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb2-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> <span class=\"va\" style=\"color: #19177c;\">App</span> ...</a></code></pre>\n    </div>\n    <p>\n      Commands that you should run in the terminal start with an\n      <code style=\"white-space: pre-wrap;\">$</code> symbol, like this:\n    </p>\n    <pre><code style=\"white-space: pre-wrap;\">$ npm start</code></pre>"
        },
        {
          "lectureTitle": "Why React and D3",
          "lectureBody": "    <h1 id=\"why-react-and-d3\">Why React and D3</h1>\n    <p>\n      React is Facebook’s approach to writing modern JavaScript front-ends. It\n      encourages building an app out of small, re-usable components. Each\n      component is self-contained and only knows how to render a small bit of\n      the interface.\n    </p>\n    <p>\n      The catch is that many frameworks have attempted this: everything from\n      Angular to Backbone and jQuery plugins. But where jQuery plugins get\n      become messy, Angular depends too much on HTML structure, and Backbone\n      needs a lot of boilerplate, React has found a sweet spot.\n    </p>\n    <p>\n      I’ve found React a joy to use. Using React was the first time in my life\n      that I could move a piece of HTML in a modern app without rewriting half\n      my JavaScript. It’s like a super power.\n    </p>\n    <p>\n      React being the most popular JavaScript framework out there, the world\n      seems to agree. React is great. ⚛️\n    </p>\n    <p>\n      D3 is Mike Bostock’s infamous data visualization library. It’s used by\n      The New York Times along with many other sites. It is the workhorse of\n      data visualization on the web, and many charting libraries out there are\n      based on it.\n    </p>\n    <p>\n      But D3 is a fairly low-level library. You can’t just say\n      <em>“I have data; give me a bar chart”</em>. Well, you can, but it takes\n      a few more lines of code than that. Once you get used to it though, D3 is\n      a joy to use.\n    </p>\n    <p>Just like React, D3 is declarative.</p>\n    <p>\n      You tell your code <em>what</em> you want instead of <em>how</em> you\n      want it. It gives you access straight to the SVG so you can manipulate\n      your lines and rectangles as you want. The problem is that D3 isn’t so\n      great, if all you want are charts.\n    </p>\n    <p>That’s where React comes in.</p>\n    <p>\n      Once you’ve created a histogram component, you can always get a histogram\n      with\n      <code style=\"white-space: pre-wrap;\">&lt;Histogram x=\"5\" ... /&gt;</code\n      >. Once you have a piechart, it’s always\n      <code style=\"white-space: pre-wrap;\">&lt;Piechart x=\"20\" ... /&gt;</code\n      >. Just like they were HTML elements.\n    </p>\n    <p>Doesn’t that sound like the best? I think it’s amazing.</p>\n    <p>It gets better!</p>\n    <p>\n      With React, you can make different graph and chart components share the\n      same data. When your data changes, the whole visualization reacts.\n    </p>\n    <p>\n      Your graph changes. The title changes. The description changes.\n      Everything changes. Mind, blown.\n    </p>\n    <p>\n      Look how this H1B salary visualization changes when the user picks a\n      subset of the data to look at.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/full_default_h1b.png\"\n        alt=\"Default H1B histogram\"\n      />\n      <figcaption>Default H1B histogram</figcaption>\n    </figure>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/full_changed_h1b.png\"\n        alt=\"Changes after user picks a data subset\"\n      />\n      <figcaption>Changes after user picks a data subset</figcaption>\n    </figure>\n    <p>React + D3: a powerful combination indeed.</p>"
        },
        {
          "lectureTitle": "Buzzword soup explained",
          "lectureBody": "    <h1 id=\"buzzword-soup-explained\">Buzzword soup explained</h1>\n    <p>\n      We’re going to use some buzzwords in this book. Hell, we’ve used some\n      already. Most will get a thorough explanation further on, but let me give\n      you a quick rundown.\n    </p>\n    <ul>\n      <li>\n        <strong>Babel</strong>, a JavaScript transpiler that makes your code\n        work on all browsers.\n      </li>\n      <li>\n        <strong>ECMAScript2015,16,17,18</strong>, official names for JavaScript\n        as new features come out every summer\n      </li>\n      <li>\n        <strong>ES5</strong>, any JavaScript features that existed before June\n        2015\n      </li>\n      <li>\n        <strong>ES6</strong> or <strong>ES6+</strong>, a common name for\n        JavaScript as it exists past June 2015\n      </li>\n      <li>\n        <strong>fat arrows</strong>, a new way to define functions in ES6\n        (<code style=\"white-space: pre-wrap;\">=&gt;</code>)\n      </li>\n      <li>\n        <strong>Git</strong>, a version control system. It’s pretty popular,\n        you probably know it 😃\n      </li>\n      <li>\n        <strong>H1B</strong>, a popular type of work visa in the United States\n      </li>\n      <li>\n        <strong>JSX</strong>, a language/syntax that lets you use\n        <code style=\"white-space: pre-wrap;\">&lt;a href=\"/example\"&gt;</code>\n        as a native part of JavaScript\n      </li>\n      <li>\n        <strong>Mustache</strong>, a popular way to write HTML templates for\n        JavaScript code. Uses\n        <code style=\"white-space: pre-wrap;\">{{ ... }}</code> syntax.\n      </li>\n      <li>\n        <strong>npm</strong>, most popular package manager for JavaScript\n        libraries\n      </li>\n      <li><strong>props</strong>, component properties set when rendering</li>\n      <li>\n        <strong>state</strong>, a local dictionary of values available in most\n        components\n      </li>\n      <li>\n        <strong>functional components</strong>, React components expressed as\n        pure functions that take props and return markup\n      </li>\n      <li>\n        <strong>Webpack</strong>, a module packager for JavaScript. Makes it\n        more convenient to organize code into multiple files. Provides cool\n        plugins.\n      </li>\n    </ul>"
        },
        {
          "lectureTitle": "JSX",
          "lectureBody": "    <h1 id=\"jsx\">JSX</h1>\n    <p>\n      Our components are going to use JSX, a JavaScript syntax extension that\n      lets us treat XML-like data as normal code. You can use React without\n      JSX, but JSX makes React’s full power easier to use.\n    </p>\n    <p>\n      The gist of JSX is that we can use any XML-like string just like it was\n      part of JavaScript. No Mustache or messy string concatenation necessary.\n      Your functions can return HTML, SVG, or XML.\n    </p>\n    <p>\n      For instance, code that renders one of our first examples – a color\n      swatch – looks like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb4\"\n      data-caption=\"Render a color swatch\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb4-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">ReactDOM</span>.<span class=\"at\" style=\"color: #7d9029;\">render</span>(</a>\n<a class=\"sourceLine\" id=\"cb4-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>Colors width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;400&quot;</span> /&gt;<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb4-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">document</span>.<span class=\"at\" style=\"color: #7d9029;\">getElementById</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;svg&#39;</span>)</a>\n<a class=\"sourceLine\" id=\"cb4-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>Which compiles to:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb5\"\n      data-caption=\"JSX compiled result\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb5-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">ReactDOM</span>.<span class=\"at\" style=\"color: #7d9029;\">render</span>(</a>\n<a class=\"sourceLine\" id=\"cb5-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">createElement</span>(Colors<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"dt\" style=\"color: #902000;\">width</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;400&quot;</span><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb5-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">document</span>.<span class=\"at\" style=\"color: #7d9029;\">querySelectorAll</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;svg&#39;</span>)[<span class=\"dv\" style=\"color: #40a070;\">0</span>]</a>\n<a class=\"sourceLine\" id=\"cb5-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      HTML code translates to\n      <code style=\"white-space: pre-wrap;\">React.createElement</code> calls\n      with attributes translated into a property dictionary. The beauty of this\n      approach is two-pronged: you can use React components as if they were\n      HTML tags, and HTML attributes can be anything.\n    </p>\n    <p>\n      You’ll see that anything from a simple value to a function or an object\n      works equally well.\n    </p>"
        },
        {
          "lectureTitle": "What you'll build",
          "lectureBody": "    <h1 id=\"the-meat-start\">Visualizing data with React and d3.js</h1>\n    <p>\n      Welcome to the main part of React + D3 2018. We’re going to talk a little\n      theory, learn some principles, then get our hands dirty with some\n      examples. Through this book you’re going to build:\n    </p>\n    <ul>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887721#basic-approach\"\n          >A few small components in Codesandbox</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6888908#choropleth-map\"\n          >A choropleth map</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6888919#histogram-of-salaries\"\n          >An interactive histogram</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906619#a-bouncing-ball-game-loop-example\"\n          >A bouncing ball</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906645#swipe-transition\"\n          >A swipe transition</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906659#animated-alphabet\"\n          >An animated alphabet</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906668#animating-react-redux\"\n          >A simple particle generator with Redux</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906689#canvas-react-redux\"\n          >A particle generator pushed to 20,000 elements with canvas</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906696#build-a-declarative-billiards-simulation-with-mobx-canvas-and-konva\"\n          >Billiards simulation with MobX and canvas</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/8456113#fractal-tree\"\n          >A dancing fractal tree</a\n        >\n      </li>\n    </ul>\n    <p>Looks random, right? Bear with me. Examples build on each other.</p>\n    <p>\n      The first few examples teach you about static data visualizations and the\n      basics of merging React and D3 using two different approaches.\n    </p>\n    <p>\n      The choropleth and histogram visualizations teach you about interactivity\n      and components working together.\n    </p>\n    <p>\n      You learn about game loop and transition animations through two types of\n      bouncing balls. Followed by more complex enter/exit transitions with an\n      animated alphabet.\n    </p>\n    <p>\n      We look at how far we can push React’s performance with a simple particle\n      generator and a dancing fractal tree. A billiards game helps us learn\n      about complex canvas manipulation.\n    </p>\n    <p>\n      Throughout these examples, we’re going to use <strong>React 16</strong>,\n      compatible with <strong>React 17</strong>, <strong>D3v5</strong>, and\n      modern <strong>ES6+</strong> JavaScript syntax. The particle generator\n      also uses <strong>Redux</strong> for the game loop and the billiards\n      simulation uses MobX. We use <strong>Konva</strong> for complex canvas\n      stuff.\n    </p>\n    <p>\n      That way you can build experience in large portions of the React\n      ecosystem so you can choose what you like best.\n    </p>\n    <p>\n      Don’t worry, if you’re not comfortable with modern JavaScript syntax just\n      yet. By the end of this book, you’re gonna love it!\n    </p>\n    <p>\n      Until then, here’s an interactive cheatsheet:\n      <a href=\"https://es6cheatsheet.com/\">es6cheatsheet.com</a>. It uses\n      runnable code samples to compare the ES5 way with the ES6 way so you can\n      brush up quickly.\n    </p>\n    <p>\n      To give you a taste of React alternatives, we’ll check out\n      <strong>Preact</strong>, <strong>Inferno</strong>, and\n      <strong>Vue</strong> in the fractal tree example. They’re component-based\n      UI frameworks similar to React. Preact is tiny, Inferno is fast, and Vue\n      is about as popular as React.\n    </p>\n    <hr />\n    <p>\n      Let’s talk about how React and D3 fit together. If there’s just one\n      chapter you should read, this is the one. It explains how things work and\n      fit together. Takes you from beginning to being able to figure out the\n      rest on your own.\n    </p>\n    <p>\n      Although you should still play with the bigger examples. They’re fun.\n    </p>\n    <p>This section has five chapters:</p>\n    <ul>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887710\"\n          >A quick intro to D3</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887721#basic-approach\"\n          >How React makes D3 easier</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887723#existing-libraries\"\n          >When should you use an existing library? Which one?</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887730#blackbox-components\"\n          >Quickly integrate any D3 code in your React project with Blackbox\n          Components</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887740#full-feature-integration\"\n          >Build scalable dataviz components with full integration</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887771#state-handling-architecture\"\n          >Handling state in your React app</a\n        >\n      </li>\n      <li>\n        <a\n          href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887772#structuring-your-app\"\n          >Structuring your React App</a\n        >\n      </li>\n    </ul>"
        }
      ]
    },
    {
      "sectionTitle": "A quick intro to D3",
      "lectures": [
        {
          "lectureTitle": "Why D3",
          "lectureBody": "    <p>\n      D3 is the best library out there for custom data visualization. It comes\n      with a rich ecosystem of functions for almost anything you can think of.\n      From simple medians, to automatic axis generators, and force diagrams.\n    </p>\n    <p>\n      Most data visualization you see on the web is built with D3. The New York\n      Times uses it, Guardian uses it, r/dataisbeautiful is full of it.\n    </p>\n    <p>Learning D3 from scratch is where life gets tricky.</p>\n    <p>\n      There are several gotchas that trip you up and make examples look like\n      magic. You’ve probably noticed this, if you ever looked at an example\n      project built with D3. They’re full of spaghetti code, global variables,\n      and often aren’t made to be maintainable.\n    </p>\n    <p>Most examples are just one-off toys after all. It’s art.</p>\n    <p>\n      A lot of dataviz that <em>isn’t</em> art, is charts and graphs. You’ll\n      often find that using D3 to build those, is too complicated. D3 gives you\n      more power than you need.\n    </p>\n    <p>If you want charts, I suggest using a charting library.</p>\n    <p>\n      Where many charting libraries fall short is customization. The API is\n      limited, you can’t do everything you want, and it gets easier to just\n      build it yourself.\n    </p>\n    <p>\n      A lot of what you end up doing in real life is finding a D3 example that\n      looks like what you want to build and adapting it. That’s why you should\n      learn at least some D3.\n    </p>\n    <p>But D3 is hard to read. Take this barchart code, for example 👇</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb6\"\n      data-caption=\"Barchart in pure D3\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb6-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">tsv</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;data.tsv&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb6-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb6-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> d<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb6-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">},</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(error<span class=\"op\" style=\"color: #666666;\">,</span> data) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb6-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (error) <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">throw</span> error<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb6-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb6-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">x</span>.<span class=\"at\" style=\"color: #7d9029;\">domain</span>(<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">letter</span><span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb6-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">y</span>.<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">max</span>(data<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span><span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb6-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb6-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;axis axis--x&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;translate(0,&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> height <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot😉&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisBottom</span>(x))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb6-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb6-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;axis axis--y&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisLeft</span>(y).<span class=\"at\" style=\"color: #7d9029;\">ticks</span>(<span class=\"dv\" style=\"color: #40a070;\">10</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;%&quot;</span>))</a>\n<a class=\"sourceLine\" id=\"cb6-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;text&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;rotate(-90)&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">6</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;dy&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;0.71em&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;text-anchor&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;end&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">text</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;Frequency&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb6-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb6-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">selectAll</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;.bar&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">data</span>(data)</a>\n<a class=\"sourceLine\" id=\"cb6-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">enter</span>().<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;rect&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;bar&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;x&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">x</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">letter</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">y</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb6-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;width&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">x</span>.<span class=\"at\" style=\"color: #7d9029;\">bandwidth</span>())</a>\n<a class=\"sourceLine\" id=\"cb6-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;height&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> height <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"at\" style=\"color: #7d9029;\">y</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb6-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>Can you tell what’s going on? I’d need to read it pretty carefully.</p>\n    <p>Which brings us to 👉</p>"
        },
        {
          "lectureTitle": "3 key insights to learn D3 from scratch",
          "lectureBody": "    <h2 id=\"key-insights-that-help-you-learn-d3.js-from-scratch\">\n      3 key insights that help you learn D3.js from scratch\n    </h2>\n    <p>\n      Somebody once asked me how to learn D3.js from scratch. I quipped that it\n      took me writing a book to really learn it. It’s one hell of a library.\n    </p>\n    <p>Most people don’t go that far. They don’t have to.</p>\n    <p>\n      You start with a problem, find similar examples, do some copy pasta,\n      tweak until it works and end up with a working visualization you don’t\n      understand. You’d be surprised how few engineers actually understand how\n      their D3 data visualization works.\n    </p>\n    <p>\n      Fear not! There are just 3 key concepts you have to grok. Then you can\n      understand every D3 example out there. 😱\n    </p>"
        },
        {
          "lectureTitle": "Data vs. DOM manipulation",
          "lectureBody": "    <h3 id=\"data-manipulation-vs.-dom-manipulation\">\n      1) Data manipulation vs. DOM manipulation\n    </h3>\n    <p>All D3 examples are split into two parts:</p>\n    <ol type=\"1\">\n      <li>Data manipulation</li>\n      <li>DOM manipulation</li>\n    </ol>\n    <p>First you prep your values, then you render.</p>\n    <p>\n      You have to go through many examples to notice what’s going on. Inference\n      learning is hard. Most beginners miss this pattern and it makes D3 look\n      more confusing than it is.\n    </p>\n    <p>\n      Let’s take an example from\n      <a href=\"https://github.com/d3/d3/wiki/Gallery\">D3’s docs</a>, a bar\n      chart with a hover effect.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/barchart-example.png\"\n        alt=\"An example D3 barchart\"\n      />\n      <figcaption>An example D3 barchart</figcaption>\n    </figure>\n    <p>\n      You can\n      <a\n        href=\"https://cdn.rawgit.com/mbostock/3885304/raw/a91f37f5f4b43269df3dbabcda0090310c05285d/index.html\"\n        >try it online</a\n      >. When you hover on a bar, it changes color. Pretty neat.\n    </p>\n    <p>\n      Mike Bostock, the creator of D3, built this chart in 43 lines of code.\n      Here they are 👇\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb7\"\n      data-caption=\"Example D3 barchart\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb7-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> svg <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;svg&quot;</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb7-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    margin <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"dt\" style=\"color: #902000;\">top</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">20</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">right</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">20</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">bottom</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">30</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">left</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">40</span><span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb7-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    width <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;width&quot;</span>) <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">left</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">right</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb7-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    height <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;height&quot;</span>) <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">top</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">bottom</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb7-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> x <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleBand</span>().<span class=\"at\" style=\"color: #7d9029;\">rangeRound</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> width]).<span class=\"at\" style=\"color: #7d9029;\">padding</span>(<span class=\"fl\" style=\"color: #40a070;\">0.1</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb7-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    y <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>().<span class=\"at\" style=\"color: #7d9029;\">rangeRound</span>([height<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb7-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> g <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;translate(&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">left</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;,&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">top</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot😉&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb7-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">tsv</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;data.tsv&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb7-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> d<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">},</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(error<span class=\"op\" style=\"color: #666666;\">,</span> data) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb7-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (error) <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">throw</span> error<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb7-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">x</span>.<span class=\"at\" style=\"color: #7d9029;\">domain</span>(<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">letter</span><span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">y</span>.<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">max</span>(data<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span><span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb7-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;axis axis--x&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;translate(0,&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> height <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot😉&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisBottom</span>(x))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb7-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;axis axis--y&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisLeft</span>(y).<span class=\"at\" style=\"color: #7d9029;\">ticks</span>(<span class=\"dv\" style=\"color: #40a070;\">10</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;%&quot;</span>))</a>\n<a class=\"sourceLine\" id=\"cb7-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;text&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;rotate(-90)&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">6</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;dy&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;0.71em&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;text-anchor&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;end&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">text</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;Frequency&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb7-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">selectAll</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;.bar&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">data</span>(data)</a>\n<a class=\"sourceLine\" id=\"cb7-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">enter</span>().<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;rect&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;bar&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;x&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">x</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">letter</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">y</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb7-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;width&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">x</span>.<span class=\"at\" style=\"color: #7d9029;\">bandwidth</span>())</a>\n<a class=\"sourceLine\" id=\"cb7-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;height&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> height <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"at\" style=\"color: #7d9029;\">y</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb7-44\" title=\"44\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      There are two parts to this code: Data manipulation and DOM manipulation.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb8\"\n      data-caption=\"Data manipulation code\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb8-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..,</span></a>\n<a class=\"sourceLine\" id=\"cb8-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    margin <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"dt\" style=\"color: #902000;\">top</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">20</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">right</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">20</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">bottom</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">30</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">left</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">40</span><span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb8-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    width <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;width&quot;</span>) <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">left</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">right</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb8-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    height <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;height&quot;</span>) <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">top</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">bottom</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb8-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb8-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> x <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleBand</span>().<span class=\"at\" style=\"color: #7d9029;\">rangeRound</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> width]).<span class=\"at\" style=\"color: #7d9029;\">padding</span>(<span class=\"fl\" style=\"color: #40a070;\">0.1</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb8-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    y <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>().<span class=\"at\" style=\"color: #7d9029;\">rangeRound</span>([height<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb8-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb8-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb8-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb8-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">tsv</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;data.tsv&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb8-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb8-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> d<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb8-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">},</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(error<span class=\"op\" style=\"color: #666666;\">,</span> data) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb8-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (error) <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">throw</span> error<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb8-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb8-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">x</span>.<span class=\"at\" style=\"color: #7d9029;\">domain</span>(<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">letter</span><span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb8-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">y</span>.<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">max</span>(data<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span><span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb8-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb8-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb8-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>Bostock here first prepares his data:</p>\n    <ul>\n      <li>\n        some sizing variables (<code style=\"white-space: pre-wrap;\"\n          >margin</code\n        >, <code style=\"white-space: pre-wrap;\">width</code>,\n        <code style=\"white-space: pre-wrap;\">height</code>)\n      </li>\n      <li>\n        two scales to help with data-to-coordinates conversion (<code\n          style=\"white-space: pre-wrap;\"\n          >x, y</code\n        >)\n      </li>\n      <li>\n        loads his dataset (<code style=\"white-space: pre-wrap;\">d3.tsv</code>)\n        and updates his scales’ domains\n      </li>\n    </ul>\n    <p>\n      In the DOM manipulation part, he puts shapes and objects into an SVG.\n      This is the part that shows up in your browser.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb9\"\n      data-caption=\"DOM manipulation code\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb9-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> svg <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;svg&quot;</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb9-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb9-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb9-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb9-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb9-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> g <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;translate(&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">left</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;,&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">top</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot😉&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb9-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb9-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb9-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;axis axis--x&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;translate(0,&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> height <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot😉&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisBottom</span>(x))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb9-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb9-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;axis axis--y&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisLeft</span>(y).<span class=\"at\" style=\"color: #7d9029;\">ticks</span>(<span class=\"dv\" style=\"color: #40a070;\">10</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;%&quot;</span>))</a>\n<a class=\"sourceLine\" id=\"cb9-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;text&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;rotate(-90)&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">6</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;dy&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;0.71em&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;text-anchor&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;end&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">text</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;Frequency&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb9-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb9-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">selectAll</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;.bar&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">data</span>(data)</a>\n<a class=\"sourceLine\" id=\"cb9-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">enter</span>().<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;rect&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;bar&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;x&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">x</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">letter</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">y</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb9-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;width&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">x</span>.<span class=\"at\" style=\"color: #7d9029;\">bandwidth</span>())</a>\n<a class=\"sourceLine\" id=\"cb9-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;height&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> height <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"at\" style=\"color: #7d9029;\">y</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb9-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">})<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      DOM manipulation in D3 happens via D3 selections. They’re a lot like\n      jQuery <code style=\"white-space: pre-wrap;\">$(something)</code>. This is\n      the part we’re doing with React later on.\n    </p>\n    <p>Here Bostock does a few things</p>\n    <ul>\n      <li>\n        selects the\n        <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code> node (<code\n          style=\"white-space: pre-wrap;\"\n          >d3.select</code\n        >)\n      </li>\n      <li>\n        appends a grouping\n        <code style=\"white-space: pre-wrap;\">&lt;g&gt;</code> node (<code\n          style=\"white-space: pre-wrap;\"\n          >.append</code\n        >) with an SVG positioning attribute (translate)\n      </li>\n      <li>\n        adds a bottom axis by appending a\n        <code style=\"white-space: pre-wrap;\">&lt;g&gt;</code>, moving it, then\n        calling <code style=\"white-space: pre-wrap;\">d3.axisBottom</code> on\n        it. D3 has built-in axis generators\n      </li>\n      <li>adds a left axis using the same approach but rotating the ticks</li>\n      <li>appends a text label “Frequency” to the left axis</li>\n      <li>\n        uses <code style=\"white-space: pre-wrap;\">selectAll.data</code> to make\n        a virtual selection of\n        <code style=\"white-space: pre-wrap;\">.bar</code> nodes and attach some\n        data, then for every new data value (.enter), appends a\n        <code style=\"white-space: pre-wrap;\">&lt;rect&gt;</code> node and gives\n        it attributes\n      </li>\n    </ul>\n    <p>\n      That last part is where people get lost. It looks like magic. Even to me.\n    </p>\n    <p>\n      It’s a declarative approach to rendering data. Works great, hard to\n      understand. That’s why we’ll do it in React instead 😃\n    </p>\n    <p>\n      You can think of <code style=\"white-space: pre-wrap;\">.enter</code> as a\n      loop over your data. Everything chained after\n      <code style=\"white-space: pre-wrap;\">.enter</code> is your loop’s body.\n      Sort of like doing\n      <code style=\"white-space: pre-wrap;\"\n        >data.map(d =&gt; append(rect).setManyAttributes())</code\n      >\n    </p>\n    <p>\n      That function executes for any <em>new</em> data “entering” your\n      visualization. There’s also\n      <code style=\"white-space: pre-wrap;\">.exit</code> for anything that’s\n      dropping out, and <code style=\"white-space: pre-wrap;\">.update</code> for\n      anything that’s changing.\n    </p>"
        },
        {
          "lectureTitle": "Scales",
          "lectureBody": "    <h3 id=\"scales\">2) Scales</h3>\n    <p>\n      Scales are D3’s most versatile concept. They help you translate between\n      two different spaces. Like, mathematical spaces.\n    </p>\n    <p>\n      They’re like the mathematical functions you learned about in school. A\n      domain maps to a range using some sort of formula.\n    </p>\n    <figure>\n      <img\n        src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/d/df/Function_color_example_3.svg/440px-Function_color_example_3.svg.png\"\n        alt=\"A basic function\"\n      />\n      <figcaption>A basic function</figcaption>\n    </figure>\n    <p>\n      Colored shapes in the domain map to colors in the range. No formula for\n      this one. That makes it an ordinal scale.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb10\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb10-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> shapes <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleOrdinal</span>()</a>\n<a class=\"sourceLine\" id=\"cb10-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"st\" style=\"color: #4070a0;\">&#39;red&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;orange&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> ...)</a>\n<a class=\"sourceLine\" id=\"cb10-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"st\" style=\"color: #4070a0;\">&#39;red&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;orange&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> ...)</a></code></pre>\n    </div>\n    <p>\n      <a href=\"https://codesandbox.io/s/r0rw72z75o\"\n        >Play with scales on CodeSandbox</a\n      >\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/r0rw72z75o?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <p>\n      Once you have this scale, you can use it to translate from shapes to\n      colors.\n      <code style=\"white-space: pre-wrap;\">shapes('red triangle')</code>\n      returns <code style=\"white-space: pre-wrap;\">'red'</code> for example.\n    </p>\n    <p>\n      Many different types of scales exist. Linear, logarithmic, quantize, etc.\n      Any basic transformation you can think of exists. The rest you can create\n      by writing custom scales.\n    </p>\n    <p>\n      You’re most often going to use scales to turn your data values into\n      coordinates. But other use-cases exist.\n    </p>"
        },
        {
          "lectureTitle": "D3 layouts",
          "lectureBody": "    <h3 id=\"d3-layouts\">3) D3 layouts</h3>\n    <p>\n      Sure <code style=\"white-space: pre-wrap;\">.enter.append</code> looks like\n      magic, but D3 layouts are the real mind=blown of the D3 ecosystem. They\n      take your input data and return a full-featured visualization thing.\n    </p>\n    <p>\n      For example, a force layout using forces between nodes to place them on\n      the screen.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/force-layout.png\"\n        alt=\"Force layout\"\n      />\n      <figcaption>Force layout</figcaption>\n    </figure>\n    <p>Or a circle packing layout that neatly packs circles.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/circle-packing-layout.png\"\n        alt=\"Circle packing layout\"\n      />\n      <figcaption>Circle packing layout</figcaption>\n    </figure>\n    <p>\n      I don’t know the maths that goes into most of these. And that’s the\n      point, you shouldn’t have to!\n    </p>\n    <p>\n      Here’s a key insight about the magic of layouts: They’re the data part.\n    </p>\n    <p>\n      You take a <code style=\"white-space: pre-wrap;\">forceLayout</code> and\n      feed it your data. It returns an object with a\n      <code style=\"white-space: pre-wrap;\">tick</code> event callback.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb11\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb11-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> simulation <span class=\"op\" style=\"color: #666666;\">=</span> d3</a>\n<a class=\"sourceLine\" id=\"cb11-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">forceSimulation</span>()</a>\n<a class=\"sourceLine\" id=\"cb11-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">force</span>(</a>\n<a class=\"sourceLine\" id=\"cb11-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"st\" style=\"color: #4070a0;\">&#39;link&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb11-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">forceLink</span>().<span class=\"at\" style=\"color: #7d9029;\">id</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb11-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb11-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb11-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  )</a>\n<a class=\"sourceLine\" id=\"cb11-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">force</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;charge&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">forceManyBody</span>())</a>\n<a class=\"sourceLine\" id=\"cb11-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">force</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;center&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">forceCenter</span>(width / <span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span> height / <span class=\"dv\" style=\"color: #40a070;\">2</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      This <code style=\"white-space: pre-wrap;\">simulation</code> now handles\n      everything <em>about</em> rendering your nodes. Changes their positions\n      on every <code style=\"white-space: pre-wrap;\">tick</code> callback,\n      figures out how often to change stuff, etc.\n    </p>\n    <p>\n      But it is up to you to render them. A layout handles your dataviz in the\n      abstract. You’re in control of the rendering.\n    </p>\n    <p>\n      For a force layout, you have to update the DOM on every tick of the\n      animation. For circle packing, you render it once.\n    </p>\n    <p>\n      Once you grok this, all the fancy visualizations out there start making\n      sense. Also means you can use these fancy layouts in React 🙌\n    </p>"
        },
        {
          "lectureTitle": "Recap",
          "lectureBody": "    <h2 id=\"recap\">Recap</h2>\n    <p>\n      There’s a lot more D3 can do, but those are the 3 key insights you need\n      to understand any example you find in the wild.\n    </p>\n    <ol type=\"1\">\n      <li>Code is split into data and DOM manipulation</li>\n      <li>Scales are great and used a lot</li>\n      <li>You’re always in control of rendering</li>\n    </ol>\n    <p>\n      Then you can start using D3’s more advanced features like maps and axes\n      and shape generators and geo computations and data loading and\n      transitions and user interactions.\n    </p>\n    <p>\n      There’s a lot. We’re not going to cover it all but you can find those\n      advanced features in the docs and the skills you learn here will help you\n      get started.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "How React makes D3 easier",
      "lectures": [
        {
          "lectureTitle": "React + D3 = ❤️",
          "lectureBody": "    <h1 id=\"basic-approach\">How React makes D3 easier</h1>\n    <p>\n      Our visualizations are going to use SVG – an XML-based image format that\n      lets us describe images in terms of mathematical shapes. For example, the\n      source code of an 800x600 SVG image with a rectangle looks like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb12\"\n      data-caption=\"SVG rectangle\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode html\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode html\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb12-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;svg</span><span class=\"ot\" style=\"color: #007020;\"> width=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span><span class=\"ot\" style=\"color: #007020;\"> height=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;600&quot;</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb12-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;rect</span><span class=\"ot\" style=\"color: #007020;\"> width=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;100&quot;</span><span class=\"ot\" style=\"color: #007020;\"> height=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;200&quot;</span><span class=\"ot\" style=\"color: #007020;\"> x=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;50&quot;</span><span class=\"ot\" style=\"color: #007020;\"> y=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;20&quot;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">/&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb12-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/svg&gt;</span></a></code></pre>\n    </div>\n    <p>\n      These four lines create an SVG image with a black rectangle at\n      coordinates <code style=\"white-space: pre-wrap;\">(50, 20)</code> that is\n      100x200 pixels large. Black fill with no borders is default for SVG\n      shapes.\n    </p>\n    <p>\n      SVG is perfect for data visualization on the web because it works in all\n      browsers, renders without blurring or artifacts on all screens, and\n      supports animation and user interaction. You can see examples of\n      interaction and animation later in this book.\n    </p>\n    <p>\n      But SVG can get slow when you have many thousands of elements on screen.\n      We’re going to solve that problem by rendering bitmap images with canvas.\n      More on that later.\n    </p>\n    <hr />\n    <p>\n      Another nice feature of SVG is that it’s just a dialect of XML - nested\n      elements describe structure, attributes describe the details. Same\n      principles that HTML uses.\n    </p>\n    <p>\n      That makes React’s rendering engine particularly suited for SVG. Our\n      100x200 rectangle from before looks like this as a React component:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb13\"\n      data-caption=\"A simple rectangle in React\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb13-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Rectangle <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb13-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>rect width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;100&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;200&quot;</span> x<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;50&quot;</span> y<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;20&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb13-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      To use this rectangle component in a picture, you’d use a component like\n      this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb14\"\n      data-caption=\"Rect component in a picture\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb14-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Picture <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb14-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;600&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb14-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>Rectangle /<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb14-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb14-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Sure looks like tons of work for a static rectangle. But look closely!\n      Even if you know nothing about React and JSX, you can look at that code\n      and see that it’s a\n      <code style=\"white-space: pre-wrap;\">Picture</code> of a\n      <code style=\"white-space: pre-wrap;\">Rectangle</code>.\n    </p>\n    <p>Compare that to a pure D3 approach:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb15\"\n      data-caption=\"A static rectangle in d3.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb15-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;svg&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb15-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;width&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">800</span>)</a>\n<a class=\"sourceLine\" id=\"cb15-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;height&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">600</span>)</a>\n<a class=\"sourceLine\" id=\"cb15-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;rect&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb15-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;width&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">100</span>)</a>\n<a class=\"sourceLine\" id=\"cb15-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;height&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">200</span>)</a>\n<a class=\"sourceLine\" id=\"cb15-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;x&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">50</span>)</a>\n<a class=\"sourceLine\" id=\"cb15-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">20</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      It’s elegant, it’s declarative, and it looks like function call soup. It\n      doesn’t scream <em>“Rectangle in an SVG”</em> to as much as the React\n      version does.\n    </p>\n    <p>\n      You have to take your time and read the code carefully: first, we\n      <code style=\"white-space: pre-wrap;\">select</code> the\n      <code style=\"white-space: pre-wrap;\">svg</code> element, then we add\n      attributes for <code style=\"white-space: pre-wrap;\">width</code> and\n      <code style=\"white-space: pre-wrap;\">height</code>. After that, we\n      <code style=\"white-space: pre-wrap;\">append</code> a\n      <code style=\"white-space: pre-wrap;\">rect</code> element and set its\n      attributes for <code style=\"white-space: pre-wrap;\">width</code>,\n      <code style=\"white-space: pre-wrap;\">height</code>,\n      <code style=\"white-space: pre-wrap;\">x</code>, and\n      <code style=\"white-space: pre-wrap;\">y</code>.\n    </p>\n    <p>Those 8 lines of code create HTML that looks like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb16\"\n      data-caption=\"HTML of a rectangle\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb16-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;600&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb16-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>rect width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;100&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;200&quot;</span> x<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;50&quot;</span> y<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;20&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb16-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">&lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a></code></pre>\n    </div>\n    <p>\n      Would’ve been easier to just write the HTML, right? Yes, for static\n      images, you’re better off using Photoshop or Sketch then exporting to\n      SVG.\n    </p>\n    <p>\n      Dealing with the DOM is not D3’s strong suit. There’s a lot of typing,\n      code that’s hard to read, it’s slow when you have thousands of elements,\n      and it’s often hard to keep track of which elements you’re changing. D3’s\n      enter-update-exit cycle is great in theory, but most people struggle\n      trying to wrap their head around it.\n    </p>\n    <p>\n      If you don’t understand what I just said, don’t worry. We’ll cover the\n      enter-update-exit cycle in the animations example.\n    </p>\n    <p>\n      Don’t worry about D3 either. <strong>It’s hard!</strong> I’ve written two\n      books about D3, and I still spend as much time reading the docs as\n      writing the code. The library is huge and there’s much to learn. I’ll\n      explain everything as we go along.\n    </p>\n    <p>\n      D3’s strong suit is its ability to do everything except the DOM. There\n      are statistical functions, great support for data manipulation, a bunch\n      of built-in data visualizations, magic around transitions and animation …\n      <strong\n        >D3 can calculate anything for you. All you have to do is draw it\n        out.</strong\n      >\n    </p>\n    <p>That’s why our general approach sounds like this in a nutshell:</p>\n    <ul>\n      <li>React owns the DOM</li>\n      <li>D3 calculates properties</li>\n    </ul>\n    <p>\n      We leverage React for SVG structure and rendering optimizations; D3 for\n      its mathematical and visualization functions.\n    </p>\n    <p>\n      Now let’s look at three different ways of using React and D3 to build\n      data visualization:\n    </p>\n    <ul>\n      <li>using a library</li>\n      <li>quick blackbox components</li>\n      <li>full feature integration</li>\n    </ul>"
        },
        {
          "lectureTitle": "What about existing libraries?",
          "lectureBody": "    <h1 id=\"existing-libraries\">\n      When should you use an existing library? Which one?\n    </h1>\n    <p>\n      The quickest way to achieve the benefits of integrating React with D3 is\n      to use a library. A collection of components with pre-built charting\n      visualizations. Plug it into your app, move on with life.\n    </p>\n    <p>\n      Great option for basic charts. I recommend it dearly to anyone who comes\n      to me and asks about building stuff. Try a library first. If it fits your\n      needs, perfect! You just saved yourselves plenty of time.\n    </p>\n    <p>\n      Where libraries become a problem is when you want to move beyond the\n      library author’s idea of How Things Are Done. Custom features,\n      visualizations that aren’t just charts, disabling this or that default\n      behavior … it gets messy.\n    </p>\n    <p>\n      That’s why I rarely use libraries myself. Often find it quicker to build\n      something specific from scratch than figuring out how to hold a\n      generalized API just right.\n    </p>\n    <p>\n      But they’re a great first step. Here’s a few of the most popular React\n      &amp; D3 libraries 👇\n    </p>\n    <p>\n      List borrowed from\n      <a href=\"https://www.smashingmagazine.com/2018/02/react-d3-ecosystem/\"\n        >a wonderful Smashing Magazine article</a\n      >, because it’s a good list.\n    </p>"
        },
        {
          "lectureTitle": "Victory.js",
          "lectureBody": "    <h2 id=\"victory\">Victory</h2>\n    <blockquote>\n      <p>React.js components for modular charting and data visualization</p>\n    </blockquote>\n    <p>\n      <a href=\"https://formidable.com/open-source/victory/\"\n        ><img\n          src=\"https://raw.githubusercontent.com/hsribei/react-d3js-es6-ebook/teachable-only/manuscript/resources/images/2018/victoryjs.jpg\"\n          alt=\"Victory.js logo\"\n      /></a>\n    </p>\n    <p>\n      Victory offers low level components for basic charting and reimplements a\n      lot of D3’s API. Great when you need to create basic charts without a lot\n      of customization. Supports React Native.\n    </p>\n    <p>\n      Here’s what it takes to implement a Barchart using Victory.js.\n      <a href=\"https://codesandbox.io/s/3v3q013x36\"\n        >You can try it on CodeSandbox</a\n      >\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/3v3q013x36?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <div\n      class=\"sourceCode\"\n      id=\"cb17\"\n      data-caption=\"Bar chart in Victory.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb17-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> data <span class=\"op\" style=\"color: #666666;\">=</span> [</a>\n<a class=\"sourceLine\" id=\"cb17-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">13000</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb17-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">16500</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb17-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">3</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">14250</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb17-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">4</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">19000</span> <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb17-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb17-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb17-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> App <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb17-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>div style<span class=\"op\" style=\"color: #666666;\">={</span>styles<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb17-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>h1<span class=\"op\" style=\"color: #666666;\">&gt;</span>Victory basic demo&lt;/h1<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb17-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>VictoryChart domainPadding<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">20</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb17-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>VictoryBar data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}</span> x<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;quarter&quot;</span> y<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;earnings&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb17-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    &lt;/VictoryChart<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb17-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb17-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Create some fake data, render a\n      <code style=\"white-space: pre-wrap;\">&lt;VictoryChart&gt;</code>\n      rendering area, add a\n      <code style=\"white-space: pre-wrap;\">&lt;VictoryBar&gt;</code> component,\n      give it data and axis keys. Quick and easy.\n    </p>\n    <p>\n      My favorite feature of Victory is that components use fake random data\n      until you pass your own. Means you always know what to expect.\n    </p>"
        },
        {
          "lectureTitle": "Recharts",
          "lectureBody": "    <h2 id=\"recharts\">Recharts</h2>\n    <blockquote>\n      <p>A composable charting library built on React components</p>\n    </blockquote>\n    <p>\n      <a href=\"https://recharts.org/\"\n        ><img\n          src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/recharts.png\"\n          alt=\"Recharts homepage\"\n      /></a>\n    </p>\n    <p>\n      Recharts is like a more colorful Victory. A pile of charting components,\n      some customization, loves animating everything by default.\n    </p>\n    <p>\n      Here’s what it takes to implement a Barchart using Recharts.\n      <a href=\"https://codesandbox.io/s/mmkrjl7qxp\"\n        >You can try it on CodeSandbox</a\n      >\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/mmkrjl7qxp?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <div\n      class=\"sourceCode\"\n      id=\"cb18\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb18-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> data <span class=\"op\" style=\"color: #666666;\">=</span> [</a>\n<a class=\"sourceLine\" id=\"cb18-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">13000</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb18-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">16500</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb18-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">3</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">14250</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb18-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">4</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">19000</span> <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb18-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb18-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb18-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> App <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb18-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>div style<span class=\"op\" style=\"color: #666666;\">={</span>styles<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb18-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>h1<span class=\"op\" style=\"color: #666666;\">&gt;</span>Recharts basic demo&lt;/h1<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb18-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>BarChart width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">500</span><span class=\"op\" style=\"color: #666666;\">}</span> height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">300</span><span class=\"op\" style=\"color: #666666;\">}</span> data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb18-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>XAxis dataKey<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;quarter&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb18-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>YAxis dataKey<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;earnings&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb18-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>Bar dataKey<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;earnings&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb18-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    &lt;/BarChart<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb18-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb18-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      More involved than Victory, but same principle. Fake some data, render a\n      drawing area this time with\n      <code style=\"white-space: pre-wrap;\">&lt;BarChart&gt;</code> and feed it\n      some data. Inside the\n      <code style=\"white-space: pre-wrap;\">&lt;BarChart&gt;</code> render two\n      axes, and a <code style=\"white-space: pre-wrap;\">&lt;Bar&gt;</code> for\n      each entry.\n    </p>\n    <p>\n      Recharts hits a great balance of flexibility and ease … unless you don’t\n      like animation by default. Then you’re in trouble.\n    </p>"
        },
        {
          "lectureTitle": "Nivo",
          "lectureBody": "    <h2 id=\"nivo\">Nivo</h2>\n    <blockquote>\n      <p>\n        nivo provides a rich set of dataviz components, built on top of the\n        awesome d3 and Reactjs libraries.\n      </p>\n    </blockquote>\n    <p>\n      <a href=\"https://nivo.rocks/\"\n        ><img\n          src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/nivo.gif\"\n          alt=\"Nivo homepage\"\n      /></a>\n    </p>\n    <p>\n      Nivo is another attempt to give you a set of basic charting components.\n      Comes with great interactive documentation, support for Canvas and API\n      rendering. Plenty of basic customization.\n    </p>\n    <p>\n      Here’s what it takes to implement a Barchart using Nivo.\n      <a href=\"https://codesandbox.io/s/n1wwkvq24\"\n        >You can try it on CodeSandbox</a\n      >\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/n1wwkvq24?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <div\n      class=\"sourceCode\"\n      id=\"cb19\"\n      data-caption=\"Bar chart in Nivo\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb19-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> data <span class=\"op\" style=\"color: #666666;\">=</span> [</a>\n<a class=\"sourceLine\" id=\"cb19-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">13000</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb19-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">16500</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb19-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">3</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">14250</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb19-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">4</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">19000</span> <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb19-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb19-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb19-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> App <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb19-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>div style<span class=\"op\" style=\"color: #666666;\">={</span>styles<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb19-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>h1<span class=\"op\" style=\"color: #666666;\">&gt;</span>Nivo basic demo&lt;/h1<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb19-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>div style<span class=\"op\" style=\"color: #666666;\">={{</span> <span class=\"dt\">height</span><span class=\"op\">:</span> <span class=\"st\">&quot;400px&quot;</span> <span class=\"op\">}}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb19-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>ResponsiveBar data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}</span> keys<span class=\"op\" style=\"color: #666666;\">={</span>[<span class=\"st\" style=\"color: #4070a0;\">&quot;earnings&quot;</span>]<span class=\"op\" style=\"color: #666666;\">}</span> indexBy<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;quarter&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb19-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb19-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb19-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Least amount of effort! You render a\n      <code style=\"white-space: pre-wrap;\">&lt;ResponsiveBar&gt;</code>\n      component, give it data and some params, and Nivo handles the rest.\n    </p>\n    <p>\n      Wonderful! But means you have to learn a whole new language of configs\n      and props that might make your hair stand on end. The documentation is\n      great and shows how everything works, but I found it difficult to know\n      which prop combinations are valid.\n    </p>"
        },
        {
          "lectureTitle": "VX",
          "lectureBody": "    <h2 id=\"vx\">VX</h2>\n    <blockquote>\n      <p>\n        vx is collection of reusable low-level visualization components. vx\n        combines the power of d3 to generate your visualization with the\n        benefits of react for updating the DOM.\n      </p>\n    </blockquote>\n    <p>\n      <a href=\"https://vx-demo.now.sh/\"\n        ><img\n          src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/vx.png\"\n          alt=\"VX\"\n      /></a>\n    </p>\n    <p>\n      VX is the closest to the approaches you’re learning in this book. React\n      for rendering, D3 for calculations. When you build a set of custom\n      components for your organization, a flavor of VX is what you often come\n      up with.\n    </p>\n    <p>\n      That’s why I recommend teams use VX when they need to get started\n      quickly.\n    </p>\n    <p>\n      Here’s what it takes to implement a Barchart using Nivo.\n      <a href=\"https://codesandbox.io/s/k5853pryrv\"\n        >You can try it on CodeSandbox</a\n      >\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/k5853pryrv?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <div\n      class=\"sourceCode\"\n      id=\"cb20\"\n      data-caption=\"Bar chart built in VX\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb20-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> data <span class=\"op\" style=\"color: #666666;\">=</span> [</a>\n<a class=\"sourceLine\" id=\"cb20-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">13000</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb20-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">16500</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb20-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">3</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">14250</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb20-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">quarter</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">4</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">earnings</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">19000</span> <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb20-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb20-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb20-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> App <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span> width <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">400</span><span class=\"op\" style=\"color: #666666;\">,</span> height <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">400</span> <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb20-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> xMax <span class=\"op\" style=\"color: #666666;\">=</span> width<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb20-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> yMax <span class=\"op\" style=\"color: #666666;\">=</span> height <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"dv\" style=\"color: #40a070;\">120</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb20-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb20-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> x <span class=\"op\" style=\"color: #666666;\">=</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">quarter</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb20-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> y <span class=\"op\" style=\"color: #666666;\">=</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">earnings</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb20-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb20-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// scales</span></a>\n<a class=\"sourceLine\" id=\"cb20-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> xScale <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">scaleBand</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb20-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">rangeRound</span><span class=\"op\" style=\"color: #666666;\">:</span> [<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> xMax]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb20-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">domain</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">satisfied</span><span class=\"op\" style=\"color: #666666;\">:,</span></a>\n<a class=\"sourceLine\" id=\"cb20-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">padding</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"fl\" style=\"color: #40a070;\">0.4</span></a>\n<a class=\"sourceLine\" id=\"cb20-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb20-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> yScale <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb20-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">rangeRound</span><span class=\"op\" style=\"color: #666666;\">:</span> [yMax<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb20-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">domain</span><span class=\"op\" style=\"color: #666666;\">:</span> [<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"at\" style=\"color: #7d9029;\">max</span>(data<span class=\"op\" style=\"color: #666666;\">,</span> y)]</a>\n<a class=\"sourceLine\" id=\"cb20-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb20-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb20-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb20-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>div style<span class=\"op\" style=\"color: #666666;\">={</span>styles<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb20-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>h1<span class=\"op\" style=\"color: #666666;\">&gt;</span>VX basic demo&lt;/h1<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb20-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">={</span>width<span class=\"op\" style=\"color: #666666;\">}</span> height<span class=\"op\" style=\"color: #666666;\">={</span>height<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb20-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>((d<span class=\"op\" style=\"color: #666666;\">,</span> i) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb20-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> barHeight <span class=\"op\" style=\"color: #666666;\">=</span> yMax <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"at\" style=\"color: #7d9029;\">yScale</span>(<span class=\"at\" style=\"color: #7d9029;\">y</span>(d))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb20-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb20-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>Bar</a>\n<a class=\"sourceLine\" id=\"cb20-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"va\" style=\"color: #19177c;\">xScale</span>.<span class=\"at\" style=\"color: #7d9029;\">bandwidth</span>()<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb20-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              height<span class=\"op\" style=\"color: #666666;\">={</span>barHeight<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb20-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"at\" style=\"color: #7d9029;\">xScale</span>(<span class=\"at\" style=\"color: #7d9029;\">x</span>(d))<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb20-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              y<span class=\"op\" style=\"color: #666666;\">={</span>yMax <span class=\"op\" style=\"color: #666666;\">-</span> barHeight<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb20-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              data<span class=\"op\" style=\"color: #666666;\">={{</span> <span class=\"dt\">x</span><span class=\"op\">:</span> <span class=\"at\">x</span>(d)<span class=\"op\">,</span> <span class=\"dt\">y</span><span class=\"op\">:</span> <span class=\"at\">y</span>(d) <span class=\"op\">}}</span></a>\n<a class=\"sourceLine\" id=\"cb20-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            /&gt;</a>\n<a class=\"sourceLine\" id=\"cb20-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb20-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb20-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb20-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb20-44\" title=\"44\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb20-45\" title=\"45\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      Move involved than previous examples, but means you have more control and\n      fight the library less often. VX does the tedious stuff for you, so you\n      can focus on the stuff that matters.\n    </p>\n    <p>\n      This code creates value accessor methods, D3 scales, then iterates over\n      an array of <code style=\"white-space: pre-wrap;\">data</code> and renders\n      a <code style=\"white-space: pre-wrap;\">&lt;Bar</code> for each. The bar\n      gets a bunch of props.\n    </p>"
        },
        {
          "lectureTitle": "When you shouldn't use a library",
          "lectureBody": "    <h2 id=\"when-not-to-use-a-library\">When not to use a library</h2>\n    <p>\n      Libraries are great. Quick to get started, quick to keep using, great for\n      common usecases.\n    </p>\n    <p>\n      Now, if you want to build something custom, something that delights and\n      astounds, something that makes your users love you … You’re gonna have to\n      understand how combining React and D3 works under the hood. Whether you\n      use a library or not.\n    </p>\n    <p>\n      A rule of thumb you can use is to consider how custom you want to make\n      your visualization. The more customizations, the more likely you are to\n      benefit from rolling your own.\n    </p>\n    <p>\n      Or if you’ve had a lot of practice with rolling your own and it’s\n      literally easier than learning a library.\n    </p>\n    <p>\n      If you have to customize an existing library, or build your own for the\n      team, that’s what we’re here for today 😃\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Quickly integrate any D3 code in your React project with Blackbox Components",
      "lectures": [
        {
          "lectureTitle": "The idea behind blackbox components",
          "lectureBody": "    <h1 id=\"blackbox-components\">\n      Quickly integrate any D3 code in your React project with Blackbox\n      Components\n    </h1>\n    <p>\n      Blackbox components are the quickest way to integrate D3 and React. You\n      can think of them as wrappers around D3 visualizations.\n    </p>\n    <p>\n      With the blackbox approach, you can take any D3 example from the\n      internets or your brain, wrap it in a React component, and it Just\n      Works™. This is great when you’re in a hurry, but comes with a big\n      caveat: You’re letting D3 control some of the DOM.\n    </p>\n    <p>\n      D3 controlling the DOM is <em>okay</em>, but it means React can’t help\n      you there. That’s why it’s called a Blackbox – React can’t see inside.\n    </p>\n    <p>\n      No render engine, no tree diffing, no dev tools to inspect what’s going.\n      Just a blob of DOM elements.\n    </p>\n    <p>\n      Okay for small components or when you’re prototyping, but I’ve had people\n      come to my workshops and say\n      <em\n        >“We built our whole app with the blackbox approach. It takes a few\n        seconds to re-render when you click something. Please help”</em\n      >\n    </p>\n    <p>🤔</p>\n    <p>Here’s how it works:</p>\n    <ul>\n      <li>React renders an anchor element</li>\n      <li>D3 hijacks it and puts stuff in</li>\n    </ul>\n    <p>\n      You manually re-render on props and state changes. Throwing away and\n      rebuilding the entire DOM subtree on each render. With complex\n      visualizations this becomes a huge hit on performance.\n    </p>\n    <p>Use this technique sparingly.</p>"
        },
        {
          "lectureTitle": "A quick blackbox example - a D3 axis",
          "lectureBody": "    <h2 id=\"blackbox-axis\">A quick blackbox example - a D3 axis</h2>\n    <p>\n      Let’s build an axis component. Axes are the perfect use-case for blackbox\n      components. D3 comes with an axis generator bundled inside, and they’re\n      difficult to build from scratch.\n    </p>\n    <p>\n      They don’t <em>look</em> difficult, but there are many tiny details you\n      have to get <em>just right</em>.\n    </p>\n    <p>\n      D3’s axis generator takes a scale and some configuration to render an\n      axis for us. The code looks like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb21\"\n      data-caption=\"Vanilla D3 axis\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb21-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> scale <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb21-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">10</span>])</a>\n<a class=\"sourceLine\" id=\"cb21-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">200</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb21-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> axis <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisBottom</span>(scale)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb21-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb21-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;svg&#39;</span>)</a>\n<a class=\"sourceLine\" id=\"cb21-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;g&#39;</span>)</a>\n<a class=\"sourceLine\" id=\"cb21-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;transform&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;translate(10, 30)&#39;</span>)</a>\n<a class=\"sourceLine\" id=\"cb21-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  .<span class=\"at\" style=\"color: #7d9029;\">call</span>(axis)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      You can\n      <a href=\"https://codesandbox.io/s/v6ovkow8q3\"\n        >try it out on CodeSandbox</a\n      >.\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/v6ovkow8q3?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <p>\n      If this code doesn’t make any sense, don’t worry. There’s a bunch of D3\n      to learn, and I’ll help you out. If it’s obvious, you’re a pro! This book\n      will be much quicker to read.\n    </p>\n    <p>\n      We start with a linear scale that has a domain\n      <code style=\"white-space: pre-wrap;\">[0, 10]</code> and a range\n      <code style=\"white-space: pre-wrap;\">[0, 200]</code>. Scales are like\n      mathematical functions that map a domain to a range. In this case,\n      calling <code style=\"white-space: pre-wrap;\">scale(0)</code> returns\n      <code style=\"white-space: pre-wrap;\">0</code>,\n      <code style=\"white-space: pre-wrap;\">scale(5)</code> returns\n      <code style=\"white-space: pre-wrap;\">100</code>,\n      <code style=\"white-space: pre-wrap;\">scale(10)</code> returns\n      <code style=\"white-space: pre-wrap;\">200</code>. Just like a linear\n      function from math class – y = kx + n.\n    </p>\n    <p>\n      We create an axis generator with\n      <code style=\"white-space: pre-wrap;\">axisBottom</code>, which takes a\n      <code style=\"white-space: pre-wrap;\">scale</code> and creates a\n      <code style=\"white-space: pre-wrap;\">bottom</code> oriented axis –\n      numbers below the line. You can also change settings for the number of\n      ticks, their sizing, spacing, and so on.\n    </p>\n    <p>\n      Equipped with an\n      <code style=\"white-space: pre-wrap;\">axis</code> generator, we\n      <code style=\"white-space: pre-wrap;\">select</code> the\n      <code style=\"white-space: pre-wrap;\">svg</code> element, append a\n      grouping element, use a\n      <code style=\"white-space: pre-wrap;\">transform</code> attribute to move\n      it <code style=\"white-space: pre-wrap;\">10</code>px to the right and\n      <code style=\"white-space: pre-wrap;\">30</code>px down, and invoke the\n      generator with <code style=\"white-space: pre-wrap;\">.call()</code>.\n    </p>\n    <p>It creates a small axis:</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/simple-axis.png\"\n        alt=\"Simple axis\"\n      />\n      <figcaption>Simple axis</figcaption>\n    </figure>\n    <p>\n      Play around with it on\n      <a href=\"https://codepen.io/swizec/pen/YGoYBM\">Codesandbox</a>. Change\n      the scale type, play with axis orientation. Use\n      <code style=\"white-space: pre-wrap;\">.ticks</code> on the axis to change\n      how many show up. Have some fun 😃\n    </p>"
        },
        {
          "lectureTitle": "A React + D3 axis",
          "lectureBody": "    <h2 id=\"a-quick-blackbox-example---a-reactd3-axis\">\n      A quick blackbox example - a React+D3 axis\n    </h2>\n    <p>\n      Now let’s say we want to use that same axis code but as a React\n      component. The simplest way is to use a blackbox component approach like\n      this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb22\"\n      data-caption=\"React blackbox axis\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb22-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Axis <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb22-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  gRef <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">createRef</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb22-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb22-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">d3render</span>() <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb22-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">componentDidUpdate</span>() <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">d3render</span>() <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb22-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb22-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">d3render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb22-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> scale <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb22-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">10</span>])</a>\n<a class=\"sourceLine\" id=\"cb22-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">200</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb22-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> axis <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisBottom</span>(scale)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb22-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb22-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">gRef</span>)</a>\n<a class=\"sourceLine\" id=\"cb22-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">call</span>(axis)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb22-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb22-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb22-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb22-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;translate(10, 30)&quot;</span> ref<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">gRef</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb22-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb22-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      So much code! Worth it for the other benefits of using React in your\n      dataviz. You’ll see 😃\n    </p>\n    <p>\n      We created an <code style=\"white-space: pre-wrap;\">Axis</code> component\n      that extends React’s base\n      <code style=\"white-space: pre-wrap;\">Component</code> class. We can’t use\n      functional components because we need lifecycle hooks.\n    </p>\n    <p>\n      Our component has a\n      <code style=\"white-space: pre-wrap;\">render</code> method. It returns a\n      grouping element (<code style=\"white-space: pre-wrap;\">g</code>) moved\n      10px to the right and 30px down using the\n      <code style=\"white-space: pre-wrap;\">transform</code> attribute. Same as\n      before.\n    </p>\n    <p>\n      A React ref saved in\n      <code style=\"white-space: pre-wrap;\">this.gRef</code> and passed into our\n      <code style=\"white-space: pre-wrap;\">&lt;g&gt;</code> element with\n      <code style=\"white-space: pre-wrap;\">ref</code> lets us talk to the DOM\n      node directly. We need this to hand over rendering control to D3.\n    </p>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">d3render</code> method looks\n      familiar. It’s the same code we used in the vanilla D3 example. Scale,\n      axis, select, call. Only difference is that instead of selecting\n      <code style=\"white-space: pre-wrap;\">svg</code> and appending a\n      <code style=\"white-space: pre-wrap;\">g</code> element, we select the\n      <code style=\"white-space: pre-wrap;\">g</code> element rendered by React\n      and use that.\n    </p>\n    <p>\n      We use <code style=\"white-space: pre-wrap;\">componentDidUpdate</code> and\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> to keep our\n      render up to date. Ensures that our axis re-renders every time React’s\n      engine decides to render our component.\n    </p>\n    <p>That wasn’t so bad, was it?</p>\n    <p>\n      <a href=\"https://codesandbox.io/s/3xy2jr1y5m\"\n        >Try it out on Codesandbox</a\n      >.\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/3xy2jr1y5m?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <p>\n      You can make the axis more useful by getting positioning, scale, and\n      orientation from props. We’ll do that in our big project.\n    </p>\n    <h3 id=\"practical-exercise\">Practical exercise</h3>\n    <p>\n      Try implementing those as an exercise. Make the axis more reusable with\n      some carefully placed props.\n    </p>\n    <p>\n      Here’s my solution, if you get stuck 👉\n      <a href=\"https://codesandbox.io/s/5ywlj6jn4l\"\n        >https://codesandbox.io/s/5ywlj6jn4l</a\n      >\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/5ywlj6jn4l?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>"
        },
        {
          "lectureTitle": "A D3 blackbox higher order component - HOC",
          "lectureBody": "    <h1 id=\"blackbox-hoc\">A D3 blackbox higher order component – HOC</h1>\n    <p>\n      After that example you might think this is hella tedious to implement\n      every time. You’d be right!\n    </p>\n    <p>\n      Good thing you can abstract it all away with a higher order component – a\n      HOC. Now this is something I should open source (just do it already), but\n      I want to show you how it works so you can learn about the HOC pattern.\n    </p>\n    <p>\n      Higher order components are great when you see multiple React components\n      sharing similar code. In our case, that shared code is:\n    </p>\n    <ul>\n      <li>rendering an anchor element</li>\n      <li>calling D3’s render on updates</li>\n    </ul>\n    <p>\n      With a HOC, we can abstract that away into a sort of\n      <a href=\"https://en.wikipedia.org/wiki/Factory_method_pattern\"\n        >object factory</a\n      >. It’s an old concept making a comeback now that JavaScript has classes.\n    </p>\n    <p>\n      Think of our HOC as a function that takes some params and creates a class\n      – a React component. Another way to think about HOCs is that they’re\n      React components wrapping other React components and a function that\n      makes it easy.\n    </p>\n    <p>\n      A HOC for D3 blackbox integration, called\n      <code style=\"white-space: pre-wrap;\">D3blackbox</code>, looks like like\n      this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb23\"\n      data-caption=\"React blackbox HOC\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb23-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> <span class=\"at\" style=\"color: #7d9029;\">D3blackbox</span>(D3render) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb23-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Blackbox <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb23-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    anchor <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">createRef</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb23-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb23-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"va\" style=\"color: #19177c;\">D3render</span>.<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb23-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidUpdate</span>() <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"va\" style=\"color: #19177c;\">D3render</span>.<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>) <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb23-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb23-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb23-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb23-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">}</span> ref<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">anchor</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb23-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb23-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb23-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>You’ll recognize most of that code from earlier.</p>\n    <p>\n      We have\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> and<code\n        style=\"white-space: pre-wrap;\"\n        >componentDidUpdate</code\n      >\n      lifecycle hooks that call\n      <code style=\"white-space: pre-wrap;\">D3render</code> on component\n      updates. <code style=\"white-space: pre-wrap;\">render</code> renders a\n      grouping element as an anchor with a ref so D3 can use it to render stuff\n      into.\n    </p>\n    <p>\n      Because <code style=\"white-space: pre-wrap;\">D3render</code> is no longer\n      a part of our component, we have to use\n      <code style=\"white-space: pre-wrap;\">.call</code> to give it the scope we\n      want: this class, or rather\n      <code style=\"white-space: pre-wrap;\">this</code> instance of the\n      <code style=\"white-space: pre-wrap;\">Blackbox</code> class.\n    </p>\n    <p>\n      We’ve also made some changes that make\n      <code style=\"white-space: pre-wrap;\">render</code> more flexible. Instead\n      of hardcoding the\n      <code style=\"white-space: pre-wrap;\">translate()</code> transformation,\n      we take <code style=\"white-space: pre-wrap;\">x</code> and\n      <code style=\"white-space: pre-wrap;\">y</code> props.\n      <code style=\"white-space: pre-wrap;\">{ x, y } = this.props</code> takes\n      <code style=\"white-space: pre-wrap;\">x</code> and\n      <code style=\"white-space: pre-wrap;\">y</code> out of\n      <code style=\"white-space: pre-wrap;\">this.props</code> using object\n      decomposition, and we used ES6 string templates for the\n      <code style=\"white-space: pre-wrap;\">transform</code> attribute.\n    </p>\n    <p>\n      Consult the <a href=\"https://es6cheatsheet.com/\">ES6 cheatsheet</a> for\n      details on the syntax.\n    </p>\n    <p>\n      Using our new <code style=\"white-space: pre-wrap;\">D3blackbox</code> HOC\n      to make an axis looks like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb24\"\n      data-caption=\"React blackbox HOC\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb24-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Axis <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">D3blackbox</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> () <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb24-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> scale <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb24-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">10</span>])</a>\n<a class=\"sourceLine\" id=\"cb24-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">200</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb24-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> axis <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisBottom</span>(scale)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb24-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb24-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">anchor</span>)</a>\n<a class=\"sourceLine\" id=\"cb24-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">call</span>(axis)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb24-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      You know this code! We copy pasted our axis rendering code from before,\n      wrapped it in a function, and passed it into\n      <code style=\"white-space: pre-wrap;\">D3blackbox</code>. Now it’s a React\n      component.\n    </p>\n    <p>\n      Play with this example on\n      <a href=\"https://codesandbox.io/s/5v21r0wo4x\">Codesandbox, here</a>.\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/5v21r0wo4x?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>"
        },
        {
          "lectureTitle": "D3blackbox magic trick - render anything in 30 seconds",
          "lectureBody": "    <h2 id=\"magic-trick\">\n      D3blackbox magic trick – render anything in 30 seconds\n    </h2>\n    <p>\n      Let me show you a magic trick. 30 seconds to take a random D3 piece of\n      code and add it to your React project.\n    </p>\n    <p>We can try it on the example barchart from before.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/barchart-example.png\"\n        alt=\"An example D3 barchart\"\n      />\n      <figcaption>An example D3 barchart</figcaption>\n    </figure>\n    <p>\n      You can\n      <a\n        href=\"https://cdn.rawgit.com/mbostock/3885304/raw/a91f37f5f4b43269df3dbabcda0090310c05285d/index.html\"\n        >try it online</a\n      >. When you hover on a bar, it changes color. Pretty neat.\n    </p>\n    <p>\n      I recommend you follow along in a CodeSandbox. If you fork the\n      <a href=\"https://codesandbox.io/s/5v21r0wo4x\"\n        >react-d3-axis-hoc CodeSandbox</a\n      >\n      that will be easiest.\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/5v21r0wo4x?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <p>\n      You should already have the\n      <code style=\"white-space: pre-wrap;\">D3blackbox</code> HOC. If you don’t,\n      make a new file and paste it in.\n    </p>\n    <p>\n      With your HOC ready, create a new file in CodeSandbox. Call it\n      <code style=\"white-space: pre-wrap;\">Barchart.js</code>.\n    </p>\n    <p>Add your imports:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb25\"\n      data-caption=\"Import dependencies\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb25-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb25-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> D3blackbox <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./D3blackbox&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb25-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;d3&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>This gives you React, our HOC, and D3.</p>\n    <p>\n      Now right-click view code on that barchart and copy the code. Wrap it in\n      a <code style=\"white-space: pre-wrap;\">D3blackbox</code> call. Like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb26\"\n      data-caption=\"Wrap D3 code in D3blackbox\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb26-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Barchart <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">D3blackbox</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> () <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb26-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> svg <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;svg&quot;</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb26-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      margin <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"dt\" style=\"color: #902000;\">top</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">20</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">right</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">20</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">bottom</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">30</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">left</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">40</span><span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb26-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      width <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;width&quot;</span>) <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">left</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">right</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb26-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      height <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;height&quot;</span>) <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">top</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">bottom</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb26-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> x <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleBand</span>().<span class=\"at\" style=\"color: #7d9029;\">rangeRound</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> width]).<span class=\"at\" style=\"color: #7d9029;\">padding</span>(<span class=\"fl\" style=\"color: #40a070;\">0.1</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb26-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      y <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>().<span class=\"at\" style=\"color: #7d9029;\">rangeRound</span>([height<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb26-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> g <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;translate(&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">left</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;,&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">top</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot😉&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb26-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">tsv</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;data.tsv&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb26-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> d<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">},</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(error<span class=\"op\" style=\"color: #666666;\">,</span> data) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb26-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (error) <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">throw</span> error<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb26-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">x</span>.<span class=\"at\" style=\"color: #7d9029;\">domain</span>(<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">letter</span><span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">y</span>.<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">max</span>(data<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span><span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb26-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;axis axis--x&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;translate(0,&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> height <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot😉&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisBottom</span>(x))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb26-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;axis axis--y&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">axisLeft</span>(y).<span class=\"at\" style=\"color: #7d9029;\">ticks</span>(<span class=\"dv\" style=\"color: #40a070;\">10</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;%&quot;</span>))</a>\n<a class=\"sourceLine\" id=\"cb26-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;text&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;transform&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;rotate(-90)&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">6</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;dy&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;0.71em&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;text-anchor&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;end&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">text</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;Frequency&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb26-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">g</span>.<span class=\"at\" style=\"color: #7d9029;\">selectAll</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;.bar&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">data</span>(data)</a>\n<a class=\"sourceLine\" id=\"cb26-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">enter</span>().<span class=\"at\" style=\"color: #7d9029;\">append</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;rect&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;class&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;bar&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;x&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">x</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">letter</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">y</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;width&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">x</span>.<span class=\"at\" style=\"color: #7d9029;\">bandwidth</span>())</a>\n<a class=\"sourceLine\" id=\"cb26-44\" title=\"44\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;height&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> height <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"at\" style=\"color: #7d9029;\">y</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-45\" title=\"45\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb26-46\" title=\"46\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb26-47\" title=\"47\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb26-48\" title=\"48\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Barchart<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      That should throw some errors. We have to change the\n      <code style=\"white-space: pre-wrap;\">d3.select</code> and get\n      <code style=\"white-space: pre-wrap;\">width</code> and\n      <code style=\"white-space: pre-wrap;\">height</code> from props.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb27\"\n      data-caption=\"Change where D3 renders\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb27-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Barchart <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">D3blackbox</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> () <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb27-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Delete the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb27-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> svg <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;svg&quot;</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb27-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb27-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb27-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">var</span> svg <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">anchor</span>.<span class=\"at\" style=\"color: #7d9029;\">current</span>)</a>\n<a class=\"sourceLine\" id=\"cb27-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb27-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      margin <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"dt\" style=\"color: #902000;\">top</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">20</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">right</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">20</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">bottom</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">30</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">left</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">40</span><span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb27-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Delete the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb27-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      width <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;width&quot;</span>) <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">left</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">right</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb27-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      height <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;height&quot;</span>) <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">top</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">bottom</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb27-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb27-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb27-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      width <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">left</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">right</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb27-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      height <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">top</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">margin</span>.<span class=\"at\" style=\"color: #7d9029;\">bottom</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb27-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a></code></pre>\n    </div>\n    <p>\n      Most D3 examples use a global\n      <code style=\"white-space: pre-wrap;\">svg</code> variable to refer to\n      their drawing area – the SVG. Change that to the element you want, your\n      anchor, and the whole visualization should render in there.\n    </p>\n    <p>\n      We also replaced reading width and height from the SVG element to getting\n      them from props. This makes our component more reusable and better\n      follows best practices.\n    </p>\n    <p>\n      Next step is to change where our barchart gets its data. Gotta use the\n      public URL.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb28\"\n      data-caption=\"Change data URL\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb28-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//Delete the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb28-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">tsv</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;data.tsv&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb28-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb28-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb28-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">tsv</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;https://swizec.github.io/dl/barchart.tsv&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(d) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb28-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb28-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">+</span><span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">frequency</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb28-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> d<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb28-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Delete the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb28-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">},</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(error<span class=\"op\" style=\"color: #666666;\">,</span> data) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb28-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (error) <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">throw</span> error<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb28-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb28-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb28-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span>).<span class=\"at\" style=\"color: #7d9029;\">then</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(data) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb28-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a></code></pre>\n    </div>\n    <p>\n      Same link, absolute version. And we updated the callback-based code to\n      use the D3v5 promises version. That’s the most disruptive change going\n      from v4 to v5 I believe.\n    </p>\n    <p>\n      That’s it. You now have a Barchart component that renders the example\n      barchart from D3’s docs.\n    </p>\n    <p>\n      You can use it like this 👇 I recommend adding this code to the main App\n      component that CodeSandbox creates for you.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb29\"\n      data-caption=\"Use the Barchart\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb29-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Barchart <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./Barchart&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb29-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb29-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb29-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb29-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;600&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb29-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>Barchart x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">10</span><span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">10</span><span class=\"op\" style=\"color: #666666;\">}</span> width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">400</span><span class=\"op\" style=\"color: #666666;\">}</span> height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">300</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb29-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb29-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)</a></code></pre>\n    </div>\n    <p>\n      But like I said, don’t use this in production. It’s great for quick\n      prototypes, trying stuff out, or seeing how an existing visualization\n      might fit your app.\n    </p>\n    <h2 id=\"a-note-about-d3blackbox\">A note about D3blackbox</h2>\n    <p>\n      To make your life easier, I have open sourced my version of the\n      D3blackbox HOC. You can read more about it at\n      <a href=\"https://d3blackbox.com\">d3blackbox.com</a>\n    </p>\n    <p>\n      Works the same as the HOC we just built together, adds the anchor ref,\n      props, and state to function arguments so it’s easier to use. No need to\n      mess with <code style=\"white-space: pre-wrap;\">this</code> if you don’t\n      want to 😃\n    </p>\n    <p>Install it from npm:</p>\n    <pre><code style=\"white-space: pre-wrap;\">$ npm install d3blackbox</code></pre>\n    <p>Then use it as you would your own HOC:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb31\"\n      data-caption=\"Open source D3blackbox HOC\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb31-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb31-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> D3blackbox <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3blackbox&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb31-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb31-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb31-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Barchart <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">D3blackbox</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(anchor<span class=\"op\" style=\"color: #666666;\">,</span> props<span class=\"op\" style=\"color: #666666;\">,</span> state) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb31-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> svg <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"va\" style=\"color: #19177c;\">anchor</span>.<span class=\"at\" style=\"color: #7d9029;\">current</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb31-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// the rest of your D3 code</span></a>\n<a class=\"sourceLine\" id=\"cb31-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb31-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb31-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Barchart<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      The function you pass into\n      <code style=\"white-space: pre-wrap;\">D3blackbox</code> is still your full\n      D3 render. Except now you can access important values directly without\n      using <code style=\"white-space: pre-wrap;\">this</code>.\n    </p>\n    <p>\n      You can use my D3blackbox or build your own. What’s important is that you\n      now understand how higher order components work.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Build scalable dataviz components with full integration",
      "lectures": [
        {
          "lectureTitle": "The approach",
          "lectureBody": "    <h1 id=\"full-feature-integration\">\n      Build scalable dataviz components with full integration\n    </h1>\n    <p>\n      As useful as blackbox components are, we need something better if we want\n      to leverage React’s rendering engine. The blackbox approach in particular\n      struggles with scale. The more charts and graphs and visualizations on\n      your screen, the slower it gets.\n    </p>\n    <p>\n      Someone once came to my workshop and said\n      <em\n        >“We used the blackbox approach and it takes several seconds to\n        re-render our dashboard on any change. I’m here to learn how to do it\n        better.”</em\n      >\n    </p>\n    <p>\n      In our full-feature integration, React does the rendering and D3\n      calculates the props.\n    </p>\n    <p>\n      Our goal is to build controlled components that listen to their props and\n      reconcile that with D3’s desire to use a lot of internal state.\n    </p>\n    <p>There are two situations we can find ourselves in:</p>\n    <ol type=\"1\">\n      <li>We know for a fact our component’s props never change</li>\n      <li>We think props could change</li>\n    </ol>\n    <p>It’s easiest to show you with an example.</p>\n    <p>\n      Let’s build a scatterplot step by step. Take a random array of\n      two-dimensional data, render in a loop. Make magic.\n    </p>\n    <p>Something like this 👇</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/scatterplot.png\"\n        alt=\"A simple scatterplot\"\n      />\n      <figcaption>A simple scatterplot</figcaption>\n    </figure>\n    <p>You’ve already built the axes! Copy pasta time.</p>"
        },
        {
          "lectureTitle": "When props don't change - a scatterplot",
          "lectureBody": "    <h2 id=\"props-dont-change\">Props don’t change</h2>\n    <p>\n      Ignoring props changes makes our life easier, but the component less\n      flexible and reusable. Great when you know in advance that there are\n      features you don’t ned to support.\n    </p>\n    <p>\n      Like, no filtering your data or changing component size 👉 means your D3\n      scales don’t have to change.\n    </p>\n    <p>When our props don’t change, we follow a 2-step integration process:</p>\n    <ul>\n      <li>set up D3 objects as class properties</li>\n      <li>\n        output SVG in <code style=\"white-space: pre-wrap;\">render()</code>\n      </li>\n    </ul>\n    <p>\n      We don’t have to worry about updating D3 objects on prop changes. Work\n      done 👌\n    </p>\n    <h3 id=\"an-unchanging-scatterplot\">An unchanging scatterplot</h3>\n    <p>\n      We’re building a scatterplot of random data. You can see the\n      <a href=\"https://codesandbox.io/s/1zlp4jv494\"\n        >final solution on CodeSandbox</a\n      >\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/1zlp4jv494?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <p>Here’s the approach 👇</p>\n    <ul>\n      <li>stub out the basic setup</li>\n      <li>generate random data</li>\n      <li>stub out Scatterplot</li>\n      <li>set up D3 scales</li>\n      <li>render circles for each entry</li>\n      <li>add axes</li>\n    </ul>\n    <p>\n      I recommend creating a new CodeSandbox, or starting a new app with\n      create-react-app. They should work the same.\n    </p>\n    <h4 id=\"basic-setup\">Basic setup</h4>\n    <p>\n      Make sure you have <code style=\"white-space: pre-wrap;\">d3</code> added\n      as a dependency. Then add imports in your\n      <code style=\"white-space: pre-wrap;\">App.js</code> file.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb32\"\n      data-caption=\"Import files in App.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb32-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ./App.js</span></a>\n<a class=\"sourceLine\" id=\"cb32-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb32-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb32-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Scatterplot <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;./Scatterplot&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Add an <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code> and render\n      a Scatterplot in the render method. This will throw an error because we\n      haven’t defined the Scatterplot yet and that’s okay.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb33\"\n      data-caption=\"Render Scatterplot in App.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb33-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ./App.js</span></a>\n<a class=\"sourceLine\" id=\"cb33-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb33-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> <span class=\"at\" style=\"color: #7d9029;\">App</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb33-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb33-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb33-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>h1<span class=\"op\" style=\"color: #666666;\">&gt;</span>Hello CodeSandbox&lt;/h1<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb33-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>h2<span class=\"op\" style=\"color: #666666;\">&gt;</span>Start editing to see some magic happen<span class=\"op\" style=\"color: #666666;\">!</span>&lt;/h2<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb33-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb33-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>Scatterplot x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">50</span><span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">50</span><span class=\"op\" style=\"color: #666666;\">}</span> width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">300</span><span class=\"op\" style=\"color: #666666;\">}</span> height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">300</span><span class=\"op\" style=\"color: #666666;\">}</span> data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb33-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb33-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb33-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb33-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      CodeSandbox adds most of that code by default. If you’re using\n      create-react-app, your App component has different markup. That’s okay\n      too.\n    </p>\n    <p>We added this part:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb34\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb34-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb34-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>Scatterplot x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">50</span><span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">50</span><span class=\"op\" style=\"color: #666666;\">}</span> width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">300</span><span class=\"op\" style=\"color: #666666;\">}</span> height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">300</span><span class=\"op\" style=\"color: #666666;\">}</span> data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb34-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">&lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a></code></pre>\n    </div>\n    <p>\n      An <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code> drawing area\n      with a width and a height. Inside, a\n      <code style=\"white-space: pre-wrap;\">&lt;Scatterplot</code> that’s\n      positioned at <code style=\"white-space: pre-wrap;\">(50, 50)</code> and is\n      300px tall and wide. We’ll have to listen to those props when building\n      the Scatterplot.\n    </p>\n    <p>It also accepts data.</p>\n    <h4 id=\"random-data\">Random data</h4>\n    <p>\n      We’re using a line of code to generate data for our scatterplot. Put it\n      in App.js. Either globally or within the App function. Doesn’t matter\n      because this is an example.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb35\"\n      data-caption=\"Generate random data\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb35-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> data <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">range</span>(<span class=\"dv\" style=\"color: #40a070;\">100</span>)</a>\n<a class=\"sourceLine\" id=\"cb35-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">               .<span class=\"at\" style=\"color: #7d9029;\">map</span>(_ <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> [<span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">random</span>()<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">random</span>()])<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      <code style=\"white-space: pre-wrap;\">d3.range</code> returns a counting\n      array from 0 to 100. Think\n      <code style=\"white-space: pre-wrap;\">[1,2,3,4 ...]</code>.\n    </p>\n    <p>\n      We iterate over this array and return a pair of random numbers for each\n      entry. These will be our X and Y coordinates.\n    </p>\n    <h4 id=\"scatterplot\">Scatterplot</h4>\n    <p>\n      Our scatterplot goes in a new\n      <code style=\"white-space: pre-wrap;\">Scatterplot.js</code> file. Starts\n      with imports and an empty React component.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb36\"\n      data-caption=\"Scatterplot stub\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb36-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ./Scatterplot.js</span></a>\n<a class=\"sourceLine\" id=\"cb36-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb36-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb36-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb36-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Scatterplot <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb36-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb36-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb36-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> data<span class=\"op\" style=\"color: #666666;\">,</span> height <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb36-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb36-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb36-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb36-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb36-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb36-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb36-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb36-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb36-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb36-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Scatterplot<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Import dependencies, create a\n      <code style=\"white-space: pre-wrap;\">Scatterplot</code> component, render\n      a grouping element moved to the correct\n      <code style=\"white-space: pre-wrap;\">x</code> and\n      <code style=\"white-space: pre-wrap;\">y</code> position. Nothing too\n      strange yet.\n    </p>\n    <h4 id=\"d3-scales\">D3 scales</h4>\n    <p>\n      Now we define D3 scales as component properties. We’re using the class\n      field syntax that’s common in React projects.\n    </p>\n    <p>\n      Technically a Babel plugin, but comes by default with CodeSandbox React\n      projects and create-react-app setup. As far as I can tell, it’s a common\n      way to write React components.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb37\"\n      data-caption=\"Add D3 scales\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb37-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ./Scatterplot.js</span></a>\n<a class=\"sourceLine\" id=\"cb37-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Scatterplot <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb37-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  xScale <span class=\"op\" style=\"color: #666666;\">=</span> d3</a>\n<a class=\"sourceLine\" id=\"cb37-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb37-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>])</a>\n<a class=\"sourceLine\" id=\"cb37-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb37-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  yScale <span class=\"op\" style=\"color: #666666;\">=</span> d3</a>\n<a class=\"sourceLine\" id=\"cb37-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb37-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>])</a>\n<a class=\"sourceLine\" id=\"cb37-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We’re defining\n      <code style=\"white-space: pre-wrap;\">this.xScale</code> and\n      <code style=\"white-space: pre-wrap;\">this.yScale</code> as linear scales.\n      Their domains go from 0 to 1 because that’s what Math.random returns and\n      their ranges describe the size of our scatterplot component.\n    </p>\n    <p>\n      Idea being that these two scales will help us take those tiny variations\n      in datapoint coordinates and explode them up to the full size of our\n      scatterplot. Without this, they’d overlap and we wouldn’t see anything.\n    </p>\n    <h4 id=\"circles-for-each-entry\">Circles for each entry</h4>\n    <p>\n      Rendering our data points is a matter of looping over the data and\n      rendering a\n      <code style=\"white-space: pre-wrap;\">&lt;circle&gt;</code> for each\n      entry. Using our scales to define positioning.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb38\"\n      data-caption=\"Loop through data and render circles\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb38-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ./Scatterplot.js</span></a>\n<a class=\"sourceLine\" id=\"cb38-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb38-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb38-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb38-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(([x<span class=\"op\" style=\"color: #666666;\">,</span> y]) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb38-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>circle cx<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">xScale</span>(<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">satisfied</span><span class=\"op\" style=\"color: #666666;\">:}</span> cy<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">yScale</span>(y)<span class=\"op\" style=\"color: #666666;\">}</span> r<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;5&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb38-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    ))<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb38-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb38-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      In the <code style=\"white-space: pre-wrap;\">return</code> statement of\n      our <code style=\"white-space: pre-wrap;\">render</code> render method, we\n      add a <code style=\"white-space: pre-wrap;\">data.map</code> with an\n      iterator method. This method takes our datapoint, uses array\n      destructuring to get <code style=\"white-space: pre-wrap;\">x</code> and\n      <code style=\"white-space: pre-wrap;\">y</code> coordinates, then uses our\n      scales to define <code style=\"white-space: pre-wrap;\">cx</code> and\n      <code style=\"white-space: pre-wrap;\">cy</code> attributes on a\n      <code style=\"white-space: pre-wrap;\">&lt;circle&gt;</code> element.\n    </p>\n    <h4 id=\"add-axes\">Add axes</h4>\n    <p>\n      You can reuse axes from our earlier exercise. Or copy mine from\n      <a href=\"https://codesandbox.io/s/1zlp4jv494\">the CodeSandbox</a>\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/1zlp4jv494?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <p>\n      Mine take a scale and orientation as props, which makes them more\n      flexible. Means we can use the same component for both the vertical and\n      horizontal axis on our Scatterplot.\n    </p>\n    <p>\n      Put the axis code in <code style=\"white-space: pre-wrap;\">Axis.js</code>,\n      then augment the Scatterplot like this 👇\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb39\"\n      data-caption=\"Add axes to Scatterplot\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb39-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Axis <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;./Axis&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb39-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb39-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb39-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb39-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb39-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb39-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(([x<span class=\"op\" style=\"color: #666666;\">,</span> y]) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb39-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>circle cx<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">xScale</span>(<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">satisfied</span><span class=\"op\" style=\"color: #666666;\">:}</span> cy<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">yScale</span>(y)<span class=\"op\" style=\"color: #666666;\">}</span> r<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;5&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb39-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    ))<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb39-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>Axis x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span> scale<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">yScale</span><span class=\"op\" style=\"color: #666666;\">}</span> type<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;Left&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb39-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>Axis x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span>height<span class=\"op\" style=\"color: #666666;\">}</span> scale<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">xScale</span><span class=\"op\" style=\"color: #666666;\">}</span> type<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;Bottom&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb39-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb39-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Vertical axis takes the vertical\n      <code style=\"white-space: pre-wrap;\">this.yScale</code> scale, orients to\n      the <code style=\"white-space: pre-wrap;\">Left</code> and we position it\n      top left. The horizontal axis takes the horizontal\n      <code style=\"white-space: pre-wrap;\">this.xScale</code> scale, orients to\n      the <code style=\"white-space: pre-wrap;\">Bottom</code>, and we render it\n      bottom left.\n    </p>\n    <p>Your Scatterplot should now look like this</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/scatterplot-basic.png\"\n        alt=\"Rendered basic scatterplot\"\n      />\n      <figcaption>Rendered basic scatterplot</figcaption>\n    </figure>"
        },
        {
          "lectureTitle": "A scatterplot When props do change",
          "lectureBody": "    <h2 id=\"props-might-update\">Props might update</h2>\n    <p>\n      The story is a little different when our props might update. Since we’re\n      using D3 objects to calculate SVG properties, we have to make sure those\n      objects are updated <em>before</em> we render.\n    </p>\n    <p>\n      No problem in React 15: Update in\n      <code style=\"white-space: pre-wrap;\">componentWillUpdate</code>. But\n      since React 16.3 we’ve been told never to use that again. Causes problems\n      for modern async rendering.\n    </p>\n    <p>\n      The official recommended solution is that anything that used to go in\n      <code style=\"white-space: pre-wrap;\">componentWillUpdate</code>, can go\n      in <code style=\"white-space: pre-wrap;\">componentDidUpdate</code>. But\n      not so fast!\n    </p>\n    <p>\n      Updating D3 objects in\n      <code style=\"white-space: pre-wrap;\">componentDidUpdate</code> would mean\n      our visualization always renders one update behind. Stale renders! 😱\n    </p>\n    <p>\n      The new\n      <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code> to\n      the rescue. Our integration follows a 3-step pattern:\n    </p>\n    <ul>\n      <li>set up D3 objects in component state</li>\n      <li>\n        update D3 objects in\n        <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code>\n      </li>\n      <li>\n        output SVG in <code style=\"white-space: pre-wrap;\">render()</code>\n      </li>\n    </ul>\n    <p>\n      <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code> is\n      officially discouraged, and yet the best tool we have to make sure D3\n      state is updated <em>before</em> we render.\n    </p>\n    <p>\n      Because React calls\n      <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code> on\n      every component render, not just when our props actually change, you\n      should avoid recalculating complex things too often. Use memoization\n      helpers, check for changes before updating, stuff like that.\n    </p>\n    <h3 id=\"an-updateable-scatterplot\">An updateable scatterplot</h3>\n    <p>\n      Let’s update our scatterplot so it can deal with resizing and updating\n      data.\n    </p>\n    <p>3 steps 👇</p>\n    <ul>\n      <li>add an interaction that resizes the scatterplot</li>\n      <li>move scales to state</li>\n      <li>\n        update scales in\n        <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code>\n      </li>\n    </ul>\n    <p>\n      You can see\n      <a href=\"https://codesandbox.io/s/ll9kp8or0l\"\n        >my final solution on CodeSandbox</a\n      >. I recommend you follow along updating your existing code.\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/ll9kp8or0l?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <h4 id=\"resize-scatterplot-on-click\">Resize scatterplot on click</h4>\n    <p>\n      To test our scatterplot’s adaptability, we have to add an interaction:\n      Resize the scatterplot on click.\n    </p>\n    <p>\n      That change happens in\n      <code style=\"white-space: pre-wrap;\">App.js</code>. Click on the\n      <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code>, reduce width and\n      height by 30%.\n    </p>\n    <p>\n      Move sizing into App state and add an\n      <code style=\"white-space: pre-wrap;\">onClick</code> handler.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb40\"\n      data-caption=\"Sizing into state and click handler\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb40-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// App.js</span></a>\n<a class=\"sourceLine\" id=\"cb40-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb40-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb40-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">width</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">300</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb40-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">height</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">300</span></a>\n<a class=\"sourceLine\" id=\"cb40-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb40-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb40-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  onClick <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb40-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> width<span class=\"op\" style=\"color: #666666;\">,</span> height <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb40-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb40-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">width</span><span class=\"op\" style=\"color: #666666;\">:</span> width <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"fl\" style=\"color: #40a070;\">0.7</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb40-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">height</span><span class=\"op\" style=\"color: #666666;\">:</span> height <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"fl\" style=\"color: #40a070;\">0.7</span></a>\n<a class=\"sourceLine\" id=\"cb40-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb40-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb40-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb40-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb40-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> width<span class=\"op\" style=\"color: #666666;\">,</span> height <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We changed our App component from a function to a class, added\n      <code style=\"white-space: pre-wrap;\">state</code> with default\n      <code style=\"white-space: pre-wrap;\">width</code> and\n      <code style=\"white-space: pre-wrap;\">height</code>, and an\n      <code style=\"white-space: pre-wrap;\">onClick</code> method that reduces\n      size by 30%. The\n      <code style=\"white-space: pre-wrap;\">render</code> method reads\n      <code style=\"white-space: pre-wrap;\">width</code> and\n      <code style=\"white-space: pre-wrap;\">height</code> from state.\n    </p>\n    <p>\n      Now gotta change rendering to listen to these values and fire the\n      <code style=\"white-space: pre-wrap;\">onClick</code> handler.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb41\"\n      data-caption=\"Use state in rendering\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb41-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// App.js</span></a>\n<a class=\"sourceLine\" id=\"cb41-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb41-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span> onClick<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">onClick</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb41-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>Scatterplot</a>\n<a class=\"sourceLine\" id=\"cb41-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">50</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb41-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">50</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb41-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    width<span class=\"op\" style=\"color: #666666;\">={</span>width<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb41-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    height<span class=\"op\" style=\"color: #666666;\">={</span>height<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb41-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb41-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  /&gt;</a>\n<a class=\"sourceLine\" id=\"cb41-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">&lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a></code></pre>\n    </div>\n    <p>\n      Similar rendering as before. We have an\n      <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code> that contains a\n      <code style=\"white-space: pre-wrap;\">&lt;Scatterplot&gt;</code>. The svg\n      fires <code style=\"white-space: pre-wrap;\">this.onClick</code> on click\n      events and the scatterplot uses our\n      <code style=\"white-space: pre-wrap;\">width</code> and\n      <code style=\"white-space: pre-wrap;\">height</code> values for its props.\n    </p>\n    <p>\n      If you try this code now, you should see a funny effect where axes move,\n      but the scatterplot doesn’t resize.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/not-resizing-scatterplot.png\"\n        alt=\"Axes move, scatterplot doesn’t resize\"\n      />\n      <figcaption>Axes move, scatterplot doesn’t resize</figcaption>\n    </figure>\n    <p>Peculiar isn’t it? Try to guess why.</p>\n    <h4 id=\"move-scales-to-state\">Move scales to state</h4>\n    <p>\n      The horizontal axis moves because it’s render at\n      <code style=\"white-space: pre-wrap;\">height</code> vertical coordinate.\n      Datapoints don’t move because the scales that position them are\n      calculated once – on component mount.\n    </p>\n    <p>\n      First step to keeping scales up to date is to move them from component\n      values into state.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb42\"\n      data-caption=\"Move scales into state\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb42-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Scatterplot.js</span></a>\n<a class=\"sourceLine\" id=\"cb42-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Scatterplot <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb42-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb42-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">xScale</span><span class=\"op\" style=\"color: #666666;\">:</span> d3</a>\n<a class=\"sourceLine\" id=\"cb42-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb42-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>])</a>\n<a class=\"sourceLine\" id=\"cb42-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span>])<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb42-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">yScale</span><span class=\"op\" style=\"color: #666666;\">:</span> d3</a>\n<a class=\"sourceLine\" id=\"cb42-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb42-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>])</a>\n<a class=\"sourceLine\" id=\"cb42-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>])</a>\n<a class=\"sourceLine\" id=\"cb42-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      Same scale definition code we had before. Linear scales, domain from 0 to\n      1, using props for ranges. But now they’re wrapped in a\n      <code style=\"white-space: pre-wrap;\">state = {}</code> object and it’s\n      <code style=\"white-space: pre-wrap;\">xScale: d3 ...</code> instead of\n      <code style=\"white-space: pre-wrap;\">xScale = d3 ...</code>.\n    </p>\n    <p>Our render function should use these as well. Small change:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb43\"\n      data-caption=\"Render function uses state scales\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb43-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Scatterplot.js</span></a>\n<a class=\"sourceLine\" id=\"cb43-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb43-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> data<span class=\"op\" style=\"color: #666666;\">,</span> height <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb43-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">{</span> yScale<span class=\"op\" style=\"color: #666666;\">,</span> xScale <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb43-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb43-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb43-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb43-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(([x<span class=\"op\" style=\"color: #666666;\">,</span> y]) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>circle cx<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"at\" style=\"color: #7d9029;\">xScale</span>(<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">satisfied</span><span class=\"op\" style=\"color: #666666;\">:}</span> cy<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"at\" style=\"color: #7d9029;\">yScale</span>(y)<span class=\"op\" style=\"color: #666666;\">}</span> r<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;5&quot;</span> /&gt😉<span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We use destructuring to take our scales from state, then use them when\n      mapping over our data.\n    </p>\n    <p>\n      Clicking on the SVG produces the same result as before, but we’re almost\n      there. Just one more step.\n    </p>\n    <h4 id=\"update-scales-in-getderivedstatefromprops\">\n      Update scales in\n      <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code>\n    </h4>\n    <p>\n      Last step is to update our scales’ ranges in\n      <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code>.\n      This method runs every time React touches our component for any reason.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb44\"\n      data-caption=\"Update scales\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb44-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Scatterplot.js</span></a>\n<a class=\"sourceLine\" id=\"cb44-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Scatterplot <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">PureComponent</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb44-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb44-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">static</span> <span class=\"at\" style=\"color: #7d9029;\">getDerivedStateFromProps</span>(props<span class=\"op\" style=\"color: #666666;\">,</span> state) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb44-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> yScale<span class=\"op\" style=\"color: #666666;\">,</span> xScale <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> state<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb44-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb44-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">yScale</span>.<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb44-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">xScale</span>.<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb44-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb44-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb44-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      ...<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb44-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      yScale<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb44-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      xScale</a>\n<a class=\"sourceLine\" id=\"cb44-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb44-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Take scales from state, update ranges with new values, return new state.\n      Nice and easy.\n    </p>\n    <p>\n      Notice that\n      <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code> is a\n      static method shared by all instances of our Scatterplot component. You\n      have no reference to a\n      <code style=\"white-space: pre-wrap;\">this</code> and have to calculate\n      new state purely from the\n      <code style=\"white-space: pre-wrap;\">props</code> and\n      <code style=\"white-space: pre-wrap;\">state</code> passed into your\n      method.\n    </p>\n    <p>\n      It’s a lot like a Redux reducer, if that helps you think about it. If you\n      don’t know what Redux reducers are, don’t worry. Just remember to return\n      a new version of component state.\n    </p>\n    <p>Your Scatterplot should now update its size on every click.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/scatterplot-resizes.png\"\n        alt=\"Scatterplot resizes\"\n      />\n      <figcaption>Scatterplot resizes</figcaption>\n    </figure>"
        },
        {
          "lectureTitle": "Making your components more flexible with render props",
          "lectureBody": "    <h2 id=\"making-your-components-more-flexible-with-render-props\">\n      Making your components more flexible with render props\n    </h2>\n    <p>\n      Our scatterplot doesn’t look quite as nice as the earlier screenshot.\n      Regular SVG circles with no styling just can’t match up.\n    </p>\n    <p>\n      What if we wanted to render beautiful circles? Or stars? Or maybe\n      something else entirely?\n    </p>\n    <p>\n      We can use render props to give users of our scatterplot component the\n      power to define how they want datapoints to render. 😱\n    </p>\n    <p>\n      Think of it as a sort of inversion of control. Another common buzzword\n      are “slots”, or renderless components. The idea is that one of our props\n      accepts a React component.\n    </p>\n    <p>We then use that prop to render our datapoints.</p>\n    <p>It looks a little like this 👇</p>\n    <pre class=\"jsx\"><code style=\"white-space: pre-wrap;\">&lt;Scatterplot\n  x={10} y={10}\n  data={data}\n  datapoint={(props) =&gt; &lt;Datapoint {...props} /&gt;}\n&gt;</code></pre>\n    <p>\n      What’s more, we can add interactions and other useful stuff to our\n      <code style=\"white-space: pre-wrap;\">&lt;Datapoint&gt;</code> and\n      <code style=\"white-space: pre-wrap;\">&lt;Scatterplot&gt;</code> doesn’t\n      have to know anything about it. All the scatterplot cares about is\n      rendering two axes and a bunch of datapoints.\n    </p>\n    <p>\n      Let’s use the render prop approach to make our scatterplot more reusable.\n    </p>\n    <p>Steps 👇</p>\n    <ul>\n      <li>pass in a render prop</li>\n      <li>use it to render datapoints</li>\n      <li>make datapoint component look nice</li>\n    </ul>\n    <p>\n      You can see\n      <a href=\"https://codesandbox.io/s/j73xlyr8v5\"\n        >my solution on CodeSandbox</a\n      >. I recommend you follow along with your existing code.\n    </p>\n    <iframe\n      src=\"https://codesandbox.io/embed/j73xlyr8v5?codemirror=1&amp;view=split\"\n      style=\"width:100%; height:500px; border😮; border-radius: 4px; overflow:hidden;\"\n      sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"\n    >\n    </iframe>\n    <h3 id=\"pass-in-a-render-prop\">Pass in a render prop</h3>\n    <p>\n      React components are Just JavaScript. Either a JSX function call or a\n      function that returns some JSX.\n    </p>\n    <p>\n      That means we can pass them into components via props. Let’s do that in\n      App.js\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb46\"\n      data-caption=\"Pass render prop into Scatterplot\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb46-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// App.js</span></a>\n<a class=\"sourceLine\" id=\"cb46-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb46-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Datapoint <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;./Datapoint&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb46-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb46-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//..</span></a>\n<a class=\"sourceLine\" id=\"cb46-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span> onClick<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">onClick</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb46-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>Scatterplot</a>\n<a class=\"sourceLine\" id=\"cb46-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">50</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb46-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">50</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb46-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    width<span class=\"op\" style=\"color: #666666;\">={</span>width<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb46-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    height<span class=\"op\" style=\"color: #666666;\">={</span>height<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb46-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb46-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    datapoint<span class=\"op\" style=\"color: #666666;\">={</span>(<span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>Datapoint x<span class=\"op\" style=\"color: #666666;\">={</span>x<span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span>y<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb46-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  /&gt;</a>\n<a class=\"sourceLine\" id=\"cb46-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">&lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a></code></pre>\n    </div>\n    <p>\n      For extra flexibility and readability we’re wrapping our\n      <code style=\"white-space: pre-wrap;\">&lt;Datapoint&gt;</code> component\n      in another function that accepts\n      <code style=\"white-space: pre-wrap;\">x</code> and\n      <code style=\"white-space: pre-wrap;\">y</code> coordinates. This is a\n      common pattern you’ll see with render props 👉 it gives you the ability\n      to pass in props from both the rendering component and the component\n      that’s setting the render prop.\n    </p>\n    <p>\n      Say we wanted Datapoint to know something about our App <em>and</em> our\n      Scatterplot. The scatterplot calls this function with coordinates. We\n      pass those into\n      <code style=\"white-space: pre-wrap;\">&lt;Datapoint&gt;</code>. And\n      because the method is defined inside App, we could pass-in anything\n      that’s defined in the App. Like perhaps\n      <code style=\"white-space: pre-wrap;\">data</code>.\n    </p>\n    <p>\n      Your code will start throwing an error now. Datapoint isn’t defined.\n      Don’t worry, it’s coming soon.\n    </p>\n    <h3 id=\"use-render-prop-to-render-datapoints\">\n      Use render prop to render datapoints\n    </h3>\n    <p>\n      To use our new\n      <code style=\"white-space: pre-wrap;\">datapoint</code> render prop, we\n      have to change how we render the scatterplot. Instead of returning a\n      <code style=\"white-space: pre-wrap;\">&lt;circle&gt;</code> for each\n      iteration of the dataset, we’re calling a function passed in from props.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb47\"\n      data-caption=\"Accept a render prop\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb47-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Scatterplot.js</span></a>\n<a class=\"sourceLine\" id=\"cb47-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb47-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> data<span class=\"op\" style=\"color: #666666;\">,</span> height<span class=\"op\" style=\"color: #666666;\">,</span> datapoint <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb47-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">{</span> yScale<span class=\"op\" style=\"color: #666666;\">,</span> xScale <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb47-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb47-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb47-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb47-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(([x<span class=\"op\" style=\"color: #666666;\">,</span> y]) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"at\" style=\"color: #7d9029;\">datapoint</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb47-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">xScale</span>(<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">satisfied</span><span class=\"op\" style=\"color: #666666;\">:,</span></a>\n<a class=\"sourceLine\" id=\"cb47-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">yScale</span>(y)</a>\n<a class=\"sourceLine\" id=\"cb47-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>))<span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We take the\n      <code style=\"white-space: pre-wrap;\">datapoint</code> function from props\n      and call it in\n      <code style=\"white-space: pre-wrap;\">data.map</code> making sure to pass\n      in <code style=\"white-space: pre-wrap;\">x</code> and\n      <code style=\"white-space: pre-wrap;\">y</code> as an object. Calling\n      functions with objects like this is a common JavaScript pattern to fake\n      named arguments.\n    </p>\n    <h3 id=\"make-datapoint-component-look-nice\">\n      Make datapoint component look nice\n    </h3>\n    <p>\n      We’ve got all the rendering, now all we need is the\n      <code style=\"white-space: pre-wrap;\">&lt;Datapoint</code> component\n      itself. That goes in a new\n      <code style=\"white-space: pre-wrap;\">Datapoint.js</code> file.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb48\"\n      data-caption=\"Datapoint file\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb48-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb48-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> styled <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;styled-components&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb48-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb48-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Circle <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">styled</span>.<span class=\"at\" style=\"color: #7d9029;\">circle</span><span class=\"vs\" style=\"color: #4070a0;\">`</span></a>\n<a class=\"sourceLine\" id=\"cb48-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"vs\" style=\"color: #4070a0;\">  fill: steelblue;</span></a>\n<a class=\"sourceLine\" id=\"cb48-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"vs\" style=\"color: #4070a0;\">  fill-opacity: .7;</span></a>\n<a class=\"sourceLine\" id=\"cb48-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"vs\" style=\"color: #4070a0;\">  stroke: steelblue;</span></a>\n<a class=\"sourceLine\" id=\"cb48-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"vs\" style=\"color: #4070a0;\">  stroke-width: 1.5px;</span></a>\n<a class=\"sourceLine\" id=\"cb48-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"vs\" style=\"color: #4070a0;\">`</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb48-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb48-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Datapoint <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb48-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb48-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb48-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb48-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb48-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>Circle</a>\n<a class=\"sourceLine\" id=\"cb48-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        cx<span class=\"op\" style=\"color: #666666;\">={</span>x<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb48-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        cy<span class=\"op\" style=\"color: #666666;\">={</span>y<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb48-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        r<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">3</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb48-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      /&gt;</a>\n<a class=\"sourceLine\" id=\"cb48-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb48-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb48-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb48-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb48-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Datapoint<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      I’m using styled-components to define the CSS for my Datapoint. You can\n      use whatever you prefer. I like styled components because they’re a good\n      balance between CSS-in-JS and normal CSS syntax.\n    </p>\n    <p>\n      The component itself renders a styled circle using props for positioning\n      and a radius of 3 pixels.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/scatterplot-finished.png\"\n        alt=\"Finished scatterplot\"\n      />\n      <figcaption>Finished scatterplot</figcaption>\n    </figure>\n    <p>\n      For an extra challenge, try rendering circle radius from state and\n      changing datapoint size on mouse over. Make the scatterplot interactive.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "You're awesome",
      "lectures": [
        {
          "lectureTitle": "💪",
          "lectureBody": "    <h1 id=\"youre-awesome\">You’re awesome</h1>\n    <p>You know the basics!</p>\n    <p>\n      You can take any D3 example from the internets and wrap it in a React\n      component, <em>and</em> you know how to build React+D3 components from\n      scratch. You’re amazing. High five! 🖐\n    </p>\n    <p>\n      The rest of this book is about using these concepts and pushing them to\n      the limits of practicality. We’re going to build an interactive\n      visualization of tech salaries compared to median household income.\n    </p>\n    <p>\n      Why? Because it piqued my interest, and because it shows why you should\n      call yourself an engineer, not a programmer or a developer.\n      <strong>You’re an engineer</strong>. Remember that.\n    </p>\n    <p>\n      Throughout the example, you’ll learn more details of D3, tidbits from\n      React, and the animation chapter is going to blow your mind.\n    </p>\n    <p>Super fun!</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/full-dataviz.png\"\n        alt=\"Default view\"\n      />\n      <figcaption>Default view</figcaption>\n    </figure>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/interaction-dataviz.png\"\n        alt=\"After a click\"\n      />\n      <figcaption>After a click</figcaption>\n    </figure>"
        }
      ]
    },
    {
      "sectionTitle": "A note about state",
      "lectures": [
        {
          "lectureTitle": "Handling state in your React app",
          "lectureBody": "    <h1 id=\"state-handling-architecture\">Handling state in your React app</h1>\n    <p>\n      Before I can set you loose on the world, we should talk about managing\n      state. It’s where most engineers shoot themselves in the foot.\n    </p>\n    <p>\n      You’ll notice you shot yourself in the foot six months ago when all of a\n      sudden it becomes near impossible to build new features, add\n      functionality, and know what’s going on with your app. If you find\n      yourself spending a lot of time confused about why your UI does\n      something, you’ve shot yourself in the foot.\n    </p>\n    <p>Don’t worry tho, happens to everyone!</p>\n    <p>\n      I shoot myself in the foot all the time. You can’t predict how your app\n      is going to evolve. You can’t know how technology is going to improve.\n      Can’t know how your team will grow.\n    </p>\n    <p>Best approach is to optimize for change.</p>\n    <p>\n      Otherwise you might have to do a rewrite. Rewrites are bad. One of the\n      most infamous rewrite story is about\n      <a href=\"https://www.joelonsoftware.com/articles/fog0000000069.html\"\n        >The Rewrite that Killed Netscape</a\n      >. You might not even have heard of Netscape 😉\n    </p>\n    <p>Let’s save you from that.</p>"
        },
        {
          "lectureTitle": "Basic architecture we'll use",
          "lectureBody": "    <h2 id=\"basic-architecture\">Basic architecture</h2>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/unidirectionalflow.png\"\n        alt=\"Unidirectional data flow\"\n      />\n      <figcaption>Unidirectional data flow</figcaption>\n    </figure>\n    <p>\n      We’re using a unidirectional data flow architecture with a single source\n      of truth. That means you always know what to expect. Think of your app as\n      a giant circle.\n    </p>\n    <p>\n      Data goes from your source of truth into your components. Events go from\n      your components into your source of truth. All in one direction\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/architecture.png\"\n        alt=\"The basic architecture\"\n      />\n      <figcaption>The basic architecture</figcaption>\n    </figure>\n    <p>\n      Our main App component holds state for your entire application. Anything\n      that multiple components should be aware of lives here. This state flows\n      down the hierarchy via props. Changes happen via callbacks, also passed\n      down through props.\n    </p>\n    <p>Like this 👇</p>\n    <ul>\n      <li>\n        The Main Component – <code style=\"white-space: pre-wrap;\">App</code> –\n        holds the truth\n      </li>\n      <li>Truth flows down through props</li>\n      <li>Child components react to user events</li>\n      <li>They announce changes using callbacks</li>\n      <li>The Main Component updates its truth</li>\n      <li>Updates flow back down the chain</li>\n      <li>UI updates through re-renders</li>\n    </ul>\n    <p>\n      This looks roundabout, but it’s amazing. Far better than worrying about\n      parts of the UI growing out of sync with the rest of your app. I could\n      talk your ear off with debugging horror stories, but I’m nice, so I\n      won’t.\n    </p>\n    <p>\n      When a user clicks one of our controls, a\n      <code style=\"white-space: pre-wrap;\">Toggle</code>, it invokes a\n      callback. This in turn invokes a callback on\n      <code style=\"white-space: pre-wrap;\">ControlRow</code>, which invokes a\n      callback on <code style=\"white-space: pre-wrap;\">Controls</code>, which\n      invokes a callback on <code style=\"white-space: pre-wrap;\">App</code>.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/architecture_callbacks.png\"\n        alt=\"Callback chain\"\n      />\n      <figcaption>Callback chain</figcaption>\n    </figure>\n    <p>\n      With each hop, the nature of our callback changes.\n      <code style=\"white-space: pre-wrap;\">Toggle</code> tells\n      <code style=\"white-space: pre-wrap;\">ControlRow</code> which entry was\n      toggled, <code style=\"white-space: pre-wrap;\">ControlRow</code> tells\n      <code style=\"white-space: pre-wrap;\">Controls</code> how to update the\n      data filter function, and\n      <code style=\"white-space: pre-wrap;\">Controls</code> gives\n      <code style=\"white-space: pre-wrap;\">App</code> a composite filter built\n      from all the controls. You’ll see how that works in the next chapter.\n    </p>\n    <p>\n      All you have to remember right now is that callbacks evolve from passing\n      low-level information to high-level business logic. Starts with\n      <em>“I was clicked”</em> ends with <em>“Update visualization filter”</em>\n    </p>\n    <p>\n      When the final callback is invoked,\n      <code style=\"white-space: pre-wrap;\">App</code> updates its repository of\n      truth – <code style=\"white-space: pre-wrap;\">this.state</code> – and\n      communicates the change back down the chain via props. No additional\n      wiring needed on your part. React’s got you covered.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/architecture_dataflow.png\"\n        alt=\"Data flows down\"\n      />\n      <figcaption>Data flows down</figcaption>\n    </figure>\n    <p>\n      You can think of it like calling functions with new arguments. Because\n      the functions – components – render the UI, your interface updates.\n    </p>\n    <p>\n      Because your components are well-made and rely on their props to render,\n      React’s engine can optimize these changes. It compares the new and old\n      component trees and decides which components to re-render and which to\n      leave alone.\n    </p>\n    <p>Functional programming for HTML! 😎</p>\n    <p>\n      The functional programming concepts we’re relying on are called\n      <a href=\"https://en.wikipedia.org/wiki/Referential_transparency\"\n        >referential transparency</a\n      >,\n      <a href=\"https://en.wikipedia.org/wiki/Idempotence\"\n        >idempotent functions</a\n      >, and\n      <a href=\"https://en.wikipedia.org/wiki/Pure_function\"\n        >functional purity</a\n      >. I suggest Googling them if you want to learn the theory behind it all.\n    </p>"
        },
        {
          "lectureTitle": "What about React Context? Redux? MobX?",
          "lectureBody": "    <h2 id=\"what-about-react-context-redux-mobx\">\n      What about React Context? Redux? MobX?\n    </h2>\n    <p>\n      You may have heard of React Context, Redux, MobX and other state handling\n      libraries. They’re all great in different ways and the internet can’t\n      decide which one is best. Everyone has their own little twist on the\n      story.\n    </p>\n    <p>And yet the basic principles are all the same:</p>\n    <ol type=\"1\">\n      <li>Single source of truth</li>\n      <li>State flows down</li>\n      <li>Updates flow up</li>\n    </ol>\n    <p>\n      Where React Context, Redux, MobX and other libraries help, is how much\n      work it is to build this machinery and keep it running. How much\n      flexibility you get when moving components. Basically how easy it is to\n      change your app later.\n    </p>\n    <p>Remember the rewrite conundrum?</p>\n    <p>\n      Our basic approach binds business structure to UI structure. Your state,\n      your props, your callbacks, they all follow the same hierarchy as your UI\n      does.\n    </p>\n    <p>\n      Want to move the buy button? Great! You have to update the entire chain\n      of components leading from your state to that button.\n    </p>\n    <p>Everything needs new callbacks and new props.</p>\n    <p>\n      This is known as prop drilling and fast becomes super tedious. Rewiring\n      your whole app just to move a single button is no fun.\n    </p>\n    <p>\n      To solve this problem, React Context, Redux, MobX, etc. decouple your\n      business logic from your UI architecture. Take state out of the main\n      component and move it into its own object. Connect everything to that\n      instead.\n    </p>\n    <p>[picture]</p>\n    <p>\n      Now it doesn’t matter where you move that button. It still triggers the\n      same function on the same state. Every other component that cares about\n      that state updates too.\n    </p>\n    <p>\n      Different libraries have different details for how that works, but they\n      all follow the same idea and solve the same problem.\n    </p>\n    <hr />\n    <p>\n      We’re sticking with the basic approach because it’s easier to explain,\n      works without additional libraries, and is Good Enough™.\n    </p>\n    <p>\n      You can see an approach to using Redux in dataviz in the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906668#animating-react-redux\"\n        >Animating with React, Redux, and D3 chapter</a\n      >, and we tackle MobX in the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906696\"\n        >MobX chapter</a\n      >.\n    </p>"
        },
        {
          "lectureTitle": "How to structure your app",
          "lectureBody": "    <h1 id=\"structuring-your-app\">How to structure your app</h1>\n    <p>\n      Our app is built from components. You already know how components work.\n      Where it gets tricky is deciding where one component ends and another\n      beings.\n    </p>\n    <p>\n      One of the hardest problems in software engineering I’d say. Defining the\n      boundaries and interfaces between objects. Entire books have been written\n      on the subject.\n    </p>\n    <p>\n      You’ll learn most of it with experience. Just through trying different\n      approaches, seeing what works, and developing your taste. Like a chef\n      gets better at improvisation the more things they try. Or a musician.\n    </p>\n    <p>\n      To get you started, here’s a rule of thumb that I like to use: if you\n      have to use the word “and” to describe what your component does, then it\n      should become two components. If you build the same feature multiple\n      times, turn it into a component.\n    </p>\n    <p>\n      You can then remix components into larger components where it makes\n      sense, or you can keep them separate. It makes sense to combine when\n      multiple small components have to work together to build a big feature.\n    </p>\n    <p>This architecture often mimics the design of your UI.</p>\n    <p>\n      For example: our tech salary visualization is going to use 1 very top\n      level component, 5 major components, and a bunch of child components.\n    </p>\n    <ul>\n      <li>\n        <code style=\"white-space: pre-wrap;\">App</code> is the very top level\n        component; it keeps everything together\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">Title</code> renders the dynamic\n        title\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">Description</code> renders the\n        dynamic description\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">Histogram</code> renders the\n        histogram and has child components for the axis and histogram bars\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">CountyMap</code> renders the\n        choropleth map and uses child components for the counties\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">Controls</code> renders the rows\n        of buttons that let users explore our dataset\n      </li>\n    </ul>\n    <p>\n      Most of these are specific to our use case, but\n      <code style=\"white-space: pre-wrap;\">Histogram</code> and\n      <code style=\"white-space: pre-wrap;\">CountyMap</code> have potential to\n      be used elsewhere. We’ll keep that in mind when we build them.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">Histogram</code>,\n      <code style=\"white-space: pre-wrap;\">CountyMap</code>, and\n      <code style=\"white-space: pre-wrap;\">Controls</code> are going to have\n      their own folder inside\n      <code style=\"white-space: pre-wrap;\">src/components/</code> to help us\n      group major components with their children. An\n      <code style=\"white-space: pre-wrap;\">index.js</code> file will help with\n      imports.\n    </p>\n    <p>\n      We’ll use a <code style=\"white-space: pre-wrap;\">Meta</code> folder for\n      all our metadata components like\n      <code style=\"white-space: pre-wrap;\">Title</code> and\n      <code style=\"white-space: pre-wrap;\">Description</code>. We don’t\n      <em>have</em> to do this, but\n      <code style=\"white-space: pre-wrap;\"\n        >import { Title, Description } from './Meta'</code\n      >\n      looks better than separate imports for related-but-different components.\n      Namespacing, if you will.\n    </p>\n    <p>\n      We want to access every component with\n      <code style=\"white-space: pre-wrap;\"\n        >import My Component from './MyComponent'</code\n      >\n      and render as\n      <code style=\"white-space: pre-wrap;\"\n        >&lt;MyComponent {...params} /&gt;</code\n      >. Something is wrong, if a parent component has to know details about\n      the implementation of a child component.\n    </p>\n    <p>\n      You can read more about these ideas by Googling\n      <a href=\"https://en.wikipedia.org/wiki/Leaky_abstraction\"\n        >“leaky abstractions”</a\n      >,\n      <a href=\"https://en.wikipedia.org/wiki/Single_responsibility_principle\"\n        >“single responsibility principle”</a\n      >,\n      <a href=\"https://en.wikipedia.org/wiki/Separation_of_concerns\"\n        >“separation of concerns”</a\n      >, and\n      <a href=\"https://en.wikipedia.org/wiki/Structured_programming\"\n        >“structured programming”</a\n      >. Books from the late 90’s and early 2000’s (when object-oriented\n      programming was The Future™) have the best curated info in my experience.\n    </p>"
        },
        {
          "lectureTitle": "Congratz!",
          "lectureBody": "    <p>\n      Congratz! You know everything you need to build visualizations with React\n      and D3. 👏\n    </p>\n    <p>\n      This is the point in tech books where I run off and start building things\n      on my own. Then I get frustrated, spend hours Googling for answers, and\n      then remember, “Hey! Maybe I should read the rest of the book!”\n    </p>\n    <p>\n      Reading the rest of the book helps. I’ll show you how all this fits\n      together into a larger project.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Set up your local environment",
      "lectures": [
        {
          "lectureTitle": "Local environment setup",
          "lectureBody": "    <h1 id=\"getting-started\">\n      Set up a local environment with create-react-app\n    </h1>\n    <p>\n      Can you believe this is the third time I’m writing a\n      <em>“How to set up all the tools and get started”</em> section? The\n      ecosystem moves fast!\n    </p>\n    <p>\n      You can see the old versions in the ebook as Appendix A – a roll-your-own\n      environment that’s almost the same as the one I’m about to show you, and\n      Appendix B – a browserify-based environment (if you don’t like Webpack).\n    </p>\n    <p>\n      In the summer of 2016, the React team released a tool called\n      <code style=\"white-space: pre-wrap;\">create-react-app</code>. It creates\n      a React app so that you can get started right away. All of the code in\n      this book runs with an app set up like this.\n    </p>\n    <p>Getting started with React has never been easier.</p>\n    <ol type=\"1\">\n      <li>Make sure you have node.js</li>\n      <li>Install the app generator</li>\n      <li>Run the app generator</li>\n    </ol>"
        },
        {
          "lectureTitle": "Start with create-react-app",
          "lectureBody": "    <h2 id=\"make-sure-you-have-node.js\">Make sure you have node.js</h2>\n    <p>\n      Modern JavaScript development runs on node.js. Your code still ends up in\n      a browser, but there are a few steps it has to go through before it gets\n      there. Those toolchains run on node.js.\n    </p>\n    <p>\n      Go to <a href=\"https://nodejs.org/en/\">nodejs.org</a>, download one of\n      the latest versions, and run the installer. You can pick the more stable\n      LTS (long-term-support) version, or the more gimme-all-the-features\n      version. JavaScript toolchains run fine in both.\n    </p>\n    <p>\n      Server-side rendering might be easier with the fancy-pants version. More\n      on that later.\n    </p>\n    <h2 id=\"install-create-react-app\">Install create-react-app</h2>\n    <p>Great, you have node and you’re ready to go.</p>\n    <p>Run this command in a terminal:</p>\n    <pre\n      data-caption=\"Install create-react-app\"\n    ><code style=\"white-space: pre-wrap;\">$ npm install -g create-react-app</code></pre>\n    <p>\n      This installs a global npm package called\n      <code style=\"white-space: pre-wrap;\">create-react-app</code>. Its job is\n      to create a directory and install\n      <code style=\"white-space: pre-wrap;\">react-scripts</code>.\n    </p>\n    <p>Confusing, I know.</p>\n    <p>\n      You can think of\n      <code style=\"white-space: pre-wrap;\">create-react-app</code> and\n      <code style=\"white-space: pre-wrap;\">react-scripts</code> as two parts of\n      the same construction. The first is a lightweight script that you can\n      install globally and never update; the second is where the work happens.\n      You want this one to be fresh every time you start a new app.\n    </p>\n    <p>\n      Keeping a global dependency up to date would suck, especially considering\n      there have been six major updates since Facebook first launched\n      <code style=\"white-space: pre-wrap;\">create-react-app</code> in July\n      2016.\n    </p>\n    <h2 id=\"run-create-react-app\">Run create-react-app</h2>\n    <p>\n      Superb! You have\n      <code style=\"white-space: pre-wrap;\">create-react-app</code>. Time to\n      create an app and get started with some coding.\n    </p>\n    <p>Run this in a terminal:</p>\n    <pre\n      data-caption=\"Create your project\"\n    ><code style=\"white-space: pre-wrap;\">$ create-react-app react-d3js-example</code></pre>\n    <p>\n      Congratulations! You just created a React app. <em>With</em> all the\n      setup and the fuss that goes into using a modern JavaScript toolchain.\n    </p>\n    <p>Your next step is to run your app:</p>\n    <pre\n      data-caption=\"Start your dev server\"\n    ><code style=\"white-space: pre-wrap;\">$ cd react-d3js-example\n$ npm start</code></pre>\n    <p>A browser tab should open with a page that looks like this:</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/initial-app.png\"\n        alt=\"Initial React app\"\n      />\n      <figcaption>Initial React app</figcaption>\n    </figure>\n    <p>\n      If that didn’t work, then something must have gone terribly wrong. You\n      should consult\n      <a href=\"https://github.com/facebookincubator/create-react-app\"\n        >the official docs</a\n      >. Maybe that will help.\n    </p>"
        },
        {
          "lectureTitle": "What you get",
          "lectureBody": "    <h2 id=\"what-you-get\">What you get</h2>\n    <p>\n      Running\n      <code style=\"white-space: pre-wrap;\">create-react-app</code> installs\n      tools and libraries. There’s around 80MB of them as of October 2016. This\n      is why using a generator is easier than slogging through on your own.\n    </p>\n    <p>\n      Crucially, there is a single dependency in your project –\n      <code style=\"white-space: pre-wrap;\">react-scripts</code>. But it gives\n      you everything you need to build modern React apps.\n    </p>\n    <ul>\n      <li>\n        <strong>Webpack</strong> - a module bundler and file loader. It turns\n        your app into a single JavaScript file, and it even lets you import\n        images and styles like they were code.\n      </li>\n      <li>\n        <strong>Babel</strong> - a JavaScript transpiler. It turns your modern\n        JS code (ES6, ECMAScript2015, 2016, ES7, whatever you call it) into\n        code that can run on real world browsers. It’s the ecosystem’s answer\n        to slow browser adoption.\n      </li>\n      <li>\n        <strong>ESLint</strong> - linting! It annoys you when you write code\n        that is bad. This is a good thing. 😄\n      </li>\n      <li>\n        <strong>Jest</strong> - a test runner. Having tests set up from the\n        beginning of a project is a good idea. We won’t really write tests in\n        this book, but I will show you how it’s done.\n      </li>\n    </ul>\n    <p>\n      All tools come preconfigured with sane defaults and ready to use. You\n      have no idea how revolutionary this is. Check the appendixes to see how\n      hard setting up an environment used to be. I’m so happy that\n      <code style=\"white-space: pre-wrap;\">create-react-app</code> exists.\n    </p>\n    <hr />\n    <p>\n      Besides the toolchain,\n      <code style=\"white-space: pre-wrap;\">create-react-app</code> also gives\n      you a default directory structure and a ton of helpful docs.\n    </p>\n    <p>\n      You should read the\n      <code style=\"white-space: pre-wrap;\">README.md</code> file. It’s full of\n      great advice, and it goes into more detail about the app generator than\n      we can get into here. The team also makes sure it’s kept up-to-date.\n    </p>\n    <p>\n      All of the code samples in this book are going to follow the default\n      directory structure. Public assets like HTML files, datasets, and some\n      images go into <code style=\"white-space: pre-wrap;\">public/</code>. Code\n      goes into <code style=\"white-space: pre-wrap;\">src/</code>.\n    </p>\n    <p>\n      Code is anything that we\n      <code style=\"white-space: pre-wrap;\">import</code> or\n      <code style=\"white-space: pre-wrap;\">require()</code>. That includes\n      JavaScript files themselves, as well as stylesheets and images.\n    </p>\n    <p>\n      You can poke around\n      <code style=\"white-space: pre-wrap;\">src/App.js</code> to see how it’s\n      structured and what happens when you change something. You’re going to\n      change bits and pieces of this file as you go through the book.\n    </p>\n    <p>\n      I suggest you keep\n      <code style=\"white-space: pre-wrap;\">npm start</code> running at all\n      times while coding. The browser will refresh on every code change, so\n      you’ll be able to see instant results.\n    </p>"
        },
        {
          "lectureTitle": "Install extra dependencies",
          "lectureBody": "    <h2 id=\"install-dependencies\">\n      Install dependencies for React for Datavisualization\n    </h2>\n    <p>\n      There are a couple of libraries we’re going to use often in this book:\n      D3, Topojson, and Lodash. We’re using D3 to do our heavy lifting,\n      Topojson to parse geographical data, and Lodash to make data manipulation\n      easier.\n    </p>\n    <p>You can install them like this:</p>\n    <pre\n      data-caption=\"Install dependencies\"\n    ><code style=\"white-space: pre-wrap;\">$ npm install --save d3 topojson lodash</code></pre>\n    <p>\n      Additionally, we’re using Bootstrap for default styling and String for\n      string manipulation. You should install them as well.\n    </p>\n    <pre\n      data-caption=\"Styling and string manipulation\"\n    ><code style=\"white-space: pre-wrap;\">$ npm install --save bootstrap string</code></pre>\n    <p>\n      Now your environment is ready! You should see a default React App page in\n      the browser without errors. Keep\n      <code style=\"white-space: pre-wrap;\">npm start</code> running as you\n      follow the examples in this book.\n    </p>\n    <p>\n      Some examples are going to need other libraries. When that happens, I’ll\n      remind you to install them.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "176,113 tech salaries visualized – a dataviz dashboard",
      "lectures": [
        {
          "lectureTitle": "176,113 tech salaries visualized",
          "lectureBody": "    <h1 id=\"salary-visualization\">\n      A big example project - 176,113 tech salaries visualized\n    </h1>\n    <p>We’re going to build this:</p>\n    <p>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/full-dataviz.png\"\n      />\n    </p>\n    <p>\n      An interactive visualization dashboard app with a choropleth map and a\n      histogram comparing tech salaries to median household income in the area.\n      Users can filter by year, job title, or US state to get a better view.\n    </p>\n    <p>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/interaction-dataviz.png\"\n      />\n    </p>\n    <p>It’s going to be great.</p>\n    <p>\n      At this point, I assume you’ve used\n      <code style=\"white-space: pre-wrap;\">create-react-app</code> to set up\n      your environment. Check the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6888622#getting-started\"\n        >getting started</a\n      >\n      section if you haven’t. I’m also assuming you’ve read the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887708#the-meat-start\"\n        >basics chapter</a\n      >. I’m still going to explain what we’re doing, but knowing the basics\n      helps.\n    </p>\n    <p>\n      I suggest you follow along, keep\n      <code style=\"white-space: pre-wrap;\">npm start</code> running, and watch\n      your visualization change in real time as you code. It’s rewarding as\n      hell.\n    </p>\n    <p>\n      If you get stuck, you can use my\n      <a href=\"https://github.com/Swizec/react-d3js-step-by-step\"\n        >react-d3js-step-by-step Github repo</a\n      >\n      to jump between steps. The\n      <a href=\"https://github.com/Swizec/react-d3js-step-by-step/releases\"\n        >9 tags</a\n      >\n      correspond to the code at the end of each step. Download the first tag\n      and run <code style=\"white-space: pre-wrap;\">npm install</code> to skip\n      the initial setup.\n    </p>\n    <p>\n      If you want to see how this project evolved over 22 months, check\n      <a href=\"https://github.com/Swizec/h1b-software-salaries\"\n        >the original repo</a\n      >. The\n      <a\n        href=\"https://github.com/Swizec/h1b-software-salaries/tree/modern-code\"\n        >modern-code</a\n      >\n      branch has the code you’re about to build.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Show a Preloader",
      "lectures": [
        {
          "lectureTitle": "Show a Preloader",
          "lectureBody": "    <h1 id=\"show-a-preloader\">Show a Preloader</h1>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/preloader-screenshot.png\"\n        alt=\"Preloader screenshot\"\n      />\n      <figcaption>Preloader screenshot</figcaption>\n    </figure>\n    <p>\n      Our preloader is a screenshot of the final result. Usually you’d have to\n      wait until the end of the project to make that, but I’ll just give you\n      mine. Starting with the preloader makes sense for two reasons:\n    </p>\n    <ol type=\"1\">\n      <li>It’s nicer than looking at a blank screen while data loads</li>\n      <li>It’s a good sanity check for our environment</li>\n    </ol>\n    <p>\n      We’re using a screenshot of the final result because the full dataset\n      takes a few seconds to load, parse, and render. It looks better if\n      visitors see something informative while they wait.\n    </p>\n    <p>\n      React Suspense is about to make building preloaders a whole lot better.\n      Adapting to the user’s network speed, built-in preload functionality,\n      stuff like that. More on that in the chapter on React Suspense and Time\n      Slicing.\n    </p>\n    <p>\n      Make sure you’ve installed\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6888625#install-dependencies\"\n        >all dependencies</a\n      >\n      and that <code style=\"white-space: pre-wrap;\">npm start</code> is\n      running.\n    </p>\n    <p>We’re building our preloader in 4 steps:</p>\n    <ol type=\"1\">\n      <li>Get the image</li>\n      <li>\n        Make the\n        <code style=\"white-space: pre-wrap;\">Preloader</code> component\n      </li>\n      <li>Update <code style=\"white-space: pre-wrap;\">App</code></li>\n      <li>\n        Load Bootstrap styles in\n        <code style=\"white-space: pre-wrap;\">index.js</code>\n      </li>\n    </ol>"
        },
        {
          "lectureTitle": "Step1: get image",
          "lectureBody": "    <h2 id=\"step-1-get-the-image\">Step 1: Get the image</h2>\n    <p>\n      Download\n      <a\n        href=\"https://raw.githubusercontent.com/Swizec/react-d3js-step-by-step/798ec9eca54333da63b91c66b93339565d6d582a/src/assets/preloading.png\"\n        >my screenshot from Github</a\n      >\n      and save it in\n      <code style=\"white-space: pre-wrap;\">src/assets/preloading.png</code>. It\n      goes in the\n      <code style=\"white-space: pre-wrap;\">src/assets/</code> directory because\n      we’re going to <code style=\"white-space: pre-wrap;\">import</code> it in\n      JavaScript (which makes it part of our source code), and I like to put\n      non-JavaScript files in\n      <code style=\"white-space: pre-wrap;\">assets</code>. Keeps the project\n      organized.\n    </p>"
        },
        {
          "lectureTitle": "Step 2: make component",
          "lectureBody": "    <h2 id=\"step-2-preloader-component\">Step 2: Preloader component</h2>\n    <p>\n      Our <code style=\"white-space: pre-wrap;\">Preloader</code> is a small\n      component that pretends it’s the\n      <code style=\"white-space: pre-wrap;\">App</code> and renders a static\n      title, description, and a screenshot of the end result. It goes in\n      <code style=\"white-space: pre-wrap;\">src/components/Preloader.js</code>.\n    </p>\n    <p>\n      We’ll put all of our components in\n      <code style=\"white-space: pre-wrap;\">src/components/</code>.\n    </p>\n    <p>\n      We start the component off with some imports, an export, and a functional\n      stateless component that returns an empty div element.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb54\"\n      data-caption=\"Preloader skeleton\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb54-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Preloader.js</span></a>\n<a class=\"sourceLine\" id=\"cb54-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb54-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb54-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb54-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> PreloaderImg <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;../assets/preloading.png&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb54-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb54-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Preloader <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb54-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App container&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb54-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb54-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb54-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb54-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb54-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Preloader<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We <code style=\"white-space: pre-wrap;\">import</code> React (which we\n      need to make JSX syntax work) and the\n      <code style=\"white-space: pre-wrap;\">PreloaderImg</code> for our image.\n      We can import images because of the Webpack configuration that comes with\n      <code style=\"white-space: pre-wrap;\">create-react-app</code>. The webpack\n      image loader returns a URL that we put in the\n      <code style=\"white-space: pre-wrap;\">PreloaderImg</code> constant.\n    </p>\n    <p>\n      At the bottom, we\n      <code style=\"white-space: pre-wrap;\">export default Preloader</code> so\n      that we can use it in\n      <code style=\"white-space: pre-wrap;\">App.js</code> as\n      <code style=\"white-space: pre-wrap;\">import Preloader</code>. Default\n      exports are great when your file exports a single object. Named exports\n      when you want to export multiple items. You’ll see that play out in the\n      rest of this project.\n    </p>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">Preloader</code> function takes\n      no props (because we don’t need any) and returns an empty\n      <code style=\"white-space: pre-wrap;\">div</code>. Let’s fill it in.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb55\"\n      data-caption=\"Preloader content\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb55-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Preloader.js</span></a>\n<a class=\"sourceLine\" id=\"cb55-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb55-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Preloader <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb55-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App container&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb55-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>h1<span class=\"op\" style=\"color: #666666;\">&gt;</span>The average H1B <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">in</span> tech pays $86<span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">164</span>/year&lt;/h1<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb55-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>p className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;lead&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb55-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            Since <span class=\"dv\" style=\"color: #40a070;\">2012</span> the US tech industry has sponsored <span class=\"dv\" style=\"color: #40a070;\">176</span><span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">075</span> H1B work</a>\n<a class=\"sourceLine\" id=\"cb55-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">visas</span>. <span class=\"at\" style=\"color: #7d9029;\">Most</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">of</span> them paid <span class=\"op\" style=\"color: #666666;\">&lt;</span>b<span class=\"op\" style=\"color: #666666;\">&gt;</span>$60<span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">660</span> to $111<span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">668</span>&lt;/b<span class=\"op\" style=\"color: #666666;\">&gt;</span> per <span class=\"at\" style=\"color: #7d9029;\">year</span> (<span class=\"dv\" style=\"color: #40a070;\">1</span></a>\n<a class=\"sourceLine\" id=\"cb55-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            standard deviation).<span class=\"op\" style=\"color: #666666;\">{</span><span class=\"st\" style=\"color: #4070a0;\">&quot; &quot;</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb55-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>span<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb55-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                The best city <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">for</span> an H1B is <span class=\"op\" style=\"color: #666666;\">&lt;</span>b<span class=\"op\" style=\"color: #666666;\">&gt;</span>Kirkland<span class=\"op\" style=\"color: #666666;\">,</span> WA&lt;/b<span class=\"op\" style=\"color: #666666;\">&gt;</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">with</span> an average</a>\n<a class=\"sourceLine\" id=\"cb55-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                individual salary <span class=\"op\" style=\"color: #666666;\">&lt;</span>b<span class=\"op\" style=\"color: #666666;\">&gt;</span>$39<span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">465</span> above local household median&lt;/b<span class=\"op\" style=\"color: #666666;\">&gt;</span>.</a>\n<a class=\"sourceLine\" id=\"cb55-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                Median household salary is a good proxy <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">for</span> cost <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">of</span> living <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">in</span> an</a>\n<a class=\"sourceLine\" id=\"cb55-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"va\" style=\"color: #19177c;\">area</span>.</a>\n<a class=\"sourceLine\" id=\"cb55-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/span<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb55-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/p<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb55-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>img</a>\n<a class=\"sourceLine\" id=\"cb55-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            src<span class=\"op\" style=\"color: #666666;\">={</span>PreloaderImg<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb55-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            style<span class=\"op\" style=\"color: #666666;\">={{</span> <span class=\"dt\">width</span><span class=\"op\">:</span> <span class=\"st\">&quot;100%&quot;</span> <span class=\"op\">}}</span></a>\n<a class=\"sourceLine\" id=\"cb55-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            alt<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;Loading preview&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb55-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        /&gt;</a>\n<a class=\"sourceLine\" id=\"cb55-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>h2 className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;text-center&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span>Loading <span class=\"va\" style=\"color: #19177c;\">data</span> ...&lt;/h2<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb55-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb55-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      A little cheating with grabbing copy from the future, but that’s okay. In\n      real life you’d use some temporary text, then fill it in later.\n    </p>\n    <p>\n      The code itself looks like HTML. We have the usual tags -\n      <code style=\"white-space: pre-wrap;\">h1</code>,\n      <code style=\"white-space: pre-wrap;\">p</code>,\n      <code style=\"white-space: pre-wrap;\">b</code>,\n      <code style=\"white-space: pre-wrap;\">img</code>, and\n      <code style=\"white-space: pre-wrap;\">h2</code>. That’s what I like about\n      JSX: it’s familiar. Even if you don’t know React, you can guess what’s\n      going on here.\n    </p>\n    <p>\n      But look at the <code style=\"white-space: pre-wrap;\">img</code> tag: the\n      <code style=\"white-space: pre-wrap;\">src</code> attribute is dynamic,\n      defined by <code style=\"white-space: pre-wrap;\">PreloaderImg</code>, and\n      the <code style=\"white-space: pre-wrap;\">style</code> attribute takes an\n      object, not a string. That’s because JSX is more than HTML; it’s\n      JavaScript. Think of props as function arguments – any valid JavaScript\n      fits.\n    </p>\n    <p>That will be a cornerstone of our project.</p>"
        },
        {
          "lectureTitle": "Step 3: Update App",
          "lectureBody": "    <h2 id=\"step-3-update-app\">Step 3: Update App</h2>\n    <p>\n      We use our new Preloader component in App –\n      <code style=\"white-space: pre-wrap;\">src/App.js</code>. Let’s remove the\n      <code style=\"white-space: pre-wrap;\">create-react-app</code> defaults and\n      import our\n      <code style=\"white-space: pre-wrap;\">Preloader</code> component.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb56\"\n      data-caption=\"Revamp App.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb56-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb56-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb56-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb56-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Delete the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb56-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> logo <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./logo.svg&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb56-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./App.css&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb56-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb56-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb56-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb56-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Preloader <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Preloader&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb56-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb56-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb56-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb56-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Delete the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb56-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb56-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb56-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb56-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App-header&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb56-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          <span class=\"op\" style=\"color: #666666;\">&lt;</span>img src<span class=\"op\" style=\"color: #666666;\">={</span>logo<span class=\"op\" style=\"color: #666666;\">}</span> className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App-logo&quot;</span> alt<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;logo&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb56-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          <span class=\"op\" style=\"color: #666666;\">&lt;</span>h2<span class=\"op\" style=\"color: #666666;\">&gt;</span>Welcome to React&lt;/h2<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb56-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb56-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>p className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App-intro&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb56-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          To get started<span class=\"op\" style=\"color: #666666;\">,</span> edit <span class=\"op\" style=\"color: #666666;\">&lt;</span>code<span class=\"op\" style=\"color: #666666;\">&gt;</span>src/<span class=\"va\" style=\"color: #19177c;\">App</span>.<span class=\"at\" style=\"color: #7d9029;\">js</span>&lt;/code<span class=\"op\" style=\"color: #666666;\">&gt;</span> and save to <span class=\"va\" style=\"color: #19177c;\">reload</span>.</a>\n<a class=\"sourceLine\" id=\"cb56-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/p<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb56-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb56-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb56-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb56-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb56-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb56-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb56-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> App<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We removed the logo and style imports, added an import for\n      <code style=\"white-space: pre-wrap;\">Preloader</code>, and gutted the\n      <code style=\"white-space: pre-wrap;\">App</code> class. It’s great for a\n      default app, but we don’t need that anymore.\n    </p>\n    <p>\n      Let’s define a default\n      <code style=\"white-space: pre-wrap;\">state</code> and a\n      <code style=\"white-space: pre-wrap;\">render</code> method that uses our\n      <code style=\"white-space: pre-wrap;\">Preloader</code> component when\n      there’s no data.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb57\"\n      data-caption=\"Render our preloader\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb57-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb57-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb57-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb57-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb57-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb57-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">techSalaries</span><span class=\"op\" style=\"color: #666666;\">:</span> []</a>\n<a class=\"sourceLine\" id=\"cb57-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb57-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb57-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb57-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> techSalaries <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb57-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb57-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"va\" style=\"color: #19177c;\">techSalaries</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb57-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb57-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>Preloader /<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb57-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb57-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb57-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb57-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb57-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb57-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb57-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb57-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb57-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb57-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb57-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Nowadays we can define properties directly in the class body without a\n      constructor method. It’s not part of the official JavaScript standard\n      yet, but most React codebases use this pattern.\n    </p>\n    <p>\n      Properties defined this way are bound to each instance of our components\n      so they have the correct\n      <code style=\"white-space: pre-wrap;\">this</code> value. Late you’ll see\n      we can use this shorthand to neatly define event handlers.\n    </p>\n    <p>\n      We set <code style=\"white-space: pre-wrap;\">techSalaries</code> to an\n      empty array by default. In\n      <code style=\"white-space: pre-wrap;\">render</code> we use object\n      destructuring to take\n      <code style=\"white-space: pre-wrap;\">techSalaries</code> out of component\n      state, <code style=\"white-space: pre-wrap;\">this.state</code>, and check\n      whether it’s empty. When\n      <code style=\"white-space: pre-wrap;\">techSalaries</code> is empty our\n      component renders the preloader, otherwise an empty div.\n    </p>\n    <p>\n      If your <code style=\"white-space: pre-wrap;\">npm start</code> is running,\n      the preloader should show up on your screen.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/preloader-without-styles-screenshot.png\"\n        alt=\"Preloader without Bootstrap styles\"\n      />\n      <figcaption>Preloader without Bootstrap styles</figcaption>\n    </figure>\n    <p>Hmm… that’s not very pretty. Let’s fix it.</p>"
        },
        {
          "lectureTitle": "Step 4: Load styles",
          "lectureBody": "    <h2 id=\"step-4-load-bootstrap-styles\">Step 4: Load Bootstrap styles</h2>\n    <p>\n      We’re going to use Bootstrap styles to avoid reinventing the wheel. We’re\n      ignoring their JavaScript widgets and the amazing integration built by\n      the\n      <a href=\"https://react-bootstrap.github.io/\">react-bootstrap</a> team.\n      Just the stylesheets please.\n    </p>\n    <p>\n      They’ll make our fonts look better, help with layouting, and make buttons\n      look like buttons. We <em>could</em> use styled components, but writing\n      our own styles detracts from this tutorial.\n    </p>\n    <p>\n      We load stylesheets in\n      <code style=\"white-space: pre-wrap;\">src/index.js</code>.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb58\"\n      data-caption=\"Add Bootstrap in index.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb58-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb58-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb58-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb58-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> ReactDOM <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react-dom&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb58-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> App <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./App&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb58-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb58-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;bootstrap/dist/css/bootstrap.css&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb58-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb58-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb58-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">ReactDOM</span>.<span class=\"at\" style=\"color: #7d9029;\">render</span>(</a>\n<a class=\"sourceLine\" id=\"cb58-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>App /<span class=\"op\" style=\"color: #666666;\">&gt;,</span></a>\n<a class=\"sourceLine\" id=\"cb58-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"va\" style=\"color: #19177c;\">document</span>.<span class=\"at\" style=\"color: #7d9029;\">getElementById</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;root&#39;</span>)</a>\n<a class=\"sourceLine\" id=\"cb58-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Another benefit of Webpack:\n      <code style=\"white-space: pre-wrap;\">import</code>-ing stylesheets. These\n      imports turn into\n      <code style=\"white-space: pre-wrap;\">&lt;style&gt;</code> tags with CSS\n      in their body at runtime.\n    </p>\n    <p>\n      This is also a good opportunity to see how\n      <code style=\"white-space: pre-wrap;\">index.js</code> works to render our\n      app 👇\n    </p>\n    <ol type=\"1\">\n      <li>loads <code style=\"white-space: pre-wrap;\">App</code> and React</li>\n      <li>loads styles</li>\n      <li>\n        Uses <code style=\"white-space: pre-wrap;\">ReactDOM</code> to render\n        <code style=\"white-space: pre-wrap;\">&lt;App /&gt;</code> into the DOM\n      </li>\n    </ol>\n    <p>That’s it.</p>\n    <p>Your preloader screen should look better now.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/preloader-screenshot.png\"\n        alt=\"Preloader screenshot\"\n      />\n      <figcaption>Preloader screenshot</figcaption>\n    </figure>\n    <p>\n      If you don’t, try comparing your changes to this\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/798ec9eca54333da63b91c66b93339565d6d582a\"\n        >diff on Github</a\n      >.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Load and parse your data",
      "lectures": [
        {
          "lectureTitle": "Asynchronously load data",
          "lectureBody": "    <h1 id=\"asynchronously-load-data\">Asynchronously load data</h1>\n    <p>Great! We have a preloader. Time to load some data.</p>\n    <p>\n      We’ll use D3’s built-in data loading methods and tie their promises into\n      React’s component lifecycle. You could talk to a REST API in the same\n      way. Neither D3 nor React care what the datasource is.\n    </p>\n    <p>First, you need some data.</p>\n    <p>\n      Our dataset comes from a few sources. Tech salaries are from\n      <a href=\"https://h1bdata.info\">h1bdata.info</a>, median household incomes\n      come from the US census data, and I got US geo map info from Mike\n      Bostock’s github repositories. Some elbow grease and python scripts tied\n      them all together.\n    </p>\n    <p>\n      You can read about the scraping on my blog\n      <a\n        href=\"https://swizec.com/blog/place-names-county-names-geonames/swizec/7083\"\n        >here</a\n      >,\n      <a href=\"https://swizec.com/blog/facts-us-household-income/swizec/7075\"\n        >here</a\n      >, and\n      <a\n        href=\"https://swizec.com/blog/livecoding-24-choropleth-react-js/swizec/7078\"\n        >here</a\n      >. But it’s not the subject of this book.\n    </p>"
        },
        {
          "lectureTitle": "Step 0: Get data",
          "lectureBody": "    <h2 id=\"step-0-get-the-data\">Step 0: Get the data</h2>\n    <p>\n      Download the 6 data files from\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/8819d9c38b4aef0a0c569e493f088ff9c3bfdf33\"\n        >my step-by-step repository on Github</a\n      >. Put them in your\n      <code style=\"white-space: pre-wrap;\">public/data</code> directory.\n    </p>\n    <p>\n      The quickest way to download each file is to click\n      <code style=\"white-space: pre-wrap;\">View</code>, then right-click\n      <code style=\"white-space: pre-wrap;\">Raw</code> and\n      <code style=\"white-space: pre-wrap;\">Save Link As</code>.\n    </p>"
        },
        {
          "lectureTitle": "Step 1: Prep App.js",
          "lectureBody": "    <h2 id=\"step-1-prep-app.js\">Step 1: Prep App.js</h2>\n    <p>\n      Let’s set up our\n      <code style=\"white-space: pre-wrap;\">App</code> component first. That way\n      you’ll see results as soon data loading starts to work.\n    </p>\n    <p>\n      Start by importing our data loading method -\n      <code style=\"white-space: pre-wrap;\">loadAllData</code> - and both D3 and\n      Lodash. We’ll need them later.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb59\"\n      data-caption=\"Import D3\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb59-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb59-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb59-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb59-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;d3&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb59-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> _ <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;lodash&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb59-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb59-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb59-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Preloader <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Preloader&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb59-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb59-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> loadAllData <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./DataHandling&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb59-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a></code></pre>\n    </div>\n    <p>\n      You already know about default imports. Importing with\n      <code style=\"white-space: pre-wrap;\">{}</code> is how we import named\n      exports. That lets us get multiple things from the same file. You’ll see\n      the export side in Step 2.\n    </p>\n    <p>\n      Don’t worry about the missing\n      <code style=\"white-space: pre-wrap;\">DataHandling</code> file. It’s\n      coming soon.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb60\"\n      data-caption=\"Initiate data loading in App.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb60-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb60-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb60-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb60-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">techSalaries</span><span class=\"op\" style=\"color: #666666;\">:</span> []<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb60-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb60-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">medianIncomes</span><span class=\"op\" style=\"color: #666666;\">:</span> []<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb60-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">countyNames</span><span class=\"op\" style=\"color: #666666;\">:</span> []<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb60-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb60-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb60-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb60-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"at\" style=\"color: #7d9029;\">loadAllData</span>(data <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(data))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb60-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb60-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a></code></pre>\n    </div>\n    <p>\n      We initiate data loading inside the\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> lifecycle\n      hook. It fires when React first mounts our component into the DOM.\n    </p>\n    <p>\n      I like to tie data loading to component mounts because it means you\n      aren’t making requests you’ll never use. In a bigger app, you’d use\n      Redux, MobX, or similar to decouple loading from rendering. Many reasons\n      why.\n    </p>\n    <p>\n      To load our data, we call the\n      <code style=\"white-space: pre-wrap;\">loadAllData</code> function, then\n      use <code style=\"white-space: pre-wrap;\">this.setState</code> in the\n      callback. This updates <code style=\"white-space: pre-wrap;\">App</code>’s\n      state and triggers a re-render, which updates our entire visualization\n      via props.\n    </p>\n    <p>\n      Yes, it <em>would</em> be better to make\n      <code style=\"white-space: pre-wrap;\">loadAllData</code> return a promise\n      instead of expecting a callback. That was giving me trouble for some\n      reason and it doesn’t matter right now anyway.\n    </p>\n    <p>\n      We also add two more entries to our\n      <code style=\"white-space: pre-wrap;\">state</code>:\n      <code style=\"white-space: pre-wrap;\">countyNames</code>, and\n      <code style=\"white-space: pre-wrap;\">medianIncomes</code>. Defining\n      what’s in your component state in advance makes your code easier to read.\n      People, including you, know what to expect.\n    </p>\n    <p>\n      Let’s change the\n      <code style=\"white-space: pre-wrap;\">render</code> method to show a\n      message when our data finishes loading.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb61\"\n      data-caption=\"Show when data loads\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb61-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb61-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb61-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">     <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> techSalaries <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb61-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb61-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">     <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"va\" style=\"color: #19177c;\">techSalaries</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb61-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">         <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb61-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             <span class=\"op\" style=\"color: #666666;\">&lt;</span>Preloader /<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb61-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">         )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb61-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb61-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb61-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb61-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Delete the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb61-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb61-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb61-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb61-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App container&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb61-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>h1<span class=\"op\" style=\"color: #666666;\">&gt;</span>Loaded <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">techSalaries</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span><span class=\"op\" style=\"color: #666666;\">}</span> salaries&lt;/h1<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb61-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb61-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb61-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb61-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We added a <code style=\"white-space: pre-wrap;\">container</code> class to\n      the main <code style=\"white-space: pre-wrap;\">&lt;div&gt;</code> and an\n      <code style=\"white-space: pre-wrap;\">&lt;h1&gt;</code> tag that shows how\n      many datapoints there are. You can use any valid JavaScript in curly\n      braces <code style=\"white-space: pre-wrap;\">{}</code> and JSX will\n      evaluate it. By convention we only use that ability to calculate display\n      values.\n    </p>\n    <p>You should now get an error overlay.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/datahandling-error.png\"\n        alt=\"DataHandling.js not found error overlay\"\n      />\n      <figcaption>DataHandling.js not found error overlay</figcaption>\n    </figure>\n    <p>\n      These nice error overlays come with\n      <code style=\"white-space: pre-wrap;\">create-react-app</code> and make\n      your code easier to debug. No hunting around in the terminal to see\n      compilation errors.\n    </p>\n    <p>Let’s build that file and fill it with our data loading logic.</p>"
        },
        {
          "lectureTitle": "Step 2: Prep data parsing functions",
          "lectureBody": "    <h2 id=\"step-2-prep-data-parsing-functions\">\n      Step 2: Prep data parsing functions\n    </h2>\n    <p>\n      We’re putting data loading logic in a separate file from\n      <code style=\"white-space: pre-wrap;\">App.js</code> because it’s a bunch\n      of functions that work together and don’t have much to do with the\n      <code style=\"white-space: pre-wrap;\">App</code> component itself.\n    </p>\n    <p>We start with two imports and four data parsing functions:</p>\n    <ul>\n      <li>\n        <code style=\"white-space: pre-wrap;\">cleanIncome</code>, which parses\n        each row of household income data\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">dateParse</code>, which we use for\n        parsing dates\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">cleanSalary</code>, which parses\n        each row of salary data\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">cleanUSStateName</code>, which\n        parses US state names\n      </li>\n    </ul>\n    <div\n      class=\"sourceCode\"\n      id=\"cb62\"\n      data-caption=\"Data parsing functions\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb62-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/DataHandling.js</span></a>\n<a class=\"sourceLine\" id=\"cb62-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;d3&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb62-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> _ <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;lodash&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb62-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb62-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> cleanIncome <span class=\"op\" style=\"color: #666666;\">=</span> (d) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb62-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">countyName</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;Name&#39;</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">USstate</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;State&#39;</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">medianIncome</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">Number</span>(d[<span class=\"st\" style=\"color: #4070a0;\">&#39;Median Household Income&#39;</span>])<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">lowerBound</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">Number</span>(d[<span class=\"st\" style=\"color: #4070a0;\">&#39;90% CI Lower Bound&#39;</span>])<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">upperBound</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">Number</span>(d[<span class=\"st\" style=\"color: #4070a0;\">&#39;90% CI Upper Bound&#39;</span>])</a>\n<a class=\"sourceLine\" id=\"cb62-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb62-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb62-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> dateParse <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">timeParse</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;%m/%d/%Y&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb62-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb62-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> cleanSalary <span class=\"op\" style=\"color: #666666;\">=</span> (d) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb62-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"op\" style=\"color: #666666;\">!</span>d[<span class=\"st\" style=\"color: #4070a0;\">&#39;base salary&#39;</span>] <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"at\" style=\"color: #7d9029;\">Number</span>(d[<span class=\"st\" style=\"color: #4070a0;\">&#39;base salary&#39;</span>]) <span class=\"op\" style=\"color: #666666;\">&gt;</span> <span class=\"dv\" style=\"color: #40a070;\">300000</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb62-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb62-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb62-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb62-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"dt\" style=\"color: #902000;\">employer</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">employer</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">submit_date</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">dateParse</span>(d[<span class=\"st\" style=\"color: #4070a0;\">&#39;submit date&#39;</span>])<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">start_date</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">dateParse</span>(d[<span class=\"st\" style=\"color: #4070a0;\">&#39;start date&#39;</span>])<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">case_status</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;case status&#39;</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">job_title</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;job title&#39;</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">clean_job_title</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;job title&#39;</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">base_salary</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">Number</span>(d[<span class=\"st\" style=\"color: #4070a0;\">&#39;base salary&#39;</span>])<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">city</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;city&#39;</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">USstate</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;state&#39;</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">county</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;county&#39;</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">countyID</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;countyID&#39;</span>]</a>\n<a class=\"sourceLine\" id=\"cb62-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb62-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb62-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb62-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> cleanUSStateName <span class=\"op\" style=\"color: #666666;\">=</span> (d) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb62-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">code</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">code</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">id</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">Number</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">name</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">name</span></a>\n<a class=\"sourceLine\" id=\"cb62-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb62-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb62-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> cleanCounty <span class=\"op\" style=\"color: #666666;\">=</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb62-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">id</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">Number</span>(<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb62-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">name</span><span class=\"op\" style=\"color: #666666;\">:</span> name</a>\n<a class=\"sourceLine\" id=\"cb62-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      You’ll see those <code style=\"white-space: pre-wrap;\">d3</code> and\n      <code style=\"white-space: pre-wrap;\">lodash</code> imports a lot.\n    </p>\n    <p>\n      Our data parsing functions all follow the same approach: Take a row of\n      data as <code style=\"white-space: pre-wrap;\">d</code>, return a\n      dictionary with nicer key names, cast any numbers or dates into\n      appropriate formats. They all start as strings.\n    </p>\n    <p>\n      Doing all this parsing now, keeps the rest of our codebase clean.\n      Handling data is always messy. You want to contain that mess as much as\n      possible.\n    </p>"
        },
        {
          "lectureTitle": "Step 3: Load the datasets",
          "lectureBody": "    <h2 id=\"step-3-load-the-datasets\">Step 3: Load the datasets</h2>\n    <p>Now we can use D3 to load our data with fetch requests.</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb63\"\n      data-caption=\"Data loading\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb63-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/DataHandling.js</span></a>\n<a class=\"sourceLine\" id=\"cb63-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> loadAllData <span class=\"op\" style=\"color: #666666;\">=</span> (callback <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">noop</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb63-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">Promise</span>.<span class=\"at\" style=\"color: #7d9029;\">all</span>([</a>\n<a class=\"sourceLine\" id=\"cb63-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">json</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;data/us.json&quot;</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb63-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">csv</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;data/us-county-names-normalized.csv&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> cleanCounty)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb63-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">csv</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;data/county-median-incomes.csv&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> cleanIncome)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb63-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">csv</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;data/h1bs-2012-2016-shortened.csv&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> cleanSalary)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb63-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">tsv</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;data/us-state-names.tsv&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> cleanUSStateName)</a>\n<a class=\"sourceLine\" id=\"cb63-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    ]).<span class=\"at\" style=\"color: #7d9029;\">then</span>(([us<span class=\"op\" style=\"color: #666666;\">,</span> countyNames<span class=\"op\" style=\"color: #666666;\">,</span> medianIncomes<span class=\"op\" style=\"color: #666666;\">,</span> techSalaries<span class=\"op\" style=\"color: #666666;\">,</span> USstateNames]) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb63-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb63-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb63-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      Here you can see another ES6 trick: default argument values. If\n      <code style=\"white-space: pre-wrap;\">callback</code> is undefined, we set\n      it to <code style=\"white-space: pre-wrap;\">_.noop</code> - a function\n      that does nothing. This lets us later call\n      <code style=\"white-space: pre-wrap;\">callback()</code> without worrying\n      whether it’s defined.\n    </p>\n    <p>\n      In version 5, D3 updated its data loading methods to use promises instead\n      of callbacks. You can load a single file using\n      <code style=\"white-space: pre-wrap;\"\n        >d3.csv(\"filename\").then(data =&gt; ....</code\n      >. The promise resolves with your data, or throws an error.\n    </p>\n    <p>\n      If you’re on D3v4 and can’t upgrade, you’ll have to import from\n      <code style=\"white-space: pre-wrap;\">d3-fetch</code>.\n    </p>\n    <p>\n      Each <code style=\"white-space: pre-wrap;\">d3.csv</code> call makes a\n      fetch request, parses the fetched CSV file into an array of JavaScript\n      dictionaries, and passes each row through the provided cleanup function.\n      We pass all median incomes through\n      <code style=\"white-space: pre-wrap;\">cleanIncome</code>, salaries through\n      <code style=\"white-space: pre-wrap;\">cleanSalary</code>, etc.\n    </p>\n    <p>\n      To load multiple files, we use\n      <code style=\"white-space: pre-wrap;\">Promise.all</code> with a list of\n      unresolved promises. Once resolved, our\n      <code style=\"white-space: pre-wrap;\">.then</code> handler gets a list of\n      results. We use array destructuring to expand that list into our\n      respective datasets before running some more logic to tie them together.\n    </p>\n    <p>\n      D3 supports formats like\n      <code style=\"white-space: pre-wrap;\">json</code>,\n      <code style=\"white-space: pre-wrap;\">csv</code>,\n      <code style=\"white-space: pre-wrap;\">tsv</code>,\n      <code style=\"white-space: pre-wrap;\">text</code>, and\n      <code style=\"white-space: pre-wrap;\">xml</code> out of the box. You can\n      make it work with custom data sources through the underlying\n      <code style=\"white-space: pre-wrap;\">request</code> API.\n    </p>\n    <p>\n      PS: we’re using the shortened salary dataset to make page reloads faster\n      while building our project.\n    </p>"
        },
        {
          "lectureTitle": "Step 4: Tie datasets together",
          "lectureBody": "    <h2 id=\"tie-datasets-together\">Step 4: Tie the datasets together</h2>\n    <p>\n      If you add a <code style=\"white-space: pre-wrap;\">console.log</code> to\n      the <code style=\"white-space: pre-wrap;\">.then</code> callback above,\n      you’ll see a bunch of data. Each argument -\n      <code style=\"white-space: pre-wrap;\">us</code>,\n      <code style=\"white-space: pre-wrap;\">countyNames</code>,\n      <code style=\"white-space: pre-wrap;\">medianIncomes</code>,\n      <code style=\"white-space: pre-wrap;\">techSalaries</code>,\n      <code style=\"white-space: pre-wrap;\">USstateNames</code> - holds a parsed\n      dataset from the corresponding file.\n    </p>\n    <p>\n      To tie them together and prepare a dictionary for\n      <code style=\"white-space: pre-wrap;\">setState</code> back in the\n      <code style=\"white-space: pre-wrap;\">App</code> component, we need to add\n      some logic. We’re building a dictionary of county household incomes and\n      removing any empty salaries.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb64\"\n      data-caption=\"Tie our datasets together\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb64-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/DataHandling.js</span></a>\n<a class=\"sourceLine\" id=\"cb64-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">]).<span class=\"at\" style=\"color: #7d9029;\">then</span>(([us<span class=\"op\" style=\"color: #666666;\">,</span> countyNames<span class=\"op\" style=\"color: #666666;\">,</span> medianIncomes<span class=\"op\" style=\"color: #666666;\">,</span> techSalaries<span class=\"op\" style=\"color: #666666;\">,</span> USstateNames]) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb64-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> medianIncomesMap <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{};</span></a>\n<a class=\"sourceLine\" id=\"cb64-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb64-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">medianIncomes</span>.<span class=\"at\" style=\"color: #7d9029;\">filter</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">find</span>(countyNames<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb64-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                     <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"dt\" style=\"color: #902000;\">name</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;countyName&#39;</span>]<span class=\"op\" style=\"color: #666666;\">}</span>))</a>\n<a class=\"sourceLine\" id=\"cb64-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                 .<span class=\"at\" style=\"color: #7d9029;\">forEach</span>((d) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb64-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                     d[<span class=\"st\" style=\"color: #4070a0;\">&#39;countyID&#39;</span>] <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">find</span>(countyNames<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb64-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                            <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"dt\" style=\"color: #902000;\">name</span><span class=\"op\" style=\"color: #666666;\">:</span> d[<span class=\"st\" style=\"color: #4070a0;\">&#39;countyName&#39;</span>]<span class=\"op\" style=\"color: #666666;\">}</span>).<span class=\"at\" style=\"color: #7d9029;\">id</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb64-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                     medianIncomesMap[<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">countyID</span>] <span class=\"op\" style=\"color: #666666;\">=</span> d<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb64-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                 <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb64-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb64-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    techSalaries <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">techSalaries</span>.<span class=\"at\" style=\"color: #7d9029;\">filter</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">!</span><span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">isNull</span>(d))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb64-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb64-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">callback</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb64-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">usTopoJson</span><span class=\"op\" style=\"color: #666666;\">:</span> us<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb64-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">countyNames</span><span class=\"op\" style=\"color: #666666;\">:</span> countyNames<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb64-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">medianIncomes</span><span class=\"op\" style=\"color: #666666;\">:</span> medianIncomesMap<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb64-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">medianIncomesByCounty</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">groupBy</span>(medianIncomes<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;countyName&#39;</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb64-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">medianIncomesByUSState</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">groupBy</span>(medianIncomes<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;USstate&#39;</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb64-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">techSalaries</span><span class=\"op\" style=\"color: #666666;\">:</span> techSalaries<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb64-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">USstateNames</span><span class=\"op\" style=\"color: #666666;\">:</span> USstateNames</a>\n<a class=\"sourceLine\" id=\"cb64-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb64-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Building the income map looks weird because of indentation, but it’s not\n      that bad. We <code style=\"white-space: pre-wrap;\">filter</code> the\n      <code style=\"white-space: pre-wrap;\">medianIncomes</code> array to\n      discard any incomes whose\n      <code style=\"white-space: pre-wrap;\">countyName</code> we can’t find. I\n      made sure they were all unique when I built the datasets.\n    </p>\n    <p>\n      We walk through the filtered array with a\n      <code style=\"white-space: pre-wrap;\">forEach</code>, find the correct\n      <code style=\"white-space: pre-wrap;\">countyID</code>, and add each entry\n      to <code style=\"white-space: pre-wrap;\">medianIncomesMap</code>. When\n      we’re done, we have a large dictionary that maps county ids to their\n      household income data.\n    </p>\n    <p>\n      Then we filter\n      <code style=\"white-space: pre-wrap;\">techSalaries</code> to remove any\n      empty values where the\n      <code style=\"white-space: pre-wrap;\">cleanSalaries</code> function\n      returned <code style=\"white-space: pre-wrap;\">null</code>. That happens\n      when a salary is either undefined or absurdly high.\n    </p>\n    <p>\n      When our data is ready, we call our\n      <code style=\"white-space: pre-wrap;\">callback</code> with a dictionary of\n      the new datasets. To make future access quicker, we use\n      <code style=\"white-space: pre-wrap;\">_.groupBy</code> to build dictionary\n      maps of counties by county name and by US state.\n    </p>\n    <p>\n      You should now see how many salary entries the shortened dataset\n      contains.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/data-loaded-screenshot.png\"\n        alt=\"Data loaded screenshot\"\n      />\n      <figcaption>Data loaded screenshot</figcaption>\n    </figure>\n    <p>\n      If that didn’t work, try comparing your changes to this\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/9f113cdd3bc18535680cb5a4e87a3fd45743c9ae\"\n        >diff on Github</a\n      >.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Render a choropleth map of the US",
      "lectures": [
        {
          "lectureTitle": "Render a choropleth map of the US",
          "lectureBody": "    <h1 id=\"choropleth-map\">Render a choropleth map of the US</h1>\n    <p>\n      With our data in hand, it’s time to draw some pictures. A choropleth map\n      will show us the best places to be in tech.\n    </p>\n    <p>\n      We’re showing the delta between median household salary in a statistical\n      county and the average salary of an individual tech worker on a visa. The\n      darker the blue, the higher the difference.\n    </p>\n    <p>\n      The more a single salary can out-earn an entire household, the better off\n      you are.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/choropleth-map-shortened-dataset.png\"\n        alt=\"Choropleth map with shortened dataset\"\n      />\n      <figcaption>Choropleth map with shortened dataset</figcaption>\n    </figure>\n    <p>\n      There’s a lot of gray on this map because the shortened dataset doesn’t\n      have that many counties. Full dataset is going to look better, I promise.\n    </p>\n    <p>\n      Turns out immigration visa opportunities for techies aren’t evenly\n      distributed throughout the country. Who knew?\n    </p>\n    <p>\n      Just like before, we’re going to start with changes in our\n      <code style=\"white-space: pre-wrap;\">App</code> component, then build the\n      new bit. This time, a\n      <code style=\"white-space: pre-wrap;\">CountyMap</code> component spread\n      over three files:\n    </p>\n    <ul>\n      <li>\n        <code style=\"white-space: pre-wrap;\">CountyMap/index.js</code>, to make\n        imports easier\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">CountyMap/CountyMap.js</code>, for\n        overall map logic\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">CountyMap/County.js</code>, for\n        individual county polygons\n      </li>\n    </ul>"
        },
        {
          "lectureTitle": "Step 1: Prep App.js",
          "lectureBody": "    <h2 id=\"step-1-prep-app.js-1\">Step 1: Prep App.js</h2>\n    <p>\n      You might guess the pattern already: add an import, add a helper method\n      or two, update <code style=\"white-space: pre-wrap;\">render</code>.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb65\"\n      data-caption=\"Import CountyMap component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb65-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb65-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Preloader <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Preloader&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb65-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> loadAllData <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./DataHandling&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb65-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb65-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb65-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> CountyMap <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/CountyMap&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb65-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a></code></pre>\n    </div>\n    <p>\n      That imports the\n      <code style=\"white-space: pre-wrap;\">CountyMap</code> component from\n      <code style=\"white-space: pre-wrap;\">components/CountyMap/</code>. Your\n      browser will show an error overlay about some file or another until we’re\n      done.\n    </p>\n    <p>\n      In the <code style=\"white-space: pre-wrap;\">App</code> class itself, we\n      add a <code style=\"white-space: pre-wrap;\">countyValue</code> method. It\n      takes a county entry and a map of tech salaries, and it returns the delta\n      between median household income and a single tech salary.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb66\"\n      data-caption=\"App.countyValue method\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb66-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb66-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">countyValue</span>(county<span class=\"op\" style=\"color: #666666;\">,</span> techSalariesMap) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb66-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> medianHousehold <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">medianIncomes</span>[<span class=\"va\" style=\"color: #19177c;\">county</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb66-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              salaries <span class=\"op\" style=\"color: #666666;\">=</span> techSalariesMap[<span class=\"va\" style=\"color: #19177c;\">county</span>.<span class=\"at\" style=\"color: #7d9029;\">name</span>]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb66-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb66-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"op\" style=\"color: #666666;\">!</span>medianHousehold <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"op\" style=\"color: #666666;\">!</span>salaries) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb66-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb66-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb66-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb66-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> median <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">median</span>(salaries<span class=\"op\" style=\"color: #666666;\">,</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">base_salary</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb66-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb66-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb66-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">countyID</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">county</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb66-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">value</span><span class=\"op\" style=\"color: #666666;\">:</span> median <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">medianHousehold</span>.<span class=\"at\" style=\"color: #7d9029;\">medianIncome</span></a>\n<a class=\"sourceLine\" id=\"cb66-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb66-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We use\n      <code style=\"white-space: pre-wrap;\">this.state.medianIncomes</code> to\n      get the median household salary and the\n      <code style=\"white-space: pre-wrap;\">techSalariesMap</code> input to get\n      salaries for a specific census area. Then we use\n      <code style=\"white-space: pre-wrap;\">d3.median</code> to calculate the\n      median value for salaries and return a two-element dictionary with the\n      result.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">countyID</code> specifies the county\n      and <code style=\"white-space: pre-wrap;\">value</code> is the delta that\n      our choropleth displays.\n    </p>\n    <p>\n      In the <code style=\"white-space: pre-wrap;\">render</code> method, we’ll:\n    </p>\n    <ul>\n      <li>prep a list of county values</li>\n      <li>remove the “data loaded” indicator</li>\n      <li>render the map</li>\n    </ul>\n    <div\n      class=\"sourceCode\"\n      id=\"cb67\"\n      data-caption=\"Render the CountyMap component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb67-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb67-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb67-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb67-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> countyNames<span class=\"op\" style=\"color: #666666;\">,</span> usTopoJson<span class=\"op\" style=\"color: #666666;\">,</span> techSalaries<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb67-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb67-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb67-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"va\" style=\"color: #19177c;\">techSalaries</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb67-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb67-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>Preloader /<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb67-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb67-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb67-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb67-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb67-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> filteredSalaries <span class=\"op\" style=\"color: #666666;\">=</span> techSalaries<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb67-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          filteredSalariesMap <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">groupBy</span>(filteredSalaries<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;countyID&#39;</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb67-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          countyValues <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">countyNames</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(</a>\n<a class=\"sourceLine\" id=\"cb67-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              county <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">countyValue</span>(county<span class=\"op\" style=\"color: #666666;\">,</span> filteredSalariesMap)</a>\n<a class=\"sourceLine\" id=\"cb67-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          ).<span class=\"at\" style=\"color: #7d9029;\">filter</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">!</span><span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">isNull</span>(d))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb67-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb67-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> zoom <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb67-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb67-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb67-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb67-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App container&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb67-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Delete the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb67-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>h1<span class=\"op\" style=\"color: #666666;\">&gt;</span>Loaded <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">techSalaries</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span><span class=\"op\" style=\"color: #666666;\">}</span> salaries&lt;/h1<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb67-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb67-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb67-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;1100&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;500&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb67-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>CountyMap usTopoJson<span class=\"op\" style=\"color: #666666;\">={</span>usTopoJson<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb67-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                       USstateNames<span class=\"op\" style=\"color: #666666;\">={</span>USstateNames<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb67-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                       values<span class=\"op\" style=\"color: #666666;\">={</span>countyValues<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb67-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                       x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb67-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                       y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb67-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                       width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">500</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb67-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                       height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">500</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb67-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                       zoom<span class=\"op\" style=\"color: #666666;\">={</span>zoom<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb67-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb67-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb67-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb67-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb67-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We call our dataset\n      <code style=\"white-space: pre-wrap;\">filteredTechSalaries</code> because\n      we’re going to add filtering in the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6888938#user-controls\"\n        >subchapter about adding user controls</a\n      >. Using the proper name now means less code to change later. The magic\n      of foresight 😄\n    </p>\n    <p>\n      We use <code style=\"white-space: pre-wrap;\">_.groupBy</code> to build a\n      dictionary mapping each\n      <code style=\"white-space: pre-wrap;\">countyID</code> to an array of\n      salaries, and we use our\n      <code style=\"white-space: pre-wrap;\">countyValue</code> method to build\n      an array of counties for our map.\n    </p>\n    <p>\n      We set <code style=\"white-space: pre-wrap;\">zoom</code> to\n      <code style=\"white-space: pre-wrap;\">null</code> for now. We’ll use this\n      later.\n    </p>\n    <p>\n      In the <code style=\"white-space: pre-wrap;\">return</code> statement, we\n      remove our “data loaded” indicator, and add an\n      <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code> element that’s\n      <code style=\"white-space: pre-wrap;\">1100</code> pixels wide and\n      <code style=\"white-space: pre-wrap;\">500</code> pixels high. Inside, we\n      place the <code style=\"white-space: pre-wrap;\">CountyMap</code> component\n      with a bunch of properties. Some dataset stuff, some sizing and\n      positioning stuff.\n    </p>"
        },
        {
          "lectureTitle": "Step 2: CountyMap index.js",
          "lectureBody": "    <h2 id=\"step-2-countymapindex.js\">Step 2: CountyMap/index.js</h2>\n    <p>\n      We make <code style=\"white-space: pre-wrap;\">index.js</code> for just\n      reason: to make imports and debugging easier. I learned this lesson the\n      hard way so you don’t have to.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb68\"\n      data-caption=\"CountyMap index.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb68-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/CountyMap/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb68-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb68-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"im\">default</span> <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./CountyMap&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Re-export the default import from\n      <code style=\"white-space: pre-wrap;\">./CountyMap.js</code>. That’s it.\n    </p>\n    <p>\n      This allows us to import\n      <code style=\"white-space: pre-wrap;\">CountyMap</code> from the directory\n      without knowing about internal file structure. We <em>could</em> put all\n      the code in this\n      <code style=\"white-space: pre-wrap;\">index.js</code> file, but that makes\n      debugging harder. You’ll have plenty of index.js files in your project.\n    </p>\n    <p>\n      Having a lot of code in\n      <code style=\"white-space: pre-wrap;\">&lt;directory&gt;/index.js</code> is\n      a common pattern in new projects. But when you’re looking at a stack\n      trace, source files in the browser, or filenames in your editor, you’ll\n      wish every component lived in a file of the same name.\n    </p>"
        },
        {
          "lectureTitle": "Step 3: CountyMap CountyMap.js",
          "lectureBody": "    <h2 id=\"step-3-countymapcountymap.js\">Step 3: CountyMap/CountyMap.js</h2>\n    <p>\n      Here comes the fun part - declaratively drawing a map. You’ll see why I\n      love using React for dataviz.\n    </p>\n    <p>\n      We’re using the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887740#full-feature-integration\"\n        >full-feature integration</a\n      >\n      approach and a lot of D3 maps magic. Drawing a map with D3 I’m always\n      surprised how little code it takes.\n    </p>\n    <p>\n      Start with the imports: React, D3, lodash, topojson, County component.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb69\"\n      data-caption=\"Import CountyMap dependencies\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb69-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/CountyMap/CountyMap.js</span></a>\n<a class=\"sourceLine\" id=\"cb69-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> Component <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb69-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;d3&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb69-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> topojson <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;topojson&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb69-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> _ <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;lodash&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb69-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb69-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> County <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./County&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Out of these, we haven’t built\n      <code style=\"white-space: pre-wrap;\">County</code> yet, and you haven’t\n      seen <code style=\"white-space: pre-wrap;\">topojson</code> before.\n    </p>\n    <p>\n      TopoJSON is a geographical data format based on JSON. We’re using the\n      <code style=\"white-space: pre-wrap;\">topojson</code> library to translate\n      our geographical datasets into GeoJSON, which is another way of defining\n      geo data with JSON.\n    </p>\n    <p>\n      I don’t know why there are two, but TopoJSON produces smaller files, and\n      GeoJSON can be fed directly into D3’s geo functions. ¯\\<em>(ツ)</em>/¯\n    </p>\n    <p>\n      Maybe it’s a case of\n      <a href=\"https://xkcd.com/927/\">competing standards</a>.\n    </p>\n    <h3 id=\"constructor\">Constructor</h3>\n    <p>\n      We stub out the\n      <code style=\"white-space: pre-wrap;\">CountyMap</code> component then fill\n      it in with logic.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb70\"\n      data-caption=\"CountyMap stub\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb70-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/CountyMap/CountyMap.js</span></a>\n<a class=\"sourceLine\" id=\"cb70-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> CountyMap <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb70-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">constructor</span>(props) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb70-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">super</span>(props)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb70-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb70-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb70-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb70-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb70-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb70-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">static</span> <span class=\"at\" style=\"color: #7d9029;\">getDerivedStateFromProps</span>(props<span class=\"op\" style=\"color: #666666;\">,</span> state) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb70-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb70-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb70-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb70-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb70-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> usTopoJson <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb70-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb70-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"op\" style=\"color: #666666;\">!</span>usTopoJson) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb70-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb70-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span><span class=\"cf\" style=\"color: #007020; font-weight: bold;\">else</span><span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb70-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb70-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb70-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb70-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb70-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb70-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb70-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb70-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> CountyMap<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We’ll set up default D3 state in\n      <code style=\"white-space: pre-wrap;\">constructor</code> and keep it up to\n      date with\n      <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code>.\n    </p>\n    <p>\n      We need three D3 objects to build a choropleth map: a geographical\n      projection, a path generator, and a quantize scale for colors.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb71\"\n      data-caption=\"D3 objects for a map\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb71-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/CountyMap/CountyMap.js</span></a>\n<a class=\"sourceLine\" id=\"cb71-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> CountyMap <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb71-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">constructor</span>(props) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb71-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">super</span>(props)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb71-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb71-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> projection <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">geoAlbersUsa</span>().<span class=\"at\" style=\"color: #7d9029;\">scale</span>(<span class=\"dv\" style=\"color: #40a070;\">1280</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb71-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb71-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb71-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">geoPath</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">geoPath</span>().<span class=\"at\" style=\"color: #7d9029;\">projection</span>(projection)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb71-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">quantize</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleQuantize</span>().<span class=\"at\" style=\"color: #7d9029;\">range</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">range</span>(<span class=\"dv\" style=\"color: #40a070;\">9</span>))<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb71-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            projection</a>\n<a class=\"sourceLine\" id=\"cb71-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb71-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      You might remember geographical projections from high school. They map a\n      sphere to a flat surface. We use\n      <code style=\"white-space: pre-wrap;\">geoAlbersUsa</code> because it’s\n      made specifically for maps of the USA.\n    </p>\n    <p>\n      D3 offers many other projections. You can see them on\n      <a href=\"https://github.com/d3/d3-geo#projections\"\n        >d3-geo’s Github page</a\n      >.\n    </p>\n    <p>\n      A <code style=\"white-space: pre-wrap;\">geoPath</code> generator takes a\n      projection and returns a function that generates the\n      <code style=\"white-space: pre-wrap;\">d</code> attribute of\n      <code style=\"white-space: pre-wrap;\">&lt;path&gt;</code> elements. This\n      is the most general way to specify SVG shapes. I won’t go into explaining\n      the <code style=\"white-space: pre-wrap;\">d</code> here, but it’s\n      <a href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d\"\n        >an entire language</a\n      >\n      for describing shapes.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">quantize</code> is a D3 scale. We’ve\n      talked about the basics of scales in the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887732#blackbox-axis\"\n        >D3 Axis example</a\n      >. This one splits a domain into 9 quantiles and assigns them specific\n      values from the <code style=\"white-space: pre-wrap;\">range</code>.\n    </p>\n    <p>\n      Let’s say our domain goes from 0 to 90. Calling the scale with any number\n      between 0 and 9 would return 1. 10 to 19 returns 2 and so on. We’ll use\n      it to pick colors from an array.\n    </p>\n    <h3 id=\"getderivedstatefromprops\">getDerivedStateFromProps</h3>\n    <p>\n      Keeping our geo path and quantize scale up to date is simple, but we’ll\n      make it harder by adding a zoom feature. It won’t work until we build the\n      filtering, but hey, we’ll already have it by then! 😄\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb72\"\n      data-caption=\"CountyMap getDerivedStateFromProps\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb72-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/CountyMap/CountyMap.js</span></a>\n<a class=\"sourceLine\" id=\"cb72-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">static</span> <span class=\"at\" style=\"color: #7d9029;\">getDerivedStateFromProps</span>(props<span class=\"op\" style=\"color: #666666;\">,</span> state) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb72-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> <span class=\"op\" style=\"color: #666666;\">{</span> projection<span class=\"op\" style=\"color: #666666;\">,</span> quantize<span class=\"op\" style=\"color: #666666;\">,</span> geoPath <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> state<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb72-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb72-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        projection</a>\n<a class=\"sourceLine\" id=\"cb72-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">translate</span>([<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span> / <span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span> / <span class=\"dv\" style=\"color: #40a070;\">2</span>])</a>\n<a class=\"sourceLine\" id=\"cb72-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">scale</span>(<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"fl\" style=\"color: #40a070;\">1.3</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb72-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb72-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">zoom</span> <span class=\"op\" style=\"color: #666666;\">&amp;&amp;</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">usTopoJson</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb72-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> us <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">usTopoJson</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb72-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                USstatePaths <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">topojson</span>.<span class=\"at\" style=\"color: #7d9029;\">feature</span>(us<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">us</span>.<span class=\"va\" style=\"color: #19177c;\">objects</span>.<span class=\"at\" style=\"color: #7d9029;\">states</span>).<span class=\"at\" style=\"color: #7d9029;\">features</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb72-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                id <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">find</span>(<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">USstateNames</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">code</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">zoom</span> <span class=\"op\" style=\"color: #666666;\">}</span>).<span class=\"at\" style=\"color: #7d9029;\">id</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb72-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb72-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">projection</span>.<span class=\"at\" style=\"color: #7d9029;\">scale</span>(<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"fl\" style=\"color: #40a070;\">4.5</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb72-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb72-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> centroid <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">geoPath</span>.<span class=\"at\" style=\"color: #7d9029;\">centroid</span>(<span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">find</span>(USstatePaths<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">id</span><span class=\"op\" style=\"color: #666666;\">:</span> id <span class=\"op\" style=\"color: #666666;\">}</span>))<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb72-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                translate <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">projection</span>.<span class=\"at\" style=\"color: #7d9029;\">translate</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb72-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb72-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">projection</span>.<span class=\"at\" style=\"color: #7d9029;\">translate</span>([</a>\n<a class=\"sourceLine\" id=\"cb72-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                translate[<span class=\"dv\" style=\"color: #40a070;\">0</span>] <span class=\"op\" style=\"color: #666666;\">-</span> centroid[<span class=\"dv\" style=\"color: #40a070;\">0</span>] <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span> / <span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb72-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                translate[<span class=\"dv\" style=\"color: #40a070;\">1</span>] <span class=\"op\" style=\"color: #666666;\">-</span> centroid[<span class=\"dv\" style=\"color: #40a070;\">1</span>] <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span> / <span class=\"dv\" style=\"color: #40a070;\">2</span></a>\n<a class=\"sourceLine\" id=\"cb72-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            ])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb72-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb72-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb72-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">values</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb72-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">quantize</span>.<span class=\"at\" style=\"color: #7d9029;\">domain</span>([</a>\n<a class=\"sourceLine\" id=\"cb72-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">quantile</span>(<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">values</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"fl\" style=\"color: #40a070;\">0.15</span><span class=\"op\" style=\"color: #666666;\">,</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb72-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">quantile</span>(<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">values</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"fl\" style=\"color: #40a070;\">0.85</span><span class=\"op\" style=\"color: #666666;\">,</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span>)</a>\n<a class=\"sourceLine\" id=\"cb72-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            ])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb72-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb72-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb72-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb72-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            ...<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb72-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            projection<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb72-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            quantize</a>\n<a class=\"sourceLine\" id=\"cb72-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb72-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>There’s a lot going on here.</p>\n    <p>\n      We destructure <code style=\"white-space: pre-wrap;\">projection</code>,\n      <code style=\"white-space: pre-wrap;\">quantize</code>, and\n      <code style=\"white-space: pre-wrap;\">geoPath</code> out of component\n      state. These are the D3 object we’re about to update.\n    </p>\n    <p>\n      First up is the projection. We translate (move) it to the center of our\n      drawing area and set the scale property. You have to play around with\n      this value until you get a nice result because it’s different for every\n      projection.\n    </p>\n    <p>\n      Then we do some weird stuff if\n      <code style=\"white-space: pre-wrap;\">zoom</code> is defined.\n    </p>\n    <p>\n      We get the list of all US state features in our geo data, find the one\n      we’re <code style=\"white-space: pre-wrap;\">zoom</code>-ing on, and use\n      the <code style=\"white-space: pre-wrap;\">geoPath.centroid</code> method\n      to calculate its center point. This gives us a new coordinate to\n      <code style=\"white-space: pre-wrap;\">translate</code> our projection\n      onto.\n    </p>\n    <p>\n      The calculation in\n      <code style=\"white-space: pre-wrap;\">.translate()</code> helps us align\n      the center point of our\n      <code style=\"white-space: pre-wrap;\">zoom</code> US state with the center\n      of the drawing area.\n    </p>\n    <p>\n      While all of this is going on, we also tweak the\n      <code style=\"white-space: pre-wrap;\">.scale</code> property to make the\n      map bigger. This creates a zooming effect.\n    </p>\n    <p>\n      After all that, we update the quantize scale’s domain with new values.\n      Using <code style=\"white-space: pre-wrap;\">d3.quantile</code> lets us\n      offset the scale to produce a more interesting map. Again, I discovered\n      these values through experiment - they cut off the top and bottom of the\n      range because there isn’t much there. This brings higher contrast to the\n      richer middle of the range.\n    </p>\n    <p>\n      With our D3 objects updated, we return a new derived state.\n      <em>Technically</em> you don’t have to do this but you should. Due to how\n      JavaScript works, you already updated D3 objects in place, but you should\n      pretend <code style=\"white-space: pre-wrap;\">this.state</code> is\n      immutable and return a new copy.\n    </p>\n    <p>\n      Overall that makes your code easier to understand and closer to React\n      principles.\n    </p>\n    <h3 id=\"render\">render</h3>\n    <p>\n      After all that hard work, the\n      <code style=\"white-space: pre-wrap;\">render</code> method is a breeze. We\n      prep our data then loop through it and render a\n      <code style=\"white-space: pre-wrap;\">County</code> element for each\n      entry.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb73\"\n      data-caption=\"CountyMap render\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb73-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb73-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> geoPath<span class=\"op\" style=\"color: #666666;\">,</span> quantize <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb73-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span> usTopoJson<span class=\"op\" style=\"color: #666666;\">,</span> values<span class=\"op\" style=\"color: #666666;\">,</span> zoom <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb73-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb73-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"op\" style=\"color: #666666;\">!</span>usTopoJson) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb73-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb73-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">else</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb73-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> us <span class=\"op\" style=\"color: #666666;\">=</span> usTopoJson<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb73-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                USstatesMesh <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">topojson</span>.<span class=\"at\" style=\"color: #7d9029;\">mesh</span>(</a>\n<a class=\"sourceLine\" id=\"cb73-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    us<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb73-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"va\" style=\"color: #19177c;\">us</span>.<span class=\"va\" style=\"color: #19177c;\">objects</span>.<span class=\"at\" style=\"color: #7d9029;\">states</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb73-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    (a<span class=\"op\" style=\"color: #666666;\">,</span> b) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> a <span class=\"op\" style=\"color: #666666;\">!==</span> b</a>\n<a class=\"sourceLine\" id=\"cb73-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                )<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb73-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                counties <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">topojson</span>.<span class=\"at\" style=\"color: #7d9029;\">feature</span>(us<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">us</span>.<span class=\"va\" style=\"color: #19177c;\">objects</span>.<span class=\"at\" style=\"color: #7d9029;\">counties</span>).<span class=\"at\" style=\"color: #7d9029;\">features</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb73-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb73-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> countyValueMap <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">fromPairs</span>(</a>\n<a class=\"sourceLine\" id=\"cb73-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"va\" style=\"color: #19177c;\">values</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> [<span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">countyID</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span>])</a>\n<a class=\"sourceLine\" id=\"cb73-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb73-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb73-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb73-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb73-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">counties</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(feature <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb73-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"op\" style=\"color: #666666;\">&lt;</span>County</a>\n<a class=\"sourceLine\" id=\"cb73-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            geoPath<span class=\"op\" style=\"color: #666666;\">={</span>geoPath<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb73-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            feature<span class=\"op\" style=\"color: #666666;\">={</span>feature<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb73-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            zoom<span class=\"op\" style=\"color: #666666;\">={</span>zoom<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb73-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            key<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"va\" style=\"color: #19177c;\">feature</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb73-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            quantize<span class=\"op\" style=\"color: #666666;\">={</span>quantize<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb73-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            value<span class=\"op\" style=\"color: #666666;\">={</span>countyValueMap[<span class=\"va\" style=\"color: #19177c;\">feature</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span>]<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb73-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        /&gt;</a>\n<a class=\"sourceLine\" id=\"cb73-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    ))<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb73-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb73-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">&lt;</span>path</a>\n<a class=\"sourceLine\" id=\"cb73-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        d<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"at\" style=\"color: #7d9029;\">geoPath</span>(USstatesMesh)<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb73-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        style<span class=\"op\" style=\"color: #666666;\">={{</span></a>\n<a class=\"sourceLine\" id=\"cb73-36\" title=\"36\">                            <span class=\"dt\">fill</span><span class=\"op\">:</span> <span class=\"st\">&quot;none&quot;</span><span class=\"op\">,</span></a>\n<a class=\"sourceLine\" id=\"cb73-37\" title=\"37\">                            <span class=\"dt\">stroke</span><span class=\"op\">:</span> <span class=\"st\">&quot;#fff&quot;</span><span class=\"op\">,</span></a>\n<a class=\"sourceLine\" id=\"cb73-38\" title=\"38\">                            <span class=\"dt\">strokeLinejoin</span><span class=\"op\">:</span> <span class=\"st\">&quot;round&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb73-39\" title=\"39\">                        <span class=\"op\">}}</span></a>\n<a class=\"sourceLine\" id=\"cb73-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    /&gt;</a>\n<a class=\"sourceLine\" id=\"cb73-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb73-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb73-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb73-44\" title=\"44\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We use destructuring to save all relevant props and state in constants,\n      then use the TopoJSON library to grab data out of the\n      <code style=\"white-space: pre-wrap;\">usTopoJson</code> dataset.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">.mesh</code> calculates a mesh for\n      US states – a thin line around the edges.\n      <code style=\"white-space: pre-wrap;\">.feature</code> calculates feature\n      for each count – fill in with color.\n    </p>\n    <p>\n      Mesh and feature aren’t tied to US states or counties by the way. It’s\n      just a matter of what you get back: borders or flat areas. What you need\n      depends on what you’re building.\n    </p>\n    <p>\n      We use Lodash’s\n      <code style=\"white-space: pre-wrap;\">_.fromPairs</code> to build a\n      dictionary that maps county identifiers to their values. Building it\n      beforehand makes our code faster. You can read some details about the\n      speed optimizations\n      <a\n        href=\"https://swizec.com/blog/optimizing-react-choropleth-map-rendering/swizec/7302\"\n        >here</a\n      >.\n    </p>\n    <p>\n      As promised, the\n      <code style=\"white-space: pre-wrap;\">return</code> statement loops\n      through the list of\n      <code style=\"white-space: pre-wrap;\">counties</code> and renders\n      <code style=\"white-space: pre-wrap;\">County</code> components. Each gets\n      a bunch of attributes and returns a\n      <code style=\"white-space: pre-wrap;\">&lt;path&gt;</code> element that\n      looks like a specific county.\n    </p>\n    <p>\n      For US state borders, we render a single\n      <code style=\"white-space: pre-wrap;\">&lt;path&gt;</code> element and use\n      <code style=\"white-space: pre-wrap;\">geoPath</code> to generate the\n      <code style=\"white-space: pre-wrap;\">d</code> attribute.\n    </p>"
        },
        {
          "lectureTitle": "Step 4: CountyMap County.js",
          "lectureBody": "    <h2 id=\"step-4-countymapcounty.js\">Step 4: CountyMap/County.js</h2>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">County</code> component is built\n      from two parts: imports and color constants, and a component that returns\n      a <code style=\"white-space: pre-wrap;\">&lt;path&gt;</code>. All the hard\n      calculation happens in\n      <code style=\"white-space: pre-wrap;\">CountyMap</code>.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb74\"\n      data-caption=\"Imports and color constants\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb74-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/CountyMap/County.js</span></a>\n<a class=\"sourceLine\" id=\"cb74-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> Component <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb74-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> _ <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;lodash&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb74-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb74-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> ChoroplethColors <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">reverse</span>([</a>\n<a class=\"sourceLine\" id=\"cb74-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"st\" style=\"color: #4070a0;\">&#39;rgb(247,251,255)&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb74-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"st\" style=\"color: #4070a0;\">&#39;rgb(222,235,247)&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb74-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"st\" style=\"color: #4070a0;\">&#39;rgb(198,219,239)&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb74-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"st\" style=\"color: #4070a0;\">&#39;rgb(158,202,225)&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb74-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"st\" style=\"color: #4070a0;\">&#39;rgb(107,174,214)&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb74-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"st\" style=\"color: #4070a0;\">&#39;rgb(66,146,198)&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb74-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"st\" style=\"color: #4070a0;\">&#39;rgb(33,113,181)&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb74-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"st\" style=\"color: #4070a0;\">&#39;rgb(8,81,156)&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb74-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"st\" style=\"color: #4070a0;\">&#39;rgb(8,48,107)&#39;</span></a>\n<a class=\"sourceLine\" id=\"cb74-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb74-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb74-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> BlankColor <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;rgb(240,240,240)&#39;</span></a></code></pre>\n    </div>\n    <p>\n      We import React and Lodash, and define some color constants. I got the\n      <code style=\"white-space: pre-wrap;\">ChoroplethColors</code> from some\n      example online, and\n      <code style=\"white-space: pre-wrap;\">BlankColor</code> is a pleasant\n      gray.\n    </p>\n    <p>\n      Now we need the\n      <code style=\"white-space: pre-wrap;\">County</code> component.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb75\"\n      data-caption=\"County component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb75-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/CountyMap/County.js</span></a>\n<a class=\"sourceLine\" id=\"cb75-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> County <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb75-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">shouldComponentUpdate</span>(nextProps<span class=\"op\" style=\"color: #666666;\">,</span> nextState) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb75-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> zoom<span class=\"op\" style=\"color: #666666;\">,</span> value <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb75-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb75-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> zoom <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"va\" style=\"color: #19177c;\">nextProps</span>.<span class=\"at\" style=\"color: #7d9029;\">zoom</span></a>\n<a class=\"sourceLine\" id=\"cb75-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">||</span> value <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"va\" style=\"color: #19177c;\">nextProps</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb75-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb75-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb75-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb75-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> value<span class=\"op\" style=\"color: #666666;\">,</span> geoPath<span class=\"op\" style=\"color: #666666;\">,</span> feature<span class=\"op\" style=\"color: #666666;\">,</span> quantize <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb75-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb75-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> color <span class=\"op\" style=\"color: #666666;\">=</span> BlankColor<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb75-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb75-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (value) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb75-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            color <span class=\"op\" style=\"color: #666666;\">=</span> ChoroplethColors[<span class=\"at\" style=\"color: #7d9029;\">quantize</span>(value)]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb75-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb75-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb75-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb75-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>path d<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"at\" style=\"color: #7d9029;\">geoPath</span>(feature)<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb75-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                  style<span class=\"op\" style=\"color: #666666;\">={{</span><span class=\"dt\">fill</span><span class=\"op\">:</span> color<span class=\"op\">}}</span></a>\n<a class=\"sourceLine\" id=\"cb75-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                  title<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"va\" style=\"color: #19177c;\">feature</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb75-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb75-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb75-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb75-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb75-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> County<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">render</code> method uses a\n      <code style=\"white-space: pre-wrap;\">quantize</code> scale to pick the\n      right color and returns a\n      <code style=\"white-space: pre-wrap;\">&lt;path&gt;</code> element.\n      <code style=\"white-space: pre-wrap;\">geoPath</code> generates the\n      <code style=\"white-space: pre-wrap;\">d</code> attribute, we set style to\n      <code style=\"white-space: pre-wrap;\">fill</code> the color, and we give\n      our path a <code style=\"white-space: pre-wrap;\">title</code>.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">shouldComponentUpdate</code> is more\n      interesting. It’s a React lifecycle method that lets you specify which\n      prop changes are relevant to component re-rendering.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">CountyMap</code> passes complex\n      props - <code style=\"white-space: pre-wrap;\">quantize</code>,\n      <code style=\"white-space: pre-wrap;\">geoPath</code>, and\n      <code style=\"white-space: pre-wrap;\">feature</code>. They’re\n      pass-by-reference instead of pass-by-value. That means React can’t see\n      when their output changes unless you make completely new copies.\n    </p>\n    <p>\n      This can lead to all 3,220 counties re-rendering every time a user does\n      anything. But they only have to re-render if we change the map zoom or if\n      the county gets a new value.\n    </p>\n    <p>\n      Using\n      <code style=\"white-space: pre-wrap;\">shouldComponentUpdate</code> like\n      this we can go from 3,220 DOM updates to a few hundred. Big speed\n      improvement\n    </p>"
        },
        {
          "lectureTitle": "A map appears 🗺",
          "lectureBody": "    <p>Your browser should now show a map.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/choropleth-map-shortened-dataset.png\"\n        alt=\"Choropleth map with shortened dataset\"\n      />\n      <figcaption>Choropleth map with shortened dataset</figcaption>\n    </figure>\n    <p>\n      Tech work visas just aren’t that evenly distributed. Even with the full\n      dataset most counties are gray.\n    </p>\n    <p>\n      If that didn’t work, consult\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/f4c1535e9c9ca4982c8f3c74cff9f739eb08c0f7\"\n        >this diff on Github</a\n      >.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Render a Histogram of salaries",
      "lectures": [
        {
          "lectureTitle": "Render a Histogram of salaries",
          "lectureBody": "    <h1 id=\"histogram-of-salaries\">Render a Histogram of salaries</h1>\n    <p>\n      Knowing median salaries is great and all, but it doesn’t tell you much\n      about what you can expect. You need to know the distribution to see if\n      it’s more likely you’ll get 140k or 70k.\n    </p>\n    <p>\n      That’s what histograms are for. Give them a bunch of data, and they show\n      its distribution. We’re going to build one like this:\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/basic-histogram.png\"\n        alt=\"Basic histogram\"\n      />\n      <figcaption>Basic histogram</figcaption>\n    </figure>\n    <p>\n      In the shortened dataset, 35% of tech salaries fall between $60k and\n      $80k, 26% between $80k and $100k etc. Throwing a weighed dice with this\n      <a href=\"https://en.wikipedia.org/wiki/Probability_distribution\"\n        >random distribution</a\n      >, you’re far more likely to get 60k-80k than 120k-140k. It’s a great way\n      to gauge situations.\n    </p>\n    <p>\n      It’s where statistics like “More people die from vending machines than\n      shark attacks” come from. Which are you afraid of, vending machines or\n      sharks? Stats say your answer should be\n      <a href=\"https://www.cdc.gov/nchs/fastats/deaths.htm\">heart disease</a>.\n      😉\n    </p>\n    <p>\n      We’ll start our histogram with some changes in\n      <code style=\"white-space: pre-wrap;\">App.js</code>, make a\n      <code style=\"white-space: pre-wrap;\">Histogram</code> component using the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887740#full-feature-integration\"\n        >full-feature approach</a\n      >, add an <code style=\"white-space: pre-wrap;\">Axis</code> using the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887729#blackbox-hoc\"\n        >blackbox HOC approach</a\n      >, and finally add some styling.\n    </p>"
        },
        {
          "lectureTitle": "Step 1: Prep App.js",
          "lectureBody": "    <h2 id=\"step-1-prep-app.js-2\">Step 1: Prep App.js</h2>\n    <p>\n      You know the drill, don’t you? Import some stuff, add it to the\n      <code style=\"white-space: pre-wrap;\">render()</code> method in the\n      <code style=\"white-space: pre-wrap;\">App</code> component.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb76\"\n      data-caption=\"Histogram imports\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb76-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb76-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> _ <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;lodash&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb76-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb76-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb76-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./style.css&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb76-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb76-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb76-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Preloader <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Preloader&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb76-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> loadAllData <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./DataHandling&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb76-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb76-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> CountyMap <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/CountyMap&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb76-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb76-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Histogram <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Histogram&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb76-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a></code></pre>\n    </div>\n    <p>\n      We import <code style=\"white-space: pre-wrap;\">style.css</code> and the\n      <code style=\"white-space: pre-wrap;\">Histogram</code> component. That’s\n      what I love about Webpack - you can import CSS in JavaScript. We got the\n      setup with <code style=\"white-space: pre-wrap;\">create-react-app</code>.\n    </p>\n    <p>\n      There are competing schools of thought about styling React apps. Some say\n      each component should come with its own CSS files, some think it should\n      be in large per-app CSS files, many think CSS-in-JS is the way to go.\n    </p>\n    <p>\n      Personally I like to use CSS for general cross-component styling and\n      styled-components for more specific styles. We’re using CSS in this\n      project because it works and means we don’t have to learn yet another\n      dependency.\n    </p>\n    <p>\n      After the imports, we can render our\n      <code style=\"white-space: pre-wrap;\">Histogram</code> in the\n      <code style=\"white-space: pre-wrap;\">App</code> component.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb77\"\n      data-caption=\"Render Histogram in App\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb77-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb77-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb77-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb77-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb77-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb77-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App container&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb77-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>h1<span class=\"op\" style=\"color: #666666;\">&gt;</span>Loaded <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"va\" style=\"color: #19177c;\">techSalaries</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span><span class=\"op\" style=\"color: #666666;\">}</span> salaries&lt;/h1<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb77-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;1100&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;500&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb77-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>CountyMap usTopoJson<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">usTopoJson</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           USstateNames<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">USstateNames</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           values<span class=\"op\" style=\"color: #666666;\">={</span>countyValues<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">500</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">500</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           zoom<span class=\"op\" style=\"color: #666666;\">={</span>zoom<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb77-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb77-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>Histogram bins<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">10</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">500</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">500</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           x<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;500&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb77-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           y<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;10&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb77-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           data<span class=\"op\" style=\"color: #666666;\">={</span>filteredSalaries<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           axisMargin<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">83</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           bottomMargin<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb77-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           value<span class=\"op\" style=\"color: #666666;\">={</span>d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">base_salary</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb77-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb77-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb77-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb77-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb77-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We render the\n      <code style=\"white-space: pre-wrap;\">Histogram</code> component with a\n      bunch of props. They specify the dimensions we want, positioning, and\n      pass data to the component. We’re using\n      <code style=\"white-space: pre-wrap;\">filteredSalaries</code> even though\n      we haven’t set up any filtering yet. One less line of code to change\n      later 👌\n    </p>\n    <p>\n      That’s it. <code style=\"white-space: pre-wrap;\">App</code> is ready to\n      render our <code style=\"white-space: pre-wrap;\">Histogram</code>.\n    </p>\n    <p>You should now see an error about missing files. That’s normal.</p>"
        },
        {
          "lectureTitle": "Step 2: CSS changes",
          "lectureBody": "    <h2 id=\"histogram-css\">Step 2: CSS changes</h2>\n    <p>\n      As mentioned, opinions vary on the best approach to styling React apps.\n      Some say stylesheets per component, some say styling inside JavaScript,\n      others swear by global app styling.\n    </p>\n    <p>\n      The truth is somewhere in between. Do what fits your project and your\n      team. We’re using global stylesheets because it’s the simplest.\n    </p>\n    <p>\n      Create a new file\n      <code style=\"white-space: pre-wrap;\">src/style.css</code> and add these\n      29 lines:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb78\"\n      data-caption=\"style.css stylesheet\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode css\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode css\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb78-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"fu\" style=\"color: #06287e;\">.histogram</span> <span class=\"fu\" style=\"color: #06287e;\">.bar</span> rect {</a>\n<a class=\"sourceLine\" id=\"cb78-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">fill</span>: <span class=\"cn\" style=\"color: #880000;\">steelblue</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    shape-rendering: crispEdges<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">}</a>\n<a class=\"sourceLine\" id=\"cb78-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb78-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"fu\" style=\"color: #06287e;\">.histogram</span> <span class=\"fu\" style=\"color: #06287e;\">.bar</span> text {</a>\n<a class=\"sourceLine\" id=\"cb78-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">fill</span>: <span class=\"cn\" style=\"color: #880000;\">#fff</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">font</span>: <span class=\"dv\" style=\"color: #40a070;\">12</span><span class=\"dt\" style=\"color: #902000;\">px</span> <span class=\"dv\" style=\"color: #40a070;\">sans-serif</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">}</a>\n<a class=\"sourceLine\" id=\"cb78-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb78-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">button {</a>\n<a class=\"sourceLine\" id=\"cb78-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">margin-right</span>: <span class=\"dv\" style=\"color: #40a070;\">.5</span><span class=\"dt\" style=\"color: #902000;\">em</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">margin-bottom</span>: <span class=\"dv\" style=\"color: #40a070;\">.3</span><span class=\"dt\" style=\"color: #902000;\">em</span> <span class=\"at\" style=\"color: #7d9029;\">!important</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">}</a>\n<a class=\"sourceLine\" id=\"cb78-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb78-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"fu\" style=\"color: #06287e;\">.row</span> {</a>\n<a class=\"sourceLine\" id=\"cb78-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">margin-top</span>: <span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"dt\" style=\"color: #902000;\">em</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">}</a>\n<a class=\"sourceLine\" id=\"cb78-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb78-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"fu\" style=\"color: #06287e;\">.mean</span> text {</a>\n<a class=\"sourceLine\" id=\"cb78-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">font</span>: <span class=\"dv\" style=\"color: #40a070;\">11</span><span class=\"dt\" style=\"color: #902000;\">px</span> <span class=\"dv\" style=\"color: #40a070;\">sans-serif</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">fill</span>: <span class=\"cn\" style=\"color: #880000;\">grey</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">}</a>\n<a class=\"sourceLine\" id=\"cb78-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb78-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"fu\" style=\"color: #06287e;\">.mean</span> path {</a>\n<a class=\"sourceLine\" id=\"cb78-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    stroke-dasharray: <span class=\"dv\" style=\"color: #40a070;\">3</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    stroke: <span class=\"cn\" style=\"color: #880000;\">grey</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    stroke-width: <span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"dt\" style=\"color: #902000;\">px</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb78-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">}</a></code></pre>\n    </div>\n    <p>\n      We won’t go into details about the CSS here. Many better books have been\n      written about it.\n    </p>\n    <p>In broad strokes:</p>\n    <ul>\n      <li>\n        we’re making\n        <code style=\"white-space: pre-wrap;\">.histogram</code> rectangles – the\n        bars – blue\n      </li>\n      <li>\n        labels white <code style=\"white-space: pre-wrap;\">12px</code> font\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">button</code>s and\n        <code style=\"white-space: pre-wrap;\">.row</code>s have some spacing\n      </li>\n      <li>\n        the <code style=\"white-space: pre-wrap;\">.mean</code> line is a dotted\n        grey with gray <code style=\"white-space: pre-wrap;\">11px</code> text.\n      </li>\n    </ul>\n    <p>\n      More CSS than we need for just the histogram, but we’re already here so\n      might as well write it now.\n    </p>\n    <p>\n      Adding our CSS before building the Histogram means it’s going to look\n      beautiful the first time around.\n    </p>"
        },
        {
          "lectureTitle": "Step 3: Histogram component",
          "lectureBody": "    <h2 id=\"step-3-histogram-component\">Step 3: Histogram component</h2>\n    <p>\n      We’re following the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887740#full-feature-integration\"\n        >full-feature integration</a\n      >\n      approach for our Histogram component. React talks to the DOM, D3\n      calculates the props.\n    </p>\n    <p>We’ll use two components:</p>\n    <ol type=\"1\">\n      <li>\n        <code style=\"white-space: pre-wrap;\">Histogram</code> makes the general\n        layout, dealing with D3, and translating raw data into a histogram\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">HistogramBar</code> draws a single\n        bar and labels it\n      </li>\n    </ol>\n    <p>\n      Let’s start with the basics: a\n      <code style=\"white-space: pre-wrap;\">Histogram</code> directory and an\n      <code style=\"white-space: pre-wrap;\">index.js</code> file. Keeps our code\n      organized and imports easy. I like to use directories for components made\n      of multiple files.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb79\"\n      data-caption=\"Re-export Histogram\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb79-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"im\">default</span> <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;./Histogram&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Import and re-export the histogram componenet from\n      <code style=\"white-space: pre-wrap;\">./Histogram</code>. This way you can\n      keep your histogram code in a file called Histogram and pretend the\n      directory itself is exporting it.\n    </p>\n    <p>\n      Great way to group files that belong together without exposing your\n      directory’s internal structure.\n    </p>\n    <p>\n      Now we need the\n      <code style=\"white-space: pre-wrap;\">Histogram.js</code> file. Start with\n      some imports, a default export, and a stubbed out\n      <code style=\"white-space: pre-wrap;\">Histogram</code> class.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb80\"\n      data-caption=\"Histogram component stub\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb80-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Histogram/Histogram.js</span></a>\n<a class=\"sourceLine\" id=\"cb80-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb80-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb80-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb80-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Histogram <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb80-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb80-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">histogram</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">histogram</span>()<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb80-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">widthScale</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb80-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">yScale</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb80-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb80-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb80-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">static</span> <span class=\"at\" style=\"color: #7d9029;\">getDerivedStateFromProps</span>(props<span class=\"op\" style=\"color: #666666;\">,</span> state) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb80-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> <span class=\"op\" style=\"color: #666666;\">{</span> histogram<span class=\"op\" style=\"color: #666666;\">,</span> widthScale<span class=\"op\" style=\"color: #666666;\">,</span> yScale <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> state<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb80-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb80-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb80-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            ...<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb80-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            histogram<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb80-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            widthScale<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb80-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            yScale</a>\n<a class=\"sourceLine\" id=\"cb80-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb80-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb80-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb80-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    makeBar <span class=\"op\" style=\"color: #666666;\">=</span> bar <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb80-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> yScale<span class=\"op\" style=\"color: #666666;\">,</span> widthScale <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb80-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb80-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb80-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb80-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb80-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> histogram<span class=\"op\" style=\"color: #666666;\">,</span> yScale <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb80-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> data<span class=\"op\" style=\"color: #666666;\">,</span> axisMargin <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb80-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb80-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb80-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb80-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We import React and D3, and set up\n      <code style=\"white-space: pre-wrap;\">Histogram</code>.\n    </p>\n    <p>\n      Default <code style=\"white-space: pre-wrap;\">state</code> for our D3\n      objects: histogram, widthScale, and yScale. An empty\n      <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code> to\n      keep them updated, <code style=\"white-space: pre-wrap;\">makeBar</code> to\n      help us render each bar, and\n      <code style=\"white-space: pre-wrap;\">render</code> returning null for\n      now.\n    </p>\n    <h3 id=\"getderivedstatefromprops-1\">getDerivedStateFromProps</h3>\n    <div\n      class=\"sourceCode\"\n      id=\"cb81\"\n      data-caption=\"getDerivedStateFromProps in Histogram\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb81-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Histogram/Histogram.js</span></a>\n<a class=\"sourceLine\" id=\"cb81-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">static</span> <span class=\"at\" style=\"color: #7d9029;\">getDerivedStateFromProps</span>(props<span class=\"op\" style=\"color: #666666;\">,</span> state) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb81-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> <span class=\"op\" style=\"color: #666666;\">{</span> histogram<span class=\"op\" style=\"color: #666666;\">,</span> widthScale<span class=\"op\" style=\"color: #666666;\">,</span> yScale <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> state<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb81-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb81-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">histogram</span>.<span class=\"at\" style=\"color: #7d9029;\">thresholds</span>(<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">bins</span>).<span class=\"at\" style=\"color: #7d9029;\">value</span>(<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb81-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb81-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> bars <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">histogram</span>(<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">data</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb81-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            counts <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">bars</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb81-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb81-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        widthScale</a>\n<a class=\"sourceLine\" id=\"cb81-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">min</span>(counts)<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">max</span>(counts)])</a>\n<a class=\"sourceLine\" id=\"cb81-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">axisMargin</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb81-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb81-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        yScale</a>\n<a class=\"sourceLine\" id=\"cb81-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">max</span>(bars<span class=\"op\" style=\"color: #666666;\">,</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">x1</span>)])</a>\n<a class=\"sourceLine\" id=\"cb81-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span> <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">bottomMargin</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb81-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb81-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb81-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            ...<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb81-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            histogram<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb81-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            widthScale<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb81-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            yScale</a>\n<a class=\"sourceLine\" id=\"cb81-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb81-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      First, we configure the\n      <code style=\"white-space: pre-wrap;\">histogram</code> generator.\n      <code style=\"white-space: pre-wrap;\">thresholds</code> specify how many\n      bins we want and\n      <code style=\"white-space: pre-wrap;\">value</code> specifies the value\n      accessor function. We get both from props passed into the\n      <code style=\"white-space: pre-wrap;\">Histogram</code> component.\n    </p>\n    <p>\n      In our case that makes 20 bins, and the value accessor returns each data\n      point’s <code style=\"white-space: pre-wrap;\">base_salary</code>.\n    </p>\n    <p>\n      We feed the data prop into our histogram generator, and count how many\n      values are in each bin with a\n      <code style=\"white-space: pre-wrap;\">.map</code> call. We need those to\n      configure our scales.\n    </p>\n    <p>\n      If you print the result of\n      <code style=\"white-space: pre-wrap;\">histogram()</code>, you’ll see an\n      array structure where each entry holds metadata about the bin and the\n      values it contains.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/histogram-data-screenshot.png\"\n        alt=\"console.log(this.histogram())\"\n      />\n      <figcaption>console.log(this.histogram())</figcaption>\n    </figure>\n    <p>Let’s use this info to set up our scales.</p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">widthScale</code> has a range from\n      the smallest (<code style=\"white-space: pre-wrap;\">d3.min</code>) bin to\n      the largest (<code style=\"white-space: pre-wrap;\">d3.max</code>), and a\n      range of <code style=\"white-space: pre-wrap;\">0</code> to width less a\n      margin. We’ll use it to calculate bar sizes.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">yScale</code> has a range from\n      <code style=\"white-space: pre-wrap;\">0</code> to the largest\n      <code style=\"white-space: pre-wrap;\">x1</code> coordinate we can find in\n      a bin. Bins go from <code style=\"white-space: pre-wrap;\">x0</code> to\n      <code style=\"white-space: pre-wrap;\">x1</code>, which reflects the fact\n      that most histograms are horizontally oriented. Ours is vertical so that\n      our labels are easier to read. The range goes from\n      <code style=\"white-space: pre-wrap;\">0</code> to the maximum height less\n      a margin.\n    </p>\n    <p>Now let’s render this puppy.</p>\n    <h3 id=\"render-1\">render</h3>\n    <div\n      class=\"sourceCode\"\n      id=\"cb82\"\n      data-caption=\"Histogram.render\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb82-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Histogram/Histogram.js</span></a>\n<a class=\"sourceLine\" id=\"cb82-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Histogram <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb82-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb82-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb82-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> histogram<span class=\"op\" style=\"color: #666666;\">,</span> yScale <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb82-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> data<span class=\"op\" style=\"color: #666666;\">,</span> axisMargin <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb82-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb82-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> bars <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">histogram</span>(data)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb82-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb82-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb82-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>g className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;histogram&quot;</span> transform<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb82-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>g className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;bars&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb82-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">bars</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">makeBar</span>))<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb82-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb82-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb82-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb82-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb82-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We take everything we need out of\n      <code style=\"white-space: pre-wrap;\">state</code> and\n      <code style=\"white-space: pre-wrap;\">props</code> with destructuring,\n      call <code style=\"white-space: pre-wrap;\">histogram()</code> on our data\n      to get a list of bars, and render.\n    </p>\n    <p>\n      Our render method returns a\n      <code style=\"white-space: pre-wrap;\">&lt;g&gt;</code> grouping element\n      transformed to the position given in props and walks through the\n      <code style=\"white-space: pre-wrap;\">bars</code> array, calling\n      <code style=\"white-space: pre-wrap;\">makeBar</code> for each. Later,\n      we’re going to add an <code style=\"white-space: pre-wrap;\">Axis</code> as\n      well.\n    </p>\n    <p>\n      This is a great example of React’s declarativeness. We have a bunch of\n      stuff, and all it takes to render is a loop. No worrying about how it\n      renders, where it goes, or anything like that. Walk through data, render,\n      done.\n    </p>\n    <h3 id=\"makebar\">makeBar</h3>\n    <p>\n      <code style=\"white-space: pre-wrap;\">makeBar</code> is a function that\n      takes a histogram bar’s metadata and returns a\n      <code style=\"white-space: pre-wrap;\">HistogramBar</code> component. We\n      use it to make our declarative loop more readable.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb83\"\n      data-caption=\"Histogram.makeBar\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb83-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Histogram/Histogram.js</span></a>\n<a class=\"sourceLine\" id=\"cb83-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Histogram <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb83-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb83-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    makeBar <span class=\"op\" style=\"color: #666666;\">=</span> bar <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb83-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> yScale<span class=\"op\" style=\"color: #666666;\">,</span> widthScale <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb83-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb83-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> percent <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"va\" style=\"color: #19177c;\">bar</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span> / <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span>) <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"dv\" style=\"color: #40a070;\">100</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb83-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb83-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> props <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb83-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">percent</span><span class=\"op\" style=\"color: #666666;\">:</span> percent<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb83-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">axisMargin</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb83-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">yScale</span>(<span class=\"va\" style=\"color: #19177c;\">bar</span>.<span class=\"at\" style=\"color: #7d9029;\">x1</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb83-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">width</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">widthScale</span>(<span class=\"va\" style=\"color: #19177c;\">bar</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb83-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">height</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">yScale</span>(<span class=\"va\" style=\"color: #19177c;\">bar</span>.<span class=\"at\" style=\"color: #7d9029;\">x0</span>) <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"at\" style=\"color: #7d9029;\">yScale</span>(<span class=\"va\" style=\"color: #19177c;\">bar</span>.<span class=\"at\" style=\"color: #7d9029;\">x1</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb83-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">key</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;histogram-bar-&quot;</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"va\" style=\"color: #19177c;\">bar</span>.<span class=\"at\" style=\"color: #7d9029;\">x0</span></a>\n<a class=\"sourceLine\" id=\"cb83-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb83-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb83-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>HistogramBar <span class=\"op\" style=\"color: #666666;\">{</span>...<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb83-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb83-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      See, we’re calculating\n      <code style=\"white-space: pre-wrap;\">props</code> and feeding them into\n      <code style=\"white-space: pre-wrap;\">HistogramBar</code>. Putting it in a\n      separate function just makes the\n      <code style=\"white-space: pre-wrap;\">.map</code> construct in\n      <code style=\"white-space: pre-wrap;\">render</code> easier to read.\n      There’s a lot of props to calculate.\n    </p>\n    <p>\n      Some, like <code style=\"white-space: pre-wrap;\">axisMargin</code> we pass\n      through, others like\n      <code style=\"white-space: pre-wrap;\">width</code> and\n      <code style=\"white-space: pre-wrap;\">height</code> we calculate using our\n      scales.\n    </p>\n    <p>\n      Setting the <code style=\"white-space: pre-wrap;\">key</code> prop is\n      important. React uses it to tell the bars apart and only re-render those\n      that change.\n    </p>"
        },
        {
          "lectureTitle": "Step 4: HistogramBar (sub)component",
          "lectureBody": "    <h2 id=\"step-4-histogrambar-subcomponent\">\n      Step 4: HistogramBar (sub)component\n    </h2>\n    <p>\n      Before our histogram shows up, we need another component:\n      <code style=\"white-space: pre-wrap;\">HistogramBar</code>. We\n      <em>could</em> have shoved all of it in the\n      <code style=\"white-space: pre-wrap;\">makeBar</code> function, but it\n      makes sense to keep separate. Better future flexibility.\n    </p>\n    <p>\n      You can write small components like this in the same file as their main\n      component. They’re not reusable since they fit a specific use-case, and\n      they’re small enough so your files don’t get too crazy.\n    </p>\n    <p>\n      But in the interest of readability, let’s make a\n      <code style=\"white-space: pre-wrap;\">HistogramBar</code> file.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb84\"\n      data-caption=\"HistogramBar component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb84-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Histogram/HistogramBar.js</span></a>\n<a class=\"sourceLine\" id=\"cb84-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb84-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb84-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> HistogramBar <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span> percent<span class=\"op\" style=\"color: #666666;\">,</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> width<span class=\"op\" style=\"color: #666666;\">,</span> height <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb84-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> translate <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb84-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        label <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">percent</span>.<span class=\"at\" style=\"color: #7d9029;\">toFixed</span>(<span class=\"dv\" style=\"color: #40a070;\">0</span>) <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;%&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb84-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb84-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (percent <span class=\"op\" style=\"color: #666666;\">&lt;</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb84-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        label <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">percent</span>.<span class=\"at\" style=\"color: #7d9029;\">toFixed</span>(<span class=\"dv\" style=\"color: #40a070;\">2</span>) <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;%&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb84-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb84-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb84-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (width <span class=\"op\" style=\"color: #666666;\">&lt;</span> <span class=\"dv\" style=\"color: #40a070;\">20</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb84-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        label <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">label</span>.<span class=\"at\" style=\"color: #7d9029;\">replace</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;%&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb84-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb84-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb84-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (width <span class=\"op\" style=\"color: #666666;\">&lt;</span> <span class=\"dv\" style=\"color: #40a070;\">10</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb84-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        label <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb84-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb84-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb84-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb84-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">={</span>translate<span class=\"op\" style=\"color: #666666;\">}</span> className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;bar&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb84-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>rect</a>\n<a class=\"sourceLine\" id=\"cb84-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                width<span class=\"op\" style=\"color: #666666;\">={</span>width<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb84-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                height<span class=\"op\" style=\"color: #666666;\">={</span>height <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb84-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                transform<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;translate(0, 1)&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb84-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            /&gt;</a>\n<a class=\"sourceLine\" id=\"cb84-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>text textAnchor<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;end&quot;</span> x<span class=\"op\" style=\"color: #666666;\">={</span>width <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span>height / <span class=\"dv\" style=\"color: #40a070;\">2</span> <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"dv\" style=\"color: #40a070;\">3</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb84-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">{</span>label<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb84-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/text<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb84-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb84-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb84-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb84-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb84-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> HistogramBar<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Pretty long for a functional component. Most of it goes into deciding how\n      much precision to render in the label, so it’s okay.\n    </p>\n    <p>\n      We start with an SVG translate and a default\n      <code style=\"white-space: pre-wrap;\">label</code>. Then we update the\n      label based on the bar size and its value.\n    </p>\n    <p>\n      When we have a label we like, we return a\n      <code style=\"white-space: pre-wrap;\">&lt;g&gt;</code> grouping element\n      with a rectangle and a text. Both positioned based on the\n      <code style=\"white-space: pre-wrap;\">width</code> and\n      <code style=\"white-space: pre-wrap;\">height</code> of the bar.\n    </p>\n    <p>\n      Make sure to import\n      <code style=\"white-space: pre-wrap;\">HistogramBar</code> in the main\n      <code style=\"white-space: pre-wrap;\">Histogram</code> file.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb85\"\n      data-caption=\"HistogramBar import\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb85-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Histogram/Histogram.js</span></a>\n<a class=\"sourceLine\" id=\"cb85-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb85-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> HistogramBar <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./HistogramBar&#39;</span></a></code></pre>\n    </div>\n    <p>You should now see a histogram.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/histogram-without-axis.png\"\n        alt=\"Histogram without axis\"\n      />\n      <figcaption>Histogram without axis</figcaption>\n    </figure>"
        },
        {
          "lectureTitle": "Step 5: Add an axis",
          "lectureBody": "    <h2 id=\"step-5-axis-hoc\">Step 5: Axis HOC</h2>\n    <p>\n      Our histogram is pretty, but it needs an axis to be useful. You’ve\n      already learned how to implement an axis when we talked about\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887732#blackbox-axis\"\n        >blackbox integration</a\n      >. We’re going to use the same approach and copy those concepts into the\n      real project.\n    </p>\n    <h3 id=\"d3blackbox\">D3blackbox</h3>\n    <p>\n      We start with the D3blackbox higher order component. Same as before,\n      except we put it in\n      <code style=\"white-space: pre-wrap;\">src/components</code>.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb86\"\n      data-caption=\"D3blackbox HOC\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb86-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb86-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb86-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> <span class=\"at\" style=\"color: #7d9029;\">D3blackbox</span>(D3render) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb86-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Blackbox <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb86-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        anchorRef <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">createRef</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb86-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb86-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb86-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">D3render</span>.<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb86-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb86-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"at\" style=\"color: #7d9029;\">componentDidUpdate</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb86-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">D3render</span>.<span class=\"at\" style=\"color: #7d9029;\">call</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb86-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb86-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb86-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb86-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb86-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb86-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">}</span> ref<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">anchorRef</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb86-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb86-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb86-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb86-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Take a <code style=\"white-space: pre-wrap;\">D3render</code> function,\n      call it on\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> and\n      <code style=\"white-space: pre-wrap;\">componentDidUpdate</code>, and\n      render a positioned anchor element for\n      <code style=\"white-space: pre-wrap;\">D3render</code> to hook into.\n    </p>\n    <h3 id=\"axis-component\">Axis component</h3>\n    <p>\n      With <code style=\"white-space: pre-wrap;\">D3blackbox</code>, we can\n      reduce the <code style=\"white-space: pre-wrap;\">Axis</code> component to\n      a wrapped function. We’re implementing the\n      <code style=\"white-space: pre-wrap;\">D3render</code> method.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb87\"\n      data-caption=\"Axis component using D3blackbox\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb87-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb87-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> D3blackbox <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;../D3blackbox&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb87-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb87-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Axis <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">D3blackbox</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb87-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> axis <span class=\"op\" style=\"color: #666666;\">=</span> d3</a>\n<a class=\"sourceLine\" id=\"cb87-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">axisLeft</span>()</a>\n<a class=\"sourceLine\" id=\"cb87-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">tickFormat</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"vs\" style=\"color: #4070a0;\">`</span><span class=\"sc\" style=\"color: #4070a0;\">${</span><span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">format</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;.2s&quot;</span>)(d)<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">`</span>)</a>\n<a class=\"sourceLine\" id=\"cb87-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">scale</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">scale</span>)</a>\n<a class=\"sourceLine\" id=\"cb87-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">ticks</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb87-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb87-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">anchorRef</span>.<span class=\"at\" style=\"color: #7d9029;\">current</span>).<span class=\"at\" style=\"color: #7d9029;\">call</span>(axis)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb87-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb87-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb87-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Axis<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We use D3’s\n      <code style=\"white-space: pre-wrap;\">axisLeft</code> generator, configure\n      its <code style=\"white-space: pre-wrap;\">tickFormat</code>, pass in a\n      <code style=\"white-space: pre-wrap;\">scale</code> from our props, and\n      specify how many <code style=\"white-space: pre-wrap;\">ticks</code> we\n      want. To render, we\n      <code style=\"white-space: pre-wrap;\">select</code> the anchor element\n      from <code style=\"white-space: pre-wrap;\">D3blackbox</code> and\n      <code style=\"white-space: pre-wrap;\">call</code> the axis generator on\n      it.\n    </p>\n    <p>\n      Yes, this <code style=\"white-space: pre-wrap;\">Axis</code> works just for\n      our specific use case and that’s okay. No need to generalize your code\n      until you know where else you’re using it.\n    </p>\n    <p>\n      Remember the\n      <a href=\"https://en.wikipedia.org/wiki/You_aren%27t_gonna_need_it\"\n        >YAGNI principle</a\n      >.\n    </p>\n    <h3 id=\"add-axis-to-histogram\">Add Axis to Histogram</h3>\n    <p>\n      To render our new <code style=\"white-space: pre-wrap;\">Axis</code>, we\n      add it to the\n      <code style=\"white-space: pre-wrap;\">Histogram</code> component. It’s a\n      two step process:\n    </p>\n    <ol type=\"1\">\n      <li>\n        Import <code style=\"white-space: pre-wrap;\">Axis</code> component\n      </li>\n      <li>Render it</li>\n    </ol>\n    <div\n      class=\"sourceCode\"\n      id=\"cb88\"\n      data-caption=\"Import and render Axis\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb88-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Histogram/Histogram.js</span></a>\n<a class=\"sourceLine\" id=\"cb88-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> Component <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb88-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;d3&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb88-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb88-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb88-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Axis <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./Axis&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb88-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb88-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb88-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb88-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Histogram <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb88-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb88-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb88-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> histogram<span class=\"op\" style=\"color: #666666;\">,</span> yScale <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb88-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> data<span class=\"op\" style=\"color: #666666;\">,</span> axisMargin <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb88-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb88-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> bars <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">histogram</span>(data)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb88-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb88-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb88-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>g className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;histogram&quot;</span> transform<span class=\"op\" style=\"color: #666666;\">={</span>translate<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb88-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>g className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;bars&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb88-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">bars</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">makeBar</span>)<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb88-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb88-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb88-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>Axis x<span class=\"op\" style=\"color: #666666;\">={</span>axisMargin<span class=\"dv\" style=\"color: #40a070;\">-3</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb88-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                      y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb88-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                      data<span class=\"op\" style=\"color: #666666;\">={</span>bars<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb88-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                      scale<span class=\"op\" style=\"color: #666666;\">={</span>yScale<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb88-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb88-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb88-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb88-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We import our <code style=\"white-space: pre-wrap;\">Axis</code> and add it\n      to the <code style=\"white-space: pre-wrap;\">render</code> method with\n      some props. It takes an <code style=\"white-space: pre-wrap;\">x</code> and\n      <code style=\"white-space: pre-wrap;\">y</code> coordinate, the\n      <code style=\"white-space: pre-wrap;\">data</code>, and a\n      <code style=\"white-space: pre-wrap;\">scale</code>.\n    </p>\n    <p>An axis appears.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/basic-histogram.png\"\n        alt=\"Basic histogram with axis\"\n      />\n      <figcaption>Basic histogram with axis</figcaption>\n    </figure>\n    <p>\n      If that didn’t work, try comparing your changes to this\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/02a40899e348587a909e97e8f18ecf468e2fe218\"\n        >diff on Github</a\n      >.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Make it understandable with meta info",
      "lectures": [
        {
          "lectureTitle": "Add meta info",
          "lectureBody": "    <h1 id=\"make-it-understandable---meta-info\">\n      Make it understandable - meta info\n    </h1>\n    <p>\n      You’ve come so far! There’s a US map and a histogram. They’re blue and\n      shiny and you look at them and you go <em>“Huh?”</em>.\n    </p>\n    <p>\n      The key to a good data visualization is telling users what it means. An\n      easy way to do that is a good title and description. Just tell them. The\n      picture supports the words, the words explain the picture.\n    </p>\n    <p>Let’s add those words.</p>\n    <p>\n      We’re adding a dynamic title and description, and a median line on the\n      histogram. The text is dynamic because we’re adding user controls later,\n      and we want the pictures and the words to stay in sync.\n    </p>\n    <p>\n      At the end of this section, you’ll have a full visualization of the\n      shortened dataset.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/dataviz-without-controls.png\"\n        alt=\"Full visualization without user controls\"\n      />\n      <figcaption>Full visualization without user controls</figcaption>\n    </figure>"
        },
        {
          "lectureTitle": "Dynamic title",
          "lectureBody": "    <h2 id=\"dynamic-title\">Dynamic title</h2>\n    <p>We begin with the title because it shows up first.</p>\n    <p>\n      We start with an import in\n      <code style=\"white-space: pre-wrap;\">App.js</code> and add it to the\n      render method. You know the drill 😄\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb89\"\n      data-caption=\"Adding Title to main App component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb89-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb89-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> CountyMap <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/CountyMap&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb89-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Histogram <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Histogram&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb89-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb89-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> Title <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Meta&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb89-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb89-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb89-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb89-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb89-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">techSalaries</span><span class=\"op\" style=\"color: #666666;\">:</span> []<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb89-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">countyNames</span><span class=\"op\" style=\"color: #666666;\">:</span> []<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb89-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">medianIncomes</span><span class=\"op\" style=\"color: #666666;\">:</span> []<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb89-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb89-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">filteredBy</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb89-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">USstate</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;*&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb89-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">year</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;*&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb89-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">jobTitle</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;*&#39;</span></a>\n<a class=\"sourceLine\" id=\"cb89-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb89-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb89-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb89-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb89-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb89-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb89-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb89-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> filteredBy <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb89-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb89-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb89-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App container&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb89-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb89-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>Title data<span class=\"op\" style=\"color: #666666;\">={</span>filteredSalaries<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb89-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                       filteredBy<span class=\"op\" style=\"color: #666666;\">={</span>filteredBy<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb89-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb89-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb89-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb89-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )</a>\n<a class=\"sourceLine\" id=\"cb89-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb89-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Ok, I lied. We did a lot more than just imports and adding to render.\n    </p>\n    <p>\n      We also set up the\n      <code style=\"white-space: pre-wrap;\">App</code> component for future\n      user-controlled data filtering. The\n      <code style=\"white-space: pre-wrap;\">filteredBy</code> key in\n      <code style=\"white-space: pre-wrap;\">state</code> tells us what the user\n      is filtering by – 3 options:\n      <code style=\"white-space: pre-wrap;\">USstate</code>,\n      <code style=\"white-space: pre-wrap;\">year</code>, and\n      <code style=\"white-space: pre-wrap;\">jobTitle</code>. We set them to\n      “everything” by default.\n    </p>\n    <p>\n      We added them now so that we can immediately write our\n      <code style=\"white-space: pre-wrap;\">Title</code> component in a\n      filterable way. No need to make changes later.\n    </p>\n    <p>\n      As you can see, <code style=\"white-space: pre-wrap;\">Title</code> takes\n      <code style=\"white-space: pre-wrap;\">data</code> and\n      <code style=\"white-space: pre-wrap;\">filteredBy</code> props.\n    </p>\n    <h3 id=\"prep-meta-component\">Prep Meta component</h3>\n    <p>\n      Before we begin the\n      <code style=\"white-space: pre-wrap;\">Title</code> component, there are a\n      few things to take care of. Our meta components work together for a\n      common purpose – showing meta data. Grouping them in a directory makes\n      sense.\n    </p>\n    <p>\n      We make a\n      <code style=\"white-space: pre-wrap;\">components/Meta</code> directory and\n      add an <code style=\"white-space: pre-wrap;\">index.js</code>. It makes\n      importing easier.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb90\"\n      data-caption=\"Meta index.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb90-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Meta/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb90-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"im\">default</span> <span class=\"im\">as</span> Title <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./Title&#39;</span></a>\n<a class=\"sourceLine\" id=\"cb90-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"im\">default</span> <span class=\"im\">as</span> Description <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./Description&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We have to name our <code style=\"white-space: pre-wrap;\">Title</code> and\n      <code style=\"white-space: pre-wrap;\">Description</code> re-exports\n      because you can’t have two default exports.\n    </p>\n    <h4 id=\"get-the-usstatesmap-file\">Get the USStatesMap file</h4>\n    <p>\n      You need the\n      <code style=\"white-space: pre-wrap;\">USStatesMap</code> file.\n    </p>\n    <p>\n      It’s a big dictionary that translates US state codes to full names. You\n      can\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/blob/4f94fcd1c3caeb0fc410636243ca99764e27c5e6/src/components/Meta/USStatesMap.js\"\n        >get it from Github</a\n      >\n      and save it as\n      <code style=\"white-space: pre-wrap;\">components/Meta/USStatesMap.js</code\n      >.\n    </p>\n    <p>We’ll use it when creating titles and descriptions.</p>\n    <h3 id=\"implement-title\">Implement Title</h3>\n    <p>\n      We’re building two types of titles based on user selection. If both\n      <code style=\"white-space: pre-wrap;\">years</code> and\n      <code style=\"white-space: pre-wrap;\">US state</code> were selected, we\n      return\n      <code style=\"white-space: pre-wrap;\"\n        >In {US state}, the average {job title} paid ${mean}/year in\n        {year}</code\n      >. If not, we return\n      <code style=\"white-space: pre-wrap;\"\n        >{job title} paid ${mean}/year in {state} in {year}</code\n      >.\n    </p>\n    <p>\n      I know, it’s confusing. They look like the same sentence turned around.\n      Notice the <em>and</em>. First option when <em>both</em> are selected,\n      second when either/or.\n    </p>\n    <p>We start with imports, a stub, and a default export.</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb91\"\n      data-caption=\"Title component stub\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb91-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Meta/Title.js</span></a>\n<a class=\"sourceLine\" id=\"cb91-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> Component <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb91-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> scaleLinear <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;d3-scale&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb91-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> mean <span class=\"im\">as</span> d3mean<span class=\"op\" style=\"color: #666666;\">,</span> extent <span class=\"im\">as</span> d3extent <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;d3-array&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb91-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb91-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> USStatesMap <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./USStatesMap&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb91-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb91-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Title <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb91-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    get <span class=\"at\" style=\"color: #7d9029;\">yearsFragment</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb91-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb91-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb91-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    get <span class=\"at\" style=\"color: #7d9029;\">USstateFragment</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb91-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb91-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb91-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    get <span class=\"at\" style=\"color: #7d9029;\">jobTitleFragment</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb91-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb91-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb91-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    get <span class=\"at\" style=\"color: #7d9029;\">format</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb91-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb91-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb91-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb91-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb91-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb91-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb91-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Title<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We import only what we need from D3’s\n      <code style=\"white-space: pre-wrap;\">d3-scale</code> and\n      <code style=\"white-space: pre-wrap;\">d3-array</code> packages. I consider\n      this best practice until you’re importing so much that it gets messy to\n      look at.\n    </p>\n    <p>\n      In the <code style=\"white-space: pre-wrap;\">Title</code> component, we\n      have 4 getters and a render. Getters are ES6 functions that work like\n      dynamic properties. You specify a function without arguments, and you use\n      it without <code style=\"white-space: pre-wrap;\">()</code>. It’s neat.\n    </p>\n    <h4 id=\"the-getters\">The getters</h4>\n    <ol type=\"1\">\n      <li>\n        <code style=\"white-space: pre-wrap;\">yearsFragment</code> describes the\n        selected year\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">USstateFragment</code> describes\n        the selected US state\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">jobTitleFragment</code> describes\n        the selected job title\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">format</code> returns a number\n        formatter\n      </li>\n    </ol>\n    <p>\n      We can implement\n      <code style=\"white-space: pre-wrap;\">yearsFragment</code>,\n      <code style=\"white-space: pre-wrap;\">USstateFragment</code>, and\n      <code style=\"white-space: pre-wrap;\">format</code> in one code sample.\n      They’re short.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb92\"\n      data-caption=\"3 short getters in Title\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb92-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Meta/Title.js</span></a>\n<a class=\"sourceLine\" id=\"cb92-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Title <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb92-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    get <span class=\"at\" style=\"color: #7d9029;\">yearsFragment</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb92-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> year <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"va\" style=\"color: #19177c;\">filteredBy</span>.<span class=\"at\" style=\"color: #7d9029;\">year</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb92-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb92-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> year <span class=\"op\" style=\"color: #666666;\">===</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;*&#39;</span> <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;&quot;</span> : <span class=\"vs\" style=\"color: #4070a0;\">`in </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>year<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">`</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb92-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb92-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb92-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">getteFragment</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb92-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> USstate <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"va\" style=\"color: #19177c;\">filteredBy</span>.<span class=\"at\" style=\"color: #7d9029;\">USstate</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb92-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb92-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> USstate <span class=\"op\" style=\"color: #666666;\">===</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;*&#39;</span> <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;&quot;</span> : USStatesMap[<span class=\"va\" style=\"color: #19177c;\">USstate</span>.<span class=\"at\" style=\"color: #7d9029;\">toUpperCase</span>()]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb92-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb92-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb92-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb92-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb92-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    get <span class=\"at\" style=\"color: #7d9029;\">format</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb92-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb92-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                 .<span class=\"at\" style=\"color: #7d9029;\">domain</span>(<span class=\"at\" style=\"color: #7d9029;\">d3extent</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">data</span><span class=\"op\" style=\"color: #666666;\">,</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">base_salary</span>))</a>\n<a class=\"sourceLine\" id=\"cb92-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                 .<span class=\"at\" style=\"color: #7d9029;\">tickFormat</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb92-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      In both <code style=\"white-space: pre-wrap;\">yearsFragment</code> and\n      <code style=\"white-space: pre-wrap;\">USstateFragment</code>, we get the\n      appropriate value from Title’s\n      <code style=\"white-space: pre-wrap;\">filteredBy</code> prop, then return\n      a string with the value or an empty string.\n    </p>\n    <p>\n      We rely on D3’s built-in number formatters to build\n      <code style=\"white-space: pre-wrap;\">format</code>. Linear scales have\n      the one that turns <code style=\"white-space: pre-wrap;\">10000</code> into\n      <code style=\"white-space: pre-wrap;\">10,000</code>. Tick formatters don’t\n      work well without a <code style=\"white-space: pre-wrap;\">domain</code>,\n      so we define it. We don’t need a range because we never use the scale\n      itself.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">format</code> returns a function,\n      which makes it a\n      <a href=\"https://en.wikipedia.org/wiki/Higher-order_function\"\n        >higher order function</a\n      >. Being a getter makes it really nice to use:\n      <code style=\"white-space: pre-wrap;\">this.format()</code>. Looks just\n      like a normal function call 😄\n    </p>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">jobTitleFragment</code> getter\n      is conceptually no harder than\n      <code style=\"white-space: pre-wrap;\">yearsFragment</code> and\n      <code style=\"white-space: pre-wrap;\">USstateFragment</code>, but it comes\n      with a few more conditionals.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb93\"\n      data-caption=\"Title.jobTitleFragment\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb93-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Meta/Title.js</span></a>\n<a class=\"sourceLine\" id=\"cb93-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb93-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Title <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb93-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb93-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    get <span class=\"at\" style=\"color: #7d9029;\">jobTitleFragment</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb93-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> jobTitle<span class=\"op\" style=\"color: #666666;\">,</span> year <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">filteredBy</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb93-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> title <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb93-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb93-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (jobTitle <span class=\"op\" style=\"color: #666666;\">===</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb93-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (year <span class=\"op\" style=\"color: #666666;\">===</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb93-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                title <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;The average H1B in tech pays&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb93-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">else</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb93-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                title <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;The average tech H1B paid&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb93-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb93-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">else</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb93-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            title <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"vs\" style=\"color: #4070a0;\">`Software </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>jobTitle<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">s on an H1B`</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb93-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (year <span class=\"op\" style=\"color: #666666;\">===</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb93-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                title <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot; make&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb93-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">else</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb93-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                title <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot; made&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb93-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb93-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb93-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb93-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> title<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb93-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb93-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb93-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We’re dealing with the\n      <code style=\"white-space: pre-wrap;\">(jobTitle, year)</code> combination.\n      Each influences the other when building the fragment for a total 4\n      different options.\n    </p>\n    <h4 id=\"the-render\">The render</h4>\n    <p>\n      We put all this together in the\n      <code style=\"white-space: pre-wrap;\">render</code> method. A conditional\n      decides which of the two situations we’re in, and we return an\n      <code style=\"white-space: pre-wrap;\">&lt;h2&gt;</code> tag with the right\n      text.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb94\"\n      data-caption=\"Title.render\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb94-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Meta/Title.js</span></a>\n<a class=\"sourceLine\" id=\"cb94-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Title <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb94-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb94-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb94-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> mean <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">format</span>(<span class=\"at\" style=\"color: #7d9029;\">d3mean</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">data</span><span class=\"op\" style=\"color: #666666;\">,</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">base_salary</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb94-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb94-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> title<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb94-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb94-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">yearsFragment</span> <span class=\"op\" style=\"color: #666666;\">&amp;&amp;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">USstateFragment</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb94-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            title <span class=\"op\" style=\"color: #666666;\">=</span> (</a>\n<a class=\"sourceLine\" id=\"cb94-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>h2<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb94-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    In <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">USstateFragment</span><span class=\"op\" style=\"color: #666666;\">},</span> <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">jobTitleFragment</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb94-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    $<span class=\"op\" style=\"color: #666666;\">{</span>mean<span class=\"op\" style=\"color: #666666;\">}</span><span class=\"ss\" style=\"color: #bb6688;\">/year {this.yearsFragment}</span></a>\n<a class=\"sourceLine\" id=\"cb94-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"ss\" style=\"color: #bb6688;\">                &lt;/h2</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb94-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb94-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span><span class=\"cf\" style=\"color: #007020; font-weight: bold;\">else</span><span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb94-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            title <span class=\"op\" style=\"color: #666666;\">=</span> (</a>\n<a class=\"sourceLine\" id=\"cb94-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>h2<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb94-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">jobTitleFragment</span><span class=\"op\" style=\"color: #666666;\">}</span> $<span class=\"op\" style=\"color: #666666;\">{</span>mean<span class=\"op\" style=\"color: #666666;\">}</span><span class=\"ss\" style=\"color: #bb6688;\">/year</span></a>\n<a class=\"sourceLine\" id=\"cb94-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"ss\" style=\"color: #bb6688;\">                    {this.USstateFragment </span><span class=\"sc\" style=\"color: #4070a0;\">?</span><span class=\"ss\" style=\"color: #bb6688;\"> `in ${this.stateFragment}` : &#39;&#39;}</span></a>\n<a class=\"sourceLine\" id=\"cb94-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"ss\" style=\"color: #bb6688;\">                    {this.yearsFragment}</span></a>\n<a class=\"sourceLine\" id=\"cb94-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"ss\" style=\"color: #bb6688;\">                &lt;/h2</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb94-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb94-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb94-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb94-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> title<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb94-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb94-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Calculate the mean value using\n      <code style=\"white-space: pre-wrap;\">d3.mean</code> with a value\n      accessor, turn it into a pretty number with\n      <code style=\"white-space: pre-wrap;\">this.format</code>, then use one of\n      two string patterns to make a\n      <code style=\"white-space: pre-wrap;\">title</code>.\n    </p>\n    <p>And a title appears.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/dataviz-with-title.png\"\n        alt=\"Dataviz with title\"\n      />\n      <figcaption>Dataviz with title</figcaption>\n    </figure>\n    <p>\n      If it doesn’t, consult\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/4f94fcd1c3caeb0fc410636243ca99764e27c5e6\"\n        >this diff on Github</a\n      >.\n    </p>"
        },
        {
          "lectureTitle": "Dynamic description",
          "lectureBody": "    <h2 id=\"dynamic-description\">Dynamic description</h2>\n    <p>\n      You know what? The dynamic description component is pretty much the same\n      as the title. It’s just longer and more complex and uses more code. It’s\n      interesting, but not super relevant to the topic of this book.\n    </p>\n    <p>\n      So rather than explain it all here, I’m going to give you a link to the\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/032fe6e988b903b6d86a60d2f0404456785e180f\"\n        >diff on Github</a\n      >\n    </p>\n    <p>We use the same approach as before:</p>\n    <ol type=\"1\">\n      <li>\n        Add imports in <code style=\"white-space: pre-wrap;\">App.js</code>\n      </li>\n      <li>\n        Add component to <code style=\"white-space: pre-wrap;\">App</code> render\n      </li>\n      <li>\n        Add re-export to\n        <code style=\"white-space: pre-wrap;\">components/Meta/index.js</code>\n      </li>\n      <li>\n        Implement component in\n        <code style=\"white-space: pre-wrap;\"\n          >components/Meta/Description.js</code\n        >\n      </li>\n      <li>Use getters for sentence fragments</li>\n      <li>Play with conditionals to construct different sentences</li>\n    </ol>\n    <p>142 lines of mundane code.</p>\n    <p>\n      All the interesting complexity goes into finding the richest city and\n      county. That part looks like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb95\"\n      data-caption=\"Richest county calculation\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb95-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Meta/Description.js</span></a>\n<a class=\"sourceLine\" id=\"cb95-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">get <span class=\"at\" style=\"color: #7d9029;\">countyFragment</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb95-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> byCounty <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">groupBy</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">data</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;countyID&#39;</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb95-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        medians <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">medianIncomesByCounty</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb95-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb95-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> ordered <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">sortBy</span>(</a>\n<a class=\"sourceLine\" id=\"cb95-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">keys</span>(byCounty)</a>\n<a class=\"sourceLine\" id=\"cb95-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">       .<span class=\"at\" style=\"color: #7d9029;\">map</span>(county <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> byCounty[county])</a>\n<a class=\"sourceLine\" id=\"cb95-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">       .<span class=\"at\" style=\"color: #7d9029;\">filter</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span>/<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span> <span class=\"op\" style=\"color: #666666;\">&gt;</span> <span class=\"fl\" style=\"color: #40a070;\">0.01</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb95-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      items <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"at\" style=\"color: #7d9029;\">d3mean</span>(items<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb95-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                      d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">base_salary</span>) <span class=\"op\" style=\"color: #666666;\">-</span> medians[items[<span class=\"dv\" style=\"color: #40a070;\">0</span>].<span class=\"at\" style=\"color: #7d9029;\">countyID</span>][<span class=\"dv\" style=\"color: #40a070;\">0</span>].<span class=\"at\" style=\"color: #7d9029;\">medianIncome</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb95-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb95-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> best <span class=\"op\" style=\"color: #666666;\">=</span> ordered[<span class=\"va\" style=\"color: #19177c;\">ordered</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span><span class=\"dv\" style=\"color: #40a070;\">-1</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb95-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      countyMedian <span class=\"op\" style=\"color: #666666;\">=</span> medians[best[<span class=\"dv\" style=\"color: #40a070;\">0</span>].<span class=\"at\" style=\"color: #7d9029;\">countyID</span>][<span class=\"dv\" style=\"color: #40a070;\">0</span>].<span class=\"at\" style=\"color: #7d9029;\">medianIncome</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb95-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb95-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb95-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We group the dataset by county, then sort counties by their income delta.\n      We look only at counties that are bigger than 1% of the entire dataset.\n      And we define income delta as the difference between a county’s median\n      household income and the median tech salary in our dataset.\n    </p>\n    <p>\n      This code is not super efficient, but it gets the job done. We could\n      optimize by just looking for the max value, for example.\n    </p>\n    <p>Similar code handles finding the best city.</p>\n    <h3 id=\"render-the-description\">render the description</h3>\n    <p>\n      I recommend copying the\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/032fe6e988b903b6d86a60d2f0404456785e180f\"\n        ><code style=\"white-space: pre-wrap;\">Description</code> component from\n        GitHub</a\n      >. Most of it has little to do with React and data visualization. It’s\n      all about combining sentence fragments based on props.\n    </p>\n    <p>You then render the Description like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb96\"\n      data-caption=\"Render Description component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb96-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb96-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb96-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> Title<span class=\"op\" style=\"color: #666666;\">,</span> Description <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;./components/Meta&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb96-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb96-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb96-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb96-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">&lt;</span>Description</a>\n<a class=\"sourceLine\" id=\"cb96-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    data<span class=\"op\" style=\"color: #666666;\">={</span>filteredSalaries<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb96-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    allData<span class=\"op\" style=\"color: #666666;\">={</span>techSalaries<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb96-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    filteredBy<span class=\"op\" style=\"color: #666666;\">={</span>filteredBy<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb96-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    medianIncomesByCounty<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">medianIncomesByCounty</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb96-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">/&gt;</a></code></pre>\n    </div>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/dataviz-with-description.png\"\n        alt=\"Dataviz with Title and Description\"\n      />\n      <figcaption>Dataviz with Title and Description</figcaption>\n    </figure>\n    <p>\n      Another similar component is the\n      <code style=\"white-space: pre-wrap;\">GraphDescription</code>. It shows a\n      small description on top of each chart that explains how to read the\n      picture. Less “Here’s a key takeaway”, more “color means X”.\n    </p>\n    <p>\n      You can follow this\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/37b5222546c3f8f58f3147ce0bef6a3c1afe1b47\"\n        >diff on Github</a\n      >\n      to implement it. Same approach as\n      <code style=\"white-space: pre-wrap;\">Title</code> and\n      <code style=\"white-space: pre-wrap;\">Description</code>.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/dataviz-with-all-descriptions.png\"\n        alt=\"Dataviz with all descriptions\"\n      />\n      <figcaption>Dataviz with all descriptions</figcaption>\n    </figure>"
        },
        {
          "lectureTitle": "Overlay a median household line",
          "lectureBody": "    <h2 id=\"overlay-a-median-household-line\">\n      Overlay a median household line\n    </h2>\n    <p>\n      Here’s a more interesting component: the median dotted line. It shows a\n      direct comparison between the histogram’s distribution and the median\n      household income in an area. I’m not sure people understand it at a\n      glance, but I think it’s cool.\n    </p>\n    <p>\n      We’re using a quick approach where everything fits into a functional\n      React component. It’s great for small components like this.\n    </p>\n    <h3 id=\"step-1-app.js\">Step 1: App.js</h3>\n    <p>\n      Inside <code style=\"white-space: pre-wrap;\">src/App.js</code>, we first\n      have to add an import, then extract the median household value from\n      state, and in the end, add\n      <code style=\"white-space: pre-wrap;\">MedianLine</code> to the render\n      method.\n    </p>\n    <p>Let’s see if we can do it in a single code block 😄</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb97\"\n      data-caption=\"Adding MedianLine to App.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb97-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb97-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Histogram <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Histogram&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb97-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> Title<span class=\"op\" style=\"color: #666666;\">,</span> Description<span class=\"op\" style=\"color: #666666;\">,</span> GraphDescription <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Meta&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb97-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb97-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> MedianLine <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/MedianLine&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb97-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb97-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb97-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb97-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb97-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb97-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb97-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> zoom <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb97-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb97-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            medianHousehold <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">medianIncomesByUSState</span>[<span class=\"st\" style=\"color: #4070a0;\">&#39;US&#39;</span>][<span class=\"dv\" style=\"color: #40a070;\">0</span>]</a>\n<a class=\"sourceLine\" id=\"cb97-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                  .<span class=\"at\" style=\"color: #7d9029;\">medianIncome</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb97-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb97-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb97-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb97-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb97-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;1100&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;500&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb97-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>CountyMap <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ... /&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb97-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>Histogram <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ... /&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb97-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb97-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>MedianLine data<span class=\"op\" style=\"color: #666666;\">={</span>filteredSalaries<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb97-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">500</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb97-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">10</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb97-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">600</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb97-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">500</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb97-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            bottomMargin<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb97-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            median<span class=\"op\" style=\"color: #666666;\">={</span>medianHousehold<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb97-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            value<span class=\"op\" style=\"color: #666666;\">={</span>d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">base_salary</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb97-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb97-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb97-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )</a>\n<a class=\"sourceLine\" id=\"cb97-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb97-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      You probably don’t remember\n      <code style=\"white-space: pre-wrap;\">medianIncomesByUSState</code>\n      anymore. We set it up way back when\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6888897#tie-datasets-together\"\n        >tying datasets together</a\n      >. It groups our salary data by US state.\n    </p>\n    <p>See, using good names helps 😄</p>\n    <p>\n      When rendering <code style=\"white-space: pre-wrap;\">MedianLine</code>, we\n      give it sizing and positioning props, the dataset, a\n      <code style=\"white-space: pre-wrap;\">value</code> accessor, and the\n      median value to show. We could make it smart enough to calculate the\n      median, but the added flexibility of a prop felt right.\n    </p>\n    <h3 id=\"step-2-medianline\">Step 2: MedianLine</h3>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">MedianLine</code> component\n      looks similar to what you’ve seen so far. Some imports, a\n      <code style=\"white-space: pre-wrap;\">constructor</code> that sets up D3\n      objects, an <code style=\"white-space: pre-wrap;\">updateD3</code> method\n      that keeps them in sync, and a\n      <code style=\"white-space: pre-wrap;\">render</code> method that outputs\n      SVG.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb98\"\n      data-caption=\"MedianLine component stub\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb98-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/MedianLine.js</span></a>\n<a class=\"sourceLine\" id=\"cb98-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb98-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb98-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb98-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb98-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> MedianLine <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb98-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    data<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb98-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    value<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb98-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    width<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb98-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    height<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb98-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    x<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb98-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    y<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb98-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    bottomMargin<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb98-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    median</a>\n<a class=\"sourceLine\" id=\"cb98-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb98-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb98-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb98-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb98-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> MedianLine<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We have some imports, a functional\n      <code style=\"white-space: pre-wrap;\">MedianLine</code> component that\n      takes our props, and an export. It should cause an error because it’s not\n      returning anything.\n    </p>\n    <p>Everything we need to render the line, fits into this function.</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb99\"\n      data-caption=\"MedianLine render\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb99-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/MedianLine.js</span></a>\n<a class=\"sourceLine\" id=\"cb99-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb99-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> MedianLine <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb99-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb99-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb99-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> yScale <span class=\"op\" style=\"color: #666666;\">=</span> d3</a>\n<a class=\"sourceLine\" id=\"cb99-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb99-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">max</span>(data<span class=\"op\" style=\"color: #666666;\">,</span> value)])</a>\n<a class=\"sourceLine\" id=\"cb99-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">range</span>([height <span class=\"op\" style=\"color: #666666;\">-</span> y <span class=\"op\" style=\"color: #666666;\">-</span> bottomMargin<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>])<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb99-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        line <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">line</span>()([[<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">5</span>]<span class=\"op\" style=\"color: #666666;\">,</span> [width<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">5</span>]])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb99-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb99-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> medianValue <span class=\"op\" style=\"color: #666666;\">=</span> median <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">median</span>(data<span class=\"op\" style=\"color: #666666;\">,</span> value)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb99-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb99-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> translate <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span><span class=\"at\" style=\"color: #7d9029;\">yScale</span>(medianValue)<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb99-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        medianLabel <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"vs\" style=\"color: #4070a0;\">`Median Household: $</span><span class=\"sc\" style=\"color: #4070a0;\">${</span><span class=\"va\" style=\"color: #19177c;\">yScale</span>.<span class=\"at\" style=\"color: #7d9029;\">tickFormat</span>()(median)<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">`</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb99-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb99-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb99-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>g className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;mean&quot;</span> transform<span class=\"op\" style=\"color: #666666;\">={</span>translate<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb99-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>text</a>\n<a class=\"sourceLine\" id=\"cb99-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                x<span class=\"op\" style=\"color: #666666;\">={</span>width <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb99-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                y<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;0&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb99-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                textAnchor<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;end&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb99-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                style<span class=\"op\" style=\"color: #666666;\">={{</span> <span class=\"dt\">background</span><span class=\"op\">:</span> <span class=\"st\">&quot;purple&quot;</span> <span class=\"op\">}}</span></a>\n<a class=\"sourceLine\" id=\"cb99-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb99-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">{</span>medianLabel<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb99-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/text<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb99-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>path d<span class=\"op\" style=\"color: #666666;\">={</span>line<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb99-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb99-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb99-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      We start with a scale for vertical positioning –\n      <code style=\"white-space: pre-wrap;\">yScale</code>. It’s linear, takes\n      values from <code style=\"white-space: pre-wrap;\">0</code> to\n      <code style=\"white-space: pre-wrap;\">max</code>, and translates them to\n      pixels less some margin. For the\n      <code style=\"white-space: pre-wrap;\">medianValue</code>, we use props, or\n      calculate our own, if needed. Just like I promised.\n    </p>\n    <p>\n      A <code style=\"white-space: pre-wrap;\">translate</code> SVG transform\n      helps us position our line and label. We use it all to return a\n      <code style=\"white-space: pre-wrap;\">&lt;g&gt;</code> grouping element\n      containing a <code style=\"white-space: pre-wrap;\">&lt;text&gt;</code> for\n      our label, and a\n      <code style=\"white-space: pre-wrap;\">&lt;path&gt;</code> for the line.\n    </p>\n    <p>\n      Building the <code style=\"white-space: pre-wrap;\">d</code> attribute for\n      the path, that’s interesting. We use a\n      <code style=\"white-space: pre-wrap;\">line</code> generator from D3.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb100\"\n      data-caption=\"Line generator\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb100-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">line <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">line</span>()([[<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">5</span>]<span class=\"op\" style=\"color: #666666;\">,</span> [width<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">5</span>]])<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      It comes from the\n      <a href=\"https://github.com/d3/d3-shape#lines\">d3-shape</a> package and\n      generates splines, or polylines. By default, it takes an array of points\n      and builds a line through all of them. A line from\n      <code style=\"white-space: pre-wrap;\">[0, 5]</code> to\n      <code style=\"white-space: pre-wrap;\">[width, 5]</code> in our case.\n    </p>\n    <p>\n      That makes it span the entire width and leaves 5px for the label. We’re\n      using a <code style=\"white-space: pre-wrap;\">transform</code> on the\n      entire group to vertically position the final element.\n    </p>\n    <p>\n      Remember, we already styled\n      <code style=\"white-space: pre-wrap;\">medianLine</code> when we built\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6888921#histogram-css\"\n        >histogram styles</a\n      >\n      earlier.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb101\"\n      data-caption=\"Histogram css\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode css\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode css\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb101-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"fu\" style=\"color: #06287e;\">.mean</span> text {</a>\n<a class=\"sourceLine\" id=\"cb101-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">font</span>: <span class=\"dv\" style=\"color: #40a070;\">11</span><span class=\"dt\" style=\"color: #902000;\">px</span> <span class=\"dv\" style=\"color: #40a070;\">sans-serif</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb101-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">fill</span>: <span class=\"cn\" style=\"color: #880000;\">grey</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb101-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">}</a>\n<a class=\"sourceLine\" id=\"cb101-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb101-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"fu\" style=\"color: #06287e;\">.mean</span> path {</a>\n<a class=\"sourceLine\" id=\"cb101-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    stroke-dasharray: <span class=\"dv\" style=\"color: #40a070;\">3</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb101-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    stroke: <span class=\"cn\" style=\"color: #880000;\">grey</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb101-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    stroke-width: <span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"dt\" style=\"color: #902000;\">px</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb101-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">}</a></code></pre>\n    </div>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">stroke-dasharray</code> is what\n      makes it dashed. <code style=\"white-space: pre-wrap;\">3</code> means each\n      <code style=\"white-space: pre-wrap;\">3px</code> dash is followed by a\n      <code style=\"white-space: pre-wrap;\">3px</code> blank. You can use\n      <a\n        href=\"https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-dasharray\"\n        >any pattern you like</a\n      >.\n    </p>\n    <p>\n      You should see a median household salary line overlaid on your histogram.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/dataviz-with-everything.png\"\n        alt=\"Median line over histogram\"\n      />\n      <figcaption>Median line over histogram</figcaption>\n    </figure>\n    <p>\n      Almost everyone in tech makes more than an entire median household.\n      Crazy, huh? I think it is.\n    </p>\n    <p>\n      If that didn’t work, consult the\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/1fd055e461184fb8dc8dd509edb3a6a683c995fe\"\n        >diff on Github</a\n      >.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Add user controls for exploration",
      "lectures": [
        {
          "lectureTitle": "Add user controls for data slicing and dicing",
          "lectureBody": "    <h1 id=\"user-controls\">Add user controls for data slicing and dicing</h1>\n    <p>\n      Now comes the fun part. All that extra effort we put into making our\n      components aware of filtering, and it all comes down to this: User\n      controls.\n    </p>\n    <p>Here’s what we’re building:</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/controls.png\"\n        alt=\"User controlled filters\"\n      />\n      <figcaption>User controlled filters</figcaption>\n    </figure>\n    <p>\n      It’s a set of filters for users to slice and dice our visualization. The\n      shortened dataset gives you 2 years, 12 job titles, and 50 US states.\n      You’ll get 5+ years and many more job titles with the full dataset.\n    </p>\n    <p>\n      We’re using the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6887770#basic-architecture\"\n        >architecture we discussed</a\n      >\n      earlier to make it work. Clicking buttons updates a filter function and\n      communicates it all the way up to the\n      <code style=\"white-space: pre-wrap;\">App</code> component.\n      <code style=\"white-space: pre-wrap;\">App</code> then uses it to update\n      <code style=\"white-space: pre-wrap;\">this.state.filteredSalaries</code>,\n      which triggers a re-render and updates our dataviz.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/architecture_callbacks.png\"\n        alt=\"Architecture sketch\"\n      />\n      <figcaption>Architecture sketch</figcaption>\n    </figure>\n    <p>We’re building controls in 4 steps, top to bottom:</p>\n    <ol type=\"1\">\n      <li>\n        Update <code style=\"white-space: pre-wrap;\">App.js</code> with\n        filtering and a\n        <code style=\"white-space: pre-wrap;\">&lt;Controls&gt;</code> render\n      </li>\n      <li>\n        Build a <code style=\"white-space: pre-wrap;\">Controls</code> component,\n        which builds the filter based on inputs\n      </li>\n      <li>\n        Build a\n        <code style=\"white-space: pre-wrap;\">ControlRow</code> component, which\n        handles a row of buttons\n      </li>\n      <li>\n        Build a <code style=\"white-space: pre-wrap;\">Toggle</code> component,\n        which is a button\n      </li>\n    </ol>\n    <p>\n      We’ll go through the files linearly. That makes them easier for me to\n      explain and easier for you to understand, but that also means there’s\n      going to be a long period where all you’re seeing is an error like this:\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/controls-error.png\"\n        alt=\"Controls error during coding\"\n      />\n      <figcaption>Controls error during coding</figcaption>\n    </figure>\n    <p>\n      If you want to see what’s up during this process, remove an import or two\n      and maybe a thing from render. For instance, it’s complaining about\n      <code style=\"white-space: pre-wrap;\">ControlRow</code> in this\n      screenshot. Remove the\n      <code style=\"white-space: pre-wrap;\">ControlRow</code> import on top and\n      delete\n      <code style=\"white-space: pre-wrap;\">&lt;ControlRow ... /&gt;</code> from\n      render. The error goes away, and you see what you’re doing.\n    </p>"
        },
        {
          "lectureTitle": "Step 1: Update App.js",
          "lectureBody": "    <h2 id=\"step-1-update-app.js\">Step 1: Update App.js</h2>\n    <p>\n      All right, you know the drill. Add imports, tweak some things, add to\n      render. We have to import\n      <code style=\"white-space: pre-wrap;\">Controls</code>, set up filtering,\n      update the map’s <code style=\"white-space: pre-wrap;\">zoom</code> prop,\n      and render a white rectangle and\n      <code style=\"white-space: pre-wrap;\">Controls</code>.\n    </p>\n    <p>\n      The white rectangle makes it so the zoomed-in map doesn’t cover up the\n      histogram. I’ll explain when we get there.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb102\"\n      data-caption=\"Imports and filter updates in App.js\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb102-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb102-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> MedianLine <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/MedianLine&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb102-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb102-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb102-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Controls <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Controls&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb102-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb102-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb102-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb102-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb102-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb102-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">medianIncomes</span><span class=\"op\" style=\"color: #666666;\">:</span> []<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb102-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb102-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">salariesFilter</span><span class=\"op\" style=\"color: #666666;\">:</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb102-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb102-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">filteredBy</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb102-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb102-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb102-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb102-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb102-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb102-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb102-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb102-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    updateDataFilter <span class=\"op\" style=\"color: #666666;\">=</span> (filter<span class=\"op\" style=\"color: #666666;\">,</span> filteredBy) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb102-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb102-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">salariesFilter</span><span class=\"op\" style=\"color: #666666;\">:</span> filter<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb102-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">filteredBy</span><span class=\"op\" style=\"color: #666666;\">:</span> filteredBy</a>\n<a class=\"sourceLine\" id=\"cb102-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb102-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb102-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb102-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb102-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb102-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb102-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb102-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We import the\n      <code style=\"white-space: pre-wrap;\">Controls</code> component and add a\n      default\n      <code style=\"white-space: pre-wrap;\">salariesFilter</code> function to\n      <code style=\"white-space: pre-wrap;\">this.state</code>. The\n      <code style=\"white-space: pre-wrap;\">updateDataFilter</code> method\n      passes the filter function and\n      <code style=\"white-space: pre-wrap;\">filteredBy</code> dictionary from\n      arguments to App state. We’ll use it as a callback in\n      <code style=\"white-space: pre-wrap;\">Controls</code>.\n    </p>\n    <p>The rest of filtering setup happens in the render method.</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb103\"\n      data-caption=\"Filtering data and updating map zoom in App render\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb103-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb103-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb103-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb103-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb103-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb103-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb103-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Delete the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb103-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> filteredSalaries <span class=\"op\" style=\"color: #666666;\">=</span> techSalaries</a>\n<a class=\"sourceLine\" id=\"cb103-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb103-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb103-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> filteredSalaries <span class=\"op\" style=\"color: #666666;\">=</span> techSalaries</a>\n<a class=\"sourceLine\" id=\"cb103-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                     .<span class=\"at\" style=\"color: #7d9029;\">filter</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">salariesFilter</span>)</a>\n<a class=\"sourceLine\" id=\"cb103-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb103-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb103-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb103-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb103-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> zoom <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb103-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            medianHousehold <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb103-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb103-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"va\" style=\"color: #19177c;\">filteredBy</span>.<span class=\"at\" style=\"color: #7d9029;\">USstate</span> <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;*&#39;</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb103-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            zoom <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"va\" style=\"color: #19177c;\">filteredBy</span>.<span class=\"at\" style=\"color: #7d9029;\">USstate</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb103-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            medianHousehold <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">mean</span>(medianIncomesByUSState[zoom]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb103-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                      d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">medianIncome</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb103-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb103-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb103-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb103-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb103-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb103-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We add a <code style=\"white-space: pre-wrap;\">.filter</code> call to\n      <code style=\"white-space: pre-wrap;\">filteredSalaries</code>, which uses\n      our <code style=\"white-space: pre-wrap;\">salariesFilter</code> method to\n      throw out anything that doesn’t fit. Then we set up\n      <code style=\"white-space: pre-wrap;\">zoom</code>, if a US state was\n      selected.\n    </p>\n    <p>\n      We built the\n      <code style=\"white-space: pre-wrap;\">CountyMap</code> component to focus\n      on a given US state. Finding the centroid of a polygon, re-centering the\n      map, and increasing the sizing factor. It creates a nice zoom effect.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/zoom-effect.png\"\n        alt=\"Zoom effect\"\n      />\n      <figcaption>Zoom effect</figcaption>\n    </figure>\n    <p>\n      And here’s the downside of this approach. SVG doesn’t know about element\n      boundaries. It just renders stuff.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/zoom-without-rectangle.png\"\n        alt=\"Zoom without white rectangle\"\n      />\n      <figcaption>Zoom without white rectangle</figcaption>\n    </figure>\n    <p>\n      See, it goes under the histogram. Let’s fix that and add the\n      <code style=\"white-space: pre-wrap;\">Controls</code> render while we’re\n      at it.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb104\"\n      data-caption=\"Add opaque background to histogram\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb104-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb104-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb104-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb104-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb104-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb104-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb104-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb104-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb104-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>div <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//...&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb104-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//...&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb104-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">&lt;</span>CountyMap <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//... /&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb104-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb104-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb104-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">&lt;</span>rect x<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;500&quot;</span> y<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;0&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb104-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                          width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;600&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb104-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                          height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;500&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb104-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                          style<span class=\"op\" style=\"color: #666666;\">={{</span><span class=\"dt\">fill</span><span class=\"op\">:</span> <span class=\"st\">&#39;white&#39;</span><span class=\"op\">}}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb104-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb104-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb104-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">&lt;</span>Histogram <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//... /&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb104-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">&lt;</span>MedianLine <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//.. /&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb104-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb104-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb104-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb104-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>Controls data<span class=\"op\" style=\"color: #666666;\">={</span>techSalaries<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb104-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                          updateDataFilter<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateDataFilter</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb104-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb104-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb104-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )</a>\n<a class=\"sourceLine\" id=\"cb104-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb104-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Rectangle, <code style=\"white-space: pre-wrap;\">500</code> to the right,\n      <code style=\"white-space: pre-wrap;\">0</code> from top,\n      <code style=\"white-space: pre-wrap;\">600</code> wide and\n      <code style=\"white-space: pre-wrap;\">500</code> tall, with a white\n      background. Gives the histogram an opaque background, so it doesn’t\n      matter what the map is doing.\n    </p>\n    <p>\n      We render the\n      <code style=\"white-space: pre-wrap;\">Controls</code> component just after\n      <code style=\"white-space: pre-wrap;\">&lt;/svg&gt;</code> because it’s not\n      an SVG component – it uses normal HTML. Unlike other components, it needs\n      our entire dataset as <code style=\"white-space: pre-wrap;\">data</code>.\n      We use the\n      <code style=\"white-space: pre-wrap;\">updateDataFilter</code> prop to say\n      which callback function it should call when a new filter is ready.\n    </p>\n    <p>\n      If this seems roundabout … I’ve seen worse. The callbacks approach makes\n      our app easier to componentize and keeps the code relatively unmessy.\n      Imagine putting everything we’ve done so far in\n      <code style=\"white-space: pre-wrap;\">App</code>! 😆\n    </p>"
        },
        {
          "lectureTitle": "Step 2: Build Controls component",
          "lectureBody": "    <h2 id=\"step-2-build-controls-component\">\n      Step 2: Build Controls component\n    </h2>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">Controls</code> component builds\n      our filter function and\n      <code style=\"white-space: pre-wrap;\">filteredBy</code> dictionary based\n      on user choices.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">Controls</code> renders 3 rows of\n      buttons and builds filtering out of the choice made on each row. That\n      makes <code style=\"white-space: pre-wrap;\">Controls</code> kind of\n      repetitive, but that’s okay.\n    </p>\n    <p>\n      To keep this book shorter, we’re going to build everything for a\n      <code style=\"white-space: pre-wrap;\">year</code> filter first. Then I’ll\n      explain how to add\n      <code style=\"white-space: pre-wrap;\">USstate</code> and\n      <code style=\"white-space: pre-wrap;\">jobTitle</code> filters on a higher\n      level. Once you have one working, the rest follows that same pattern.\n    </p>\n    <p>\n      Make a <code style=\"white-space: pre-wrap;\">Controls</code> directory in\n      <code style=\"white-space: pre-wrap;\">src/components/</code> and let’s\n      begin. The main\n      <code style=\"white-space: pre-wrap;\">Controls</code> component goes in\n      your <code style=\"white-space: pre-wrap;\">index.js</code> file.\n    </p>\n    <h3 id=\"stub-controls\">Stub Controls</h3>\n    <div\n      class=\"sourceCode\"\n      id=\"cb105\"\n      data-caption=\"Controls stubbed for year filter\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb105-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb105-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb105-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb105-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> ControlRow <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;./ControlRow&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb105-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb105-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Controls <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb105-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb105-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">yearFilter</span><span class=\"op\" style=\"color: #666666;\">:</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb105-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">year</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb105-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb105-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb105-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb105-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb105-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb105-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb105-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    updateYearFilter <span class=\"op\" style=\"color: #666666;\">=</span> (year<span class=\"op\" style=\"color: #666666;\">,</span> reset) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb105-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> filter <span class=\"op\" style=\"color: #666666;\">=</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"va\" style=\"color: #19177c;\">submit_date</span>.<span class=\"at\" style=\"color: #7d9029;\">getFullYear</span>() <span class=\"op\" style=\"color: #666666;\">===</span> year<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb105-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb105-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (reset <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"op\" style=\"color: #666666;\">!</span>year) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb105-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            filter <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb105-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            year <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb105-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb105-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb105-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(</a>\n<a class=\"sourceLine\" id=\"cb105-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb105-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">yearFilter</span><span class=\"op\" style=\"color: #666666;\">:</span> filter<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb105-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">year</span><span class=\"op\" style=\"color: #666666;\">:</span> year</a>\n<a class=\"sourceLine\" id=\"cb105-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb105-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">reportUpdateUpTheChain</span>()</a>\n<a class=\"sourceLine\" id=\"cb105-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb105-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb105-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb105-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb105-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> data <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb105-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb105-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb105-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb105-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Controls<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We start with some imports and a\n      <code style=\"white-space: pre-wrap;\">Controls</code> class-based\n      component. Inside, we define default\n      <code style=\"white-space: pre-wrap;\">state</code> with an always-true\n      <code style=\"white-space: pre-wrap;\">yearFilter</code> and an asterisk\n      for <code style=\"white-space: pre-wrap;\">year</code>.\n    </p>\n    <p>\n      We also need an\n      <code style=\"white-space: pre-wrap;\">updateYearFilter</code> function,\n      which we’ll use to update the filter, a\n      <code style=\"white-space: pre-wrap;\">reportUpdateUpTheChain</code>\n      function, and a\n      <code style=\"white-space: pre-wrap;\">render</code> method. We’re using\n      <code style=\"white-space: pre-wrap;\">reportUpdateUpTheChain</code> to\n      bubble updates to our parent component. It’s a simpler alternative to\n      using React Context or a state management library.\n    </p>\n    <h3 id=\"filter-logic\">Filter logic</h3>\n    <div\n      class=\"sourceCode\"\n      id=\"cb106\"\n      data-caption=\"year filtering logic in Controls\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb106-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb106-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Controls <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb106-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb106-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    updateYearFilter <span class=\"op\" style=\"color: #666666;\">=</span> (year<span class=\"op\" style=\"color: #666666;\">,</span> reset) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb106-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> filter <span class=\"op\" style=\"color: #666666;\">=</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"va\" style=\"color: #19177c;\">submit_date</span>.<span class=\"at\" style=\"color: #7d9029;\">getFullYear</span>() <span class=\"op\" style=\"color: #666666;\">===</span> year<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb106-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb106-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (reset <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"op\" style=\"color: #666666;\">!</span>year) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb106-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            filter <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb106-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            year <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb106-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb106-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb106-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(</a>\n<a class=\"sourceLine\" id=\"cb106-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb106-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">yearFilter</span><span class=\"op\" style=\"color: #666666;\">:</span> filter<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb106-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">year</span><span class=\"op\" style=\"color: #666666;\">:</span> year</a>\n<a class=\"sourceLine\" id=\"cb106-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb106-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">reportUpdateUpTheChain</span>()</a>\n<a class=\"sourceLine\" id=\"cb106-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb106-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb106-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      <code style=\"white-space: pre-wrap;\">updateYearFilter</code> is a\n      callback we pass into\n      <code style=\"white-space: pre-wrap;\">ControlRow</code>. When a user picks\n      a year, their action triggers this function.\n    </p>\n    <p>\n      When that happens, we create a new partial filter function. The\n      <code style=\"white-space: pre-wrap;\">App</code> component uses it inside\n      a <code style=\"white-space: pre-wrap;\">.filter</code> call like you saw\n      earlier. We have to return\n      <code style=\"white-space: pre-wrap;\">true</code> for elements we want to\n      keep and <code style=\"white-space: pre-wrap;\">false</code> for elements\n      we don’t.\n    </p>\n    <p>\n      Comparing\n      <code style=\"white-space: pre-wrap;\">submit_date.getFullYear()</code>\n      with <code style=\"white-space: pre-wrap;\">year</code> achieves that.\n    </p>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">reset</code> argument lets us\n      reset filters back to defaults. Enables users to unselect options.\n    </p>\n    <p>\n      When we have the <code style=\"white-space: pre-wrap;\">year</code> and\n      <code style=\"white-space: pre-wrap;\">filter</code>, we update component\n      state with <code style=\"white-space: pre-wrap;\">this.setState</code>.\n      This triggers a re-render and calls\n      <code style=\"white-space: pre-wrap;\">reportUpdateUpTheChain</code>\n      afterwards. Great use-case for the little known setState callback 😃\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">reportUpdateUpTheChain</code> then\n      calls\n      <code style=\"white-space: pre-wrap;\">this.props.updateDataFilter</code>,\n      which is a callback method on\n      <code style=\"white-space: pre-wrap;\">App</code>. We defined it earlier –\n      it needs a new filter method and a\n      <code style=\"white-space: pre-wrap;\">filteredBy</code> dictionary.\n    </p>\n    <pre\n      data-caption=\"reportUpdateUpTheChain method\"\n    ><code style=\"white-space: pre-wrap;\">// src/components/Controls/index.js\nclass Controls extends React.Component {\n    // ...\n    reportUpdateUpTheChain() {\n        window.location.hash = [\n            this.state.year || &quot;*&quot;\n        ].join(&quot;-&quot😉;\n\n        this.props.updateDataFilter(\n            (filters =&gt; {\n                return d =&gt;\n                    filters.yearFilter(d)\n            })(this.state),\n            {\n                year: this.state.year\n            }\n        );\n    }\n}</code></pre>\n    <p>\n      Building the filter method looks tricky because we’re composing multiple\n      functions. The new arrow function takes a dictionary of filters as an\n      argument and returns a new function that\n      <code style=\"white-space: pre-wrap;\">&amp;&amp;</code>s them all. We\n      invoke it immediately with\n      <code style=\"white-space: pre-wrap;\">this.state</code> as the argument.\n    </p>\n    <p>\n      It looks silly when there’s just one filter, but I promise it makes\n      sense.\n    </p>\n    <h3 id=\"render-2\">Render</h3>\n    <p>\n      Great, we have the filter logic. Let’s render those rows of controls\n      we’ve been talking about.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb108\"\n      data-caption=\"Render the year ControlRow\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb108-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb108-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Controls <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb108-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb108-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb108-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> data <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb108-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb108-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> years <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Set</span>(<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"va\" style=\"color: #19177c;\">submit_date</span>.<span class=\"at\" style=\"color: #7d9029;\">getFullYear</span>()))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb108-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb108-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb108-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb108-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>ControlRow</a>\n<a class=\"sourceLine\" id=\"cb108-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb108-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    toggleNames<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"va\" style=\"color: #19177c;\">Array</span>.<span class=\"at\" style=\"color: #7d9029;\">from</span>(<span class=\"va\" style=\"color: #19177c;\">years</span>.<span class=\"at\" style=\"color: #7d9029;\">values</span>())<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb108-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    picked<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">year</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb108-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    updateDataFilter<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateYearFilter</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb108-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                /&gt;</a>\n<a class=\"sourceLine\" id=\"cb108-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb108-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb108-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb108-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Once more, this is generalized code used for a single example: the\n      <code style=\"white-space: pre-wrap;\">year</code> filter.\n    </p>\n    <p>\n      We build a <code style=\"white-space: pre-wrap;\">Set</code> of distinct\n      years in our dataset, then render a\n      <code style=\"white-space: pre-wrap;\">ControlRow</code> using props to\n      give it our <code style=\"white-space: pre-wrap;\">data</code>, a set of\n      <code style=\"white-space: pre-wrap;\">toggleNames</code>, a callback to\n      update the filter, and which entry is\n      <code style=\"white-space: pre-wrap;\">picked</code> right now. Also known\n      as the controlled component pattern, it enables us to maintain the\n      data-flows-down, events-bubble-up architecture.\n    </p>\n    <p>\n      If you don’t know about <code style=\"white-space: pre-wrap;\">Set</code>s,\n      they’re an ES6 data structure that ensures every entry is unique. Just\n      like a mathematical set. They’re pretty fast.\n    </p>"
        },
        {
          "lectureTitle": "Step 3: Build ControlRow component",
          "lectureBody": "    <h2 id=\"step-3-build-controlrow-component\">\n      Step 3: Build ControlRow component\n    </h2>\n    <p>\n      Let’s build the\n      <code style=\"white-space: pre-wrap;\">ControlRow</code> component. It\n      renders a row of controls and ensures only one at a time is selected.\n    </p>\n    <p>We’ll start with a stub and go from there.</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb109\"\n      data-caption=\"ControlRow stub\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb109-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/ControlRow.js</span></a>\n<a class=\"sourceLine\" id=\"cb109-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb109-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb109-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Toggle <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;./Toggle&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb109-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb109-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> ControlRow <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb109-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    makePick <span class=\"op\" style=\"color: #666666;\">=</span> (picked<span class=\"op\" style=\"color: #666666;\">,</span> newState) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb109-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb109-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb109-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb109-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">_addToggle</span>(name) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb109-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb109-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb109-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb109-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> toggleNames <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb109-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb109-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb109-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb109-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> ControlRow<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We start with imports, big surprise, then make a stub with 3 methods. Can\n      you guess what they are?\n    </p>\n    <ul>\n      <li>\n        <code style=\"white-space: pre-wrap;\">makePick</code> is the\n        <code style=\"white-space: pre-wrap;\">Toggle</code> click callback\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">_addToggle</code> is a rendering\n        helper method\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">render</code> renders a row of\n        buttons\n      </li>\n    </ul>\n    <div\n      class=\"sourceCode\"\n      id=\"cb110\"\n      data-caption=\"makePick implementation\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb110-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/ControlRow.js</span></a>\n<a class=\"sourceLine\" id=\"cb110-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb110-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> ControlRow <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb110-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    makePick <span class=\"op\" style=\"color: #666666;\">=</span> (picked<span class=\"op\" style=\"color: #666666;\">,</span> newState) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb110-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// if newState is false, we want to reset</span></a>\n<a class=\"sourceLine\" id=\"cb110-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">updateDataFilter</span>(picked<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">!</span>newState)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb110-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      <code style=\"white-space: pre-wrap;\">makePick</code> calls the data\n      filter update and passes in the new value and whether we want to\n      unselect. Pretty simple right?\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb111\"\n      data-caption=\"Render a row of controls\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb111-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/ControlRow.js</span></a>\n<a class=\"sourceLine\" id=\"cb111-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> ControlRow <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb111-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb111-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb111-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">_addToggle</span>(name) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb111-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> key <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"vs\" style=\"color: #4070a0;\">`toggle-</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>name<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">`</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb111-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            label <span class=\"op\" style=\"color: #666666;\">=</span> name<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb111-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb111-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">capitalize</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb111-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            label <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">label</span>.<span class=\"at\" style=\"color: #7d9029;\">toUpperCase</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb111-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb111-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb111-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb111-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>Toggle</a>\n<a class=\"sourceLine\" id=\"cb111-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                label<span class=\"op\" style=\"color: #666666;\">={</span>label<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb111-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                name<span class=\"op\" style=\"color: #666666;\">={</span>name<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb111-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                key<span class=\"op\" style=\"color: #666666;\">={</span>key<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb111-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                value<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">picked</span> <span class=\"op\" style=\"color: #666666;\">===</span> name<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb111-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                onClick<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">makePick</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb111-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            /&gt;</a>\n<a class=\"sourceLine\" id=\"cb111-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb111-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb111-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb111-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb111-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> toggleNames <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb111-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb111-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb111-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;row&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb111-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;col-md-12&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb111-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">toggleNames</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(name <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">_addToggle</span>(name))<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb111-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb111-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb111-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb111-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb111-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Rendering comes in two functions:\n      <code style=\"white-space: pre-wrap;\">_addToggle</code>, which is a\n      helper, and <code style=\"white-space: pre-wrap;\">render</code>, which is\n      the main render.\n    </p>\n    <p>\n      In <code style=\"white-space: pre-wrap;\">render</code>, we set up two\n      <code style=\"white-space: pre-wrap;\">div</code>s with Bootstrap classes.\n      The first is a <code style=\"white-space: pre-wrap;\">row</code>, and the\n      second is a full-width column. I tried using a column for each button,\n      but it was annoying to manage and used too much space.\n    </p>\n    <p>\n      Inside the divs, we map over all toggles and use\n      <code style=\"white-space: pre-wrap;\">_addToggle</code> to render each of\n      them.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">_addToggle</code> renders a\n      <code style=\"white-space: pre-wrap;\">Toggle</code> component with a\n      <code style=\"white-space: pre-wrap;\">label</code>,\n      <code style=\"white-space: pre-wrap;\">name</code>,\n      <code style=\"white-space: pre-wrap;\">value</code> and\n      <code style=\"white-space: pre-wrap;\">onClick</code> callback. The label\n      is just a prettier version of the name, which also serves as a key in our\n      <code style=\"white-space: pre-wrap;\">toggleValues</code> dictionary. It’s\n      going to be the\n      <code style=\"white-space: pre-wrap;\">picked</code> attribute in\n      <code style=\"white-space: pre-wrap;\">makePick</code>.\n    </p>\n    <p>\n      Your browser should continue showing an error, but it should change to\n      talking about the\n      <code style=\"white-space: pre-wrap;\">Toggle</code> component instead of\n      <code style=\"white-space: pre-wrap;\">ControlRow</code>.\n    </p>\n    <p>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/toggle-error.png\"\n      />\n    </p>\n    <p>Let’s build it.</p>"
        },
        {
          "lectureTitle": "Step 4: Build Toggle component",
          "lectureBody": "    <h2 id=\"step-4-build-toggle-component\">Step 4: Build Toggle component</h2>\n    <p>\n      Last piece of the puzzle – the Toggle component. A button that turns on\n      and off.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb112\"\n      data-caption=\"Toggle component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb112-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/Toggle.js</span></a>\n<a class=\"sourceLine\" id=\"cb112-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb112-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb112-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Toggle <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span> label<span class=\"op\" style=\"color: #666666;\">,</span> name<span class=\"op\" style=\"color: #666666;\">,</span> value<span class=\"op\" style=\"color: #666666;\">,</span> onClick <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb112-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> className <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;btn btn-default&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb112-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb112-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (value) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb112-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        className <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot; btn-primary&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb112-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb112-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb112-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb112-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>button className<span class=\"op\" style=\"color: #666666;\">={</span>className<span class=\"op\" style=\"color: #666666;\">}</span> onClick<span class=\"op\" style=\"color: #666666;\">={</span>() <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"at\" style=\"color: #7d9029;\">onClick</span>(name<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">!</span>value)<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb112-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span>label<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb112-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/button<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb112-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb112-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb112-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb112-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Toggle<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Import React to enable JSX and make a functional\n      <code style=\"white-space: pre-wrap;\">Toggle</code> component. It’s fully\n      controlled and takes event handlers as callbacks in props. No need for a\n      class.\n    </p>\n    <p>\n      We set up a Bootstrap classname:\n      <code style=\"white-space: pre-wrap;\">btn</code> and\n      <code style=\"white-space: pre-wrap;\">btn-default</code> make an element\n      look like a button, the conditional\n      <code style=\"white-space: pre-wrap;\">btn-primary</code> makes it blue. If\n      you’re not familiar with Bootstrap classes, you should check\n      <a href=\"https://getbootstrap.com/\">their documentation</a>.\n    </p>\n    <p>\n      Then we render a\n      <code style=\"white-space: pre-wrap;\">&lt;button&gt;</code> tag and, well,\n      that’s it. A row of year filters appears in the browser.\n      <code style=\"white-space: pre-wrap;\">onClick</code> passes\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/year-filter-row.png\"\n        alt=\"A row of year filters\"\n      />\n      <figcaption>A row of year filters</figcaption>\n    </figure>\n    <p>\n      Click on a button and the\n      <code style=\"white-space: pre-wrap;\">onClick</code> handler passes a\n      toggle’d value to its parent via the\n      <code style=\"white-space: pre-wrap;\">onClick</code> callback. This\n      triggers an update in\n      <code style=\"white-space: pre-wrap;\">Controls</code>, which calls\n      <code style=\"white-space: pre-wrap;\">reportUpdateUpTheChain</code>, which\n      in turn updates state in\n      <code style=\"white-space: pre-wrap;\">App</code> and re-renders our button\n      with the new value toggling its color on or off.\n    </p>\n    <p>\n      If that didn’t work, consult this\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/a45c33e172297ca1bbcfdc76733eae75779ebd7f\"\n        >diff on GitHub</a\n      >.\n    </p>"
        },
        {
          "lectureTitle": "Step 5: Add US state and Job Title filters",
          "lectureBody": "    <h2 id=\"step-5-add-us-state-and-job-title-filters\">\n      Step 5: Add US state and Job Title filters\n    </h2>\n    <p>\n      With all that done, we can add two more filters: US states and job\n      titles. Our <code style=\"white-space: pre-wrap;\">App</code> component is\n      already set up to use them, so we just have to add them to the\n      <code style=\"white-space: pre-wrap;\">Controls</code> component.\n    </p>\n    <p>\n      We’ll start with the\n      <code style=\"white-space: pre-wrap;\">render</code> method, then handle\n      the parts I said earlier would look repetitive.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb113\"\n      data-caption=\"Adding two more rows to Controls\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb113-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb113-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Controls <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb113-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb113-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb113-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> data <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb113-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb113-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> years <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Set</span>(<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"va\" style=\"color: #19177c;\">submit_date</span>.<span class=\"at\" style=\"color: #7d9029;\">getFullYear</span>()))<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb113-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb113-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              jobTitles <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Set</span>(<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">clean_job_title</span>))<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb113-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              USstates <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Set</span>(<span class=\"va\" style=\"color: #19177c;\">data</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">USstate</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb113-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb113-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb113-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb113-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb113-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>ControlRow data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            toggleNames<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"va\" style=\"color: #19177c;\">Array</span>.<span class=\"at\" style=\"color: #7d9029;\">from</span>(<span class=\"va\" style=\"color: #19177c;\">years</span>.<span class=\"at\" style=\"color: #7d9029;\">values</span>())<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            picked<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">year</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            updateDataFilter<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateYearFilter</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            /&gt;</a>\n<a class=\"sourceLine\" id=\"cb113-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb113-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb113-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>ControlRow data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            toggleNames<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"va\" style=\"color: #19177c;\">Array</span>.<span class=\"at\" style=\"color: #7d9029;\">from</span>(<span class=\"va\" style=\"color: #19177c;\">jobTitles</span>.<span class=\"at\" style=\"color: #7d9029;\">values</span>())<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            picked<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">jobTitle</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            updateDataFilter<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateJobTitleFilter</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb113-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb113-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>ControlRow data<span class=\"op\" style=\"color: #666666;\">={</span>data<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            toggleNames<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"va\" style=\"color: #19177c;\">Array</span>.<span class=\"at\" style=\"color: #7d9029;\">from</span>(<span class=\"va\" style=\"color: #19177c;\">USstates</span>.<span class=\"at\" style=\"color: #7d9029;\">values</span>())<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            picked<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">USstate</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            updateDataFilter<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateUSstateFilter</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                            capitalize<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;true&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb113-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb113-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb113-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )</a>\n<a class=\"sourceLine\" id=\"cb113-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb113-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>Ok, this part is plenty repetitive, too.</p>\n    <p>\n      We created new sets for\n      <code style=\"white-space: pre-wrap;\">jobTitles</code> and\n      <code style=\"white-space: pre-wrap;\">USstates</code>, then rendered two\n      more <code style=\"white-space: pre-wrap;\">ControlRow</code> elements with\n      appropriate attributes. They get\n      <code style=\"white-space: pre-wrap;\">toggleNames</code> for building the\n      buttons, <code style=\"white-space: pre-wrap;\">picked</code> to know which\n      is active, an\n      <code style=\"white-space: pre-wrap;\">updateDataFilter</code> callback,\n      and we tell US states to render capitalized.\n    </p>\n    <p>\n      The implementations of those\n      <code style=\"white-space: pre-wrap;\">updateDataFilter</code> callbacks\n      follow the same pattern as\n      <code style=\"white-space: pre-wrap;\">updateYearFilter</code>.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb114\"\n      data-caption=\"new updateDataFilter callbacks\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb114-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb114-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb114-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Controls <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb114-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb114-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">yearFilter</span><span class=\"op\" style=\"color: #666666;\">:</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb114-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">jobTitleFilter</span><span class=\"op\" style=\"color: #666666;\">:</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb114-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">USstateFilter</span><span class=\"op\" style=\"color: #666666;\">:</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb114-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">year</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb114-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">USstate</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb114-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">jobTitle</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb114-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb114-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb114-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    updateJobTitleFilter <span class=\"op\" style=\"color: #666666;\">=</span> (title<span class=\"op\" style=\"color: #666666;\">,</span> reset) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb114-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> filter <span class=\"op\" style=\"color: #666666;\">=</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">clean_job_title</span> <span class=\"op\" style=\"color: #666666;\">===</span> title<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb114-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb114-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (reset <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"op\" style=\"color: #666666;\">!</span>title) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb114-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            filter <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb114-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            title <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb114-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb114-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb114-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(</a>\n<a class=\"sourceLine\" id=\"cb114-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb114-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">jobTitleFilter</span><span class=\"op\" style=\"color: #666666;\">:</span> filter<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb114-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">jobTitle</span><span class=\"op\" style=\"color: #666666;\">:</span> title</a>\n<a class=\"sourceLine\" id=\"cb114-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb114-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">reportUpdateUpTheChain</span>()</a>\n<a class=\"sourceLine\" id=\"cb114-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb114-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb114-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb114-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    updateUSstateFilter <span class=\"op\" style=\"color: #666666;\">=</span> (USstate<span class=\"op\" style=\"color: #666666;\">,</span> reset) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb114-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> filter <span class=\"op\" style=\"color: #666666;\">=</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">USstate</span> <span class=\"op\" style=\"color: #666666;\">===</span> USstate<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb114-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb114-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (reset <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"op\" style=\"color: #666666;\">!</span>USstate) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb114-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            filter <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb114-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            USstate <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb114-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb114-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb114-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(</a>\n<a class=\"sourceLine\" id=\"cb114-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb114-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">USstateFilter</span><span class=\"op\" style=\"color: #666666;\">:</span> filter<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb114-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">USstate</span><span class=\"op\" style=\"color: #666666;\">:</span> USstate</a>\n<a class=\"sourceLine\" id=\"cb114-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb114-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">reportUpdateUpTheChain</span>()</a>\n<a class=\"sourceLine\" id=\"cb114-44\" title=\"44\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb114-45\" title=\"45\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb114-46\" title=\"46\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb114-47\" title=\"47\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb114-48\" title=\"48\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb114-49\" title=\"49\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb114-50\" title=\"50\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Controls<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Yes, they’re basically the same as\n      <code style=\"white-space: pre-wrap;\">updateYearFilter</code>. The only\n      difference is a changed\n      <code style=\"white-space: pre-wrap;\">filter</code> function and using\n      different keys in <code style=\"white-space: pre-wrap;\">setState()</code>.\n    </p>\n    <p>\n      Why separate functions then? No need to get fancy. It would’ve made the\n      code harder to read.\n    </p>\n    <p>\n      Our last step is to add these new keys to the\n      <code style=\"white-space: pre-wrap;\">reportUpdateUpTheChain</code>\n      function.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb115\"\n      data-caption=\"Add new filters to main state update\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb115-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb115-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb115-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Controls <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb115-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">reportUpdateUpTheChain</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb115-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">updateDataFilter</span>(</a>\n<a class=\"sourceLine\" id=\"cb115-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            (filters <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb115-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb115-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"va\" style=\"color: #19177c;\">filters</span>.<span class=\"at\" style=\"color: #7d9029;\">yearFilter</span>(d) <span class=\"op\" style=\"color: #666666;\">&amp;&amp;</span></a>\n<a class=\"sourceLine\" id=\"cb115-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"va\" style=\"color: #19177c;\">filters</span>.<span class=\"at\" style=\"color: #7d9029;\">jobTitleFilter</span>(d) <span class=\"op\" style=\"color: #666666;\">&amp;&amp;</span></a>\n<a class=\"sourceLine\" id=\"cb115-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"va\" style=\"color: #19177c;\">filters</span>.<span class=\"at\" style=\"color: #7d9029;\">USstateFilter</span>(d)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb115-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span>)(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb115-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb115-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">USstate</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">USstate</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb115-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">year</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">year</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb115-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">jobTitle</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">jobTitle</span></a>\n<a class=\"sourceLine\" id=\"cb115-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb115-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb115-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We add them to the filter condition with\n      <code style=\"white-space: pre-wrap;\">&amp;&amp;</code> and expand the\n      <code style=\"white-space: pre-wrap;\">filteredBy</code> argument.\n    </p>\n    <p>Two more rows of filters show up.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/all-filters.png\"\n        alt=\"All the filters\"\n      />\n      <figcaption>All the filters</figcaption>\n    </figure>\n    <p>👏</p>\n    <p>\n      Again, if it didn’t work, consult\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/a45c33e172297ca1bbcfdc76733eae75779ebd7f\"\n        >the diff on GitHub</a\n      >.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Make it work in the real world",
      "lectures": [
        {
          "lectureTitle": "Add rudimentary routing",
          "lectureBody": "    <h1 id=\"rudimentary-routing\">Rudimentary routing</h1>\n    <p>\n      Imagine this. A user finds your dataviz, clicks around, and finds an\n      interesting insight. They share it with their friends.\n    </p>\n    <p><em>“See! I was right! This link proves it.”</em></p>\n    <p><em>“Wtf are you talking about?”</em></p>\n    <p>\n      <em\n        >“Oh… uuuuh… you have to click this and then that and then you’ll see.\n        I’m legit winning our argument.”</em\n      >\n    </p>\n    <p><em>“Wow! Kim Kardashian just posted a new snap with her dog.”</em></p>\n    <p>\n      Let’s help our intrepid user out and make our dataviz linkable. We should\n      store the current\n      <code style=\"white-space: pre-wrap;\">filteredBy</code> state in the URL\n      and be able to restore from a link.\n    </p>\n    <p>\n      There are many ways to achieve this.\n      <a href=\"https://github.com/ReactTraining/react-router\">ReactRouter</a>\n      comes to mind, but the quickest is to implement our own rudimentary\n      routing. We’ll add some logic to manipulate and read the URL hash.\n    </p>\n    <p>\n      The easiest place to put this logic is next to the existing filter logic\n      inside the\n      <code style=\"white-space: pre-wrap;\">Controls</code> component. Better\n      places exist from a “low-down components shouldn’t play with global\n      state” perspective, but that’s okay.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb116\"\n      data-caption=\"Add rudimentary routing\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb116-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Controls/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb116-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb116-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Controls <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb116-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb116-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb116-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb116-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> [year<span class=\"op\" style=\"color: #666666;\">,</span> USstate<span class=\"op\" style=\"color: #666666;\">,</span> jobTitle] <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">window</span>.<span class=\"va\" style=\"color: #19177c;\">location</span>.<span class=\"at\" style=\"color: #7d9029;\">hash</span></a>\n<a class=\"sourceLine\" id=\"cb116-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">replace</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;#&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;&quot;</span>)</a>\n<a class=\"sourceLine\" id=\"cb116-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">split</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;-&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb116-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb116-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (year <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span> <span class=\"op\" style=\"color: #666666;\">&amp;&amp;</span> year) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb116-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateYearFilter</span>(<span class=\"at\" style=\"color: #7d9029;\">Number</span>(year))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb116-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb116-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (USstate <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span> <span class=\"op\" style=\"color: #666666;\">&amp;&amp;</span> USstate) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb116-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateUSstateFilter</span>(USstate)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb116-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb116-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (jobTitle <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span> <span class=\"op\" style=\"color: #666666;\">&amp;&amp;</span> jobTitle) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb116-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateJobTitleFilter</span>(jobTitle)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb116-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb116-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb116-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb116-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb116-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">reportUpdateUpTheChain</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb116-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">window</span>.<span class=\"va\" style=\"color: #19177c;\">location</span>.<span class=\"at\" style=\"color: #7d9029;\">hash</span> <span class=\"op\" style=\"color: #666666;\">=</span> [</a>\n<a class=\"sourceLine\" id=\"cb116-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">year</span> <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb116-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">USstate</span> <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb116-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">jobTitle</span> <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;*&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb116-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        ].<span class=\"at\" style=\"color: #7d9029;\">join</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;-&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb116-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb116-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb116-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We use the\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> lifecycle\n      hook to read the URL when\n      <code style=\"white-space: pre-wrap;\">Controls</code> first render on our\n      page. Presumably when the page loads, but it could be later. It doesn’t\n      really matter <em>when</em>, just that we update our filter the first\n      chance we get.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">window.location.hash</code> gives us\n      the hash part of the URL. We clean it up and split it into three parts:\n      <code style=\"white-space: pre-wrap;\">year</code>,\n      <code style=\"white-space: pre-wrap;\">USstate</code>, and\n      <code style=\"white-space: pre-wrap;\">jobTitle</code>. If the URL is\n      <code style=\"white-space: pre-wrap;\"\n        >localhost:3000/#2013-CA-manager</code\n      >, then <code style=\"white-space: pre-wrap;\">year</code> becomes\n      <code style=\"white-space: pre-wrap;\">2013</code>,\n      <code style=\"white-space: pre-wrap;\">USstate</code> becomes\n      <code style=\"white-space: pre-wrap;\">CA</code>, and\n      <code style=\"white-space: pre-wrap;\">jobTitle</code> becomes\n      <code style=\"white-space: pre-wrap;\">manager</code>.\n    </p>\n    <p>\n      We make sure each value is valid and use our existing filter update\n      callbacks to update the visualization. Just as if it was the user\n      clicking a button.\n    </p>\n    <p>\n      In <code style=\"white-space: pre-wrap;\">reportUpdateUpTheChain</code>, we\n      make sure to update the URL hash. Assigning a new value to\n      <code style=\"white-space: pre-wrap;\">window.location.hash</code> takes\n      care of that.\n    </p>\n    <p>You should see the URL changing as you click around.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/changing-url.png\"\n        alt=\"Changing URL hash\"\n      />\n      <figcaption>Changing URL hash</figcaption>\n    </figure>\n    <p>\n      There’s a bug with some combinations in 2013 that don’t have enough data.\n      It will go away when we use the full dataset.\n    </p>\n    <p>\n      If it doesn’t work at all, consult the\n      <a\n        href=\"https://github.com/Swizec/react-d3js-step-by-step/commit/2e8fb070cbee5f1e942be8ea42fa87c6c0379a9b\"\n        >diff on Github</a\n      >.\n    </p>"
        },
        {
          "lectureTitle": "Prep your app for launch",
          "lectureBody": "    <h1 id=\"prep-for-launch\">Prep for launch</h1>\n    <p>\n      You’ve built a great visualization. Congratz! Time to put it online and\n      share with the world.\n    </p>\n    <p>\n      To do that, we’re going to use Github Pages because our app is a\n      glorified static website. There’s no backend, so all we need is something\n      to serve our HTML, JavaScript, and CSV. Github Pages is perfect for that.\n    </p>\n    <p>\n      It’s free, works well with\n      <code style=\"white-space: pre-wrap;\">create-react-app</code>, and can\n      withstand a lot of traffic. You don’t want to worry about traffic when\n      your app gets to the top of HackerNews or Reddit.\n    </p>\n    <p>There are a few things we should take care of:</p>\n    <ul>\n      <li>setting up deployment</li>\n      <li>adding a page title</li>\n      <li>adding some copy</li>\n      <li>Twitter and Facebook cards</li>\n      <li>an SEO tweak for search engines</li>\n      <li>use the full dataset</li>\n    </ul>\n    <h2 id=\"setting-up-deployment\">Setting up deployment</h2>\n    <p>\n      You’ll need a Github repository. If you’re like me, writing all this code\n      without version control or off-site backup made you nervous, so you\n      already have one.\n    </p>\n    <p>\n      For everyone else, head over to Github, click the green\n      <code style=\"white-space: pre-wrap;\">New Repository</code> button and\n      give it a name. Then copy the commands it gives you and run them in your\n      console.\n    </p>\n    <p>It should be something like this:</p>\n    <pre\n      data-caption=\"Put code on github\"\n    ><code style=\"white-space: pre-wrap;\">$ git init\n$ git commit -m &quot;My entire dataviz&quot;\n$ git remote add origin git://github ...\n$ git push origin -u master</code></pre>\n    <p>\n      If you’ve been git-ing locally without pushing, then you only need the\n      <code style=\"white-space: pre-wrap;\">git remote add</code> and\n      <code style=\"white-space: pre-wrap;\">git push origin</code> commands.\n      This puts your code on Github. Great idea for anything you don’t want to\n      lose if your computer craps out.\n    </p>\n    <p>\n      Every Github repository comes with an optional Github Pages setup. The\n      easiest way for us to use it is with the\n      <code style=\"white-space: pre-wrap;\">gh-pages</code> npm module.\n    </p>\n    <p>Install it with this command:</p>\n    <pre\n      data-caption=\"Install gh-pages helper\"\n    ><code style=\"white-space: pre-wrap;\">$ npm install --save-dev gh-pages</code></pre>\n    <p>Add two lines to package.json:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb119\"\n      data-caption=\"Update package.json\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode json\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode json\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb119-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">//</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">package.json</span></a>\n<a class=\"sourceLine\" id=\"cb119-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">//</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">Insert</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">the</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">line(s)</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">between</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">here...</span></a>\n<a class=\"sourceLine\" id=\"cb119-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">&quot;homepage&quot;:</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">&quot;https://&lt;your</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">username&gt;.github.io/&lt;your</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">repo</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">name&gt;&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb119-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">//</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">...and</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">here.</span></a>\n<a class=\"sourceLine\" id=\"cb119-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">&quot;scripts&quot;:</span> <span class=\"fu\" style=\"color: #06287e;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb119-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"dt\" style=\"color: #902000;\">&quot;eject&quot;</span><span class=\"fu\" style=\"color: #06287e;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react-scripts eject&quot;</span><span class=\"fu\" style=\"color: #06287e;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb119-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">//</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">Insert</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">the</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">line(s)</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">between</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">here...</span></a>\n<a class=\"sourceLine\" id=\"cb119-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"dt\" style=\"color: #902000;\">&quot;deploy&quot;</span><span class=\"fu\" style=\"color: #06287e;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;npm run build &amp;&amp; gh-pages -d build&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb119-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">//</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">...and</span> <span class=\"er\" style=\"color: #ff0000; font-weight: bold;\">here.</span></a>\n<a class=\"sourceLine\" id=\"cb119-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"fu\" style=\"color: #06287e;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We’ve been ignoring the\n      <code style=\"white-space: pre-wrap;\">package.json</code> file so far, but\n      it’s a pretty important file. It specifies all of our project’s\n      dependencies, meta data for npm, and scripts that we run locally. This is\n      where <code style=\"white-space: pre-wrap;\">npm start</code> is defined,\n      for instance.\n    </p>\n    <p>\n      We add a <code style=\"white-space: pre-wrap;\">deploy</code> script that\n      runs <code style=\"white-space: pre-wrap;\">build</code> and a\n      <code style=\"white-space: pre-wrap;\">gh-pages</code> deploy, and we\n      specify a <code style=\"white-space: pre-wrap;\">homepage</code> URL. The\n      URL tells our build script how to set up URLs for static files in\n      <code style=\"white-space: pre-wrap;\">index.html</code>.\n    </p>\n    <p>Github Pages URLs follow the schema:</p>\n    <pre><code style=\"white-space: pre-wrap;\">https://&lt;your username&gt;.github.io/&lt;your repo name&gt;</code></pre>\n    <p>For instance, mine is:</p>\n    <pre><code style=\"white-space: pre-wrap;\">https://swizec.github.io/react-d3js-step-by-step</code></pre>\n    <p>Yours will be different.</p>\n    <p>\n      You can deploy with\n      <code style=\"white-space: pre-wrap;\">npm run deploy</code>. Make sure all\n      changes are committed. We’ll do it together when we’re done setting up.\n    </p>"
        },
        {
          "lectureTitle": "Twitter and Facebook cards and SEO",
          "lectureBody": "    <h2 id=\"twitter-and-facebook-cards-and-seo\">\n      Twitter and Facebook cards and SEO\n    </h2>\n    <p>\n      How your visualization looks on social media matters more than you’d\n      think. Does it have a nice picture, a great description, and a title, or\n      does it look like a random URL? Those things matter.\n    </p>\n    <p>And they’re easy to set up. No excuse.</p>\n    <p>\n      We’re going to poke around\n      <code style=\"white-space: pre-wrap;\">public/index.html</code> for the\n      first time. Add titles, Twitter cards, Facebook Open Graph things, and so\n      on.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb122\"\n      data-caption=\"Basic SEO\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode html\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode html\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb122-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">&lt;!-- public/index.html --&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;head&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">&lt;!-- //... --&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    // Insert the line(s) between here...</a>\n<a class=\"sourceLine\" id=\"cb122-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;title&gt;</span>How much does an H1B in tech pay?<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/title&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb122-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;link</span><span class=\"ot\" style=\"color: #007020;\"> rel=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;canonical&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb122-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"ot\" style=\"color: #007020;\">          href=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;https://swizec.github.io/react-d3js-step-by-step/&quot;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">/&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    // ...and here.</a>\n<a class=\"sourceLine\" id=\"cb122-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/head&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;body&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">&lt;!-- //... --&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;div</span><span class=\"ot\" style=\"color: #007020;\"> id=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;root&quot;</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        // Insert the line(s) between here...</a>\n<a class=\"sourceLine\" id=\"cb122-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">         <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;h2&gt;</span>The average H1B in tech pays $86,164/year<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/h2&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb122-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">   <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt😜</span><span class=\"ot\" style=\"color: #007020;\"> class=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;lead&quot;</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             Since 2012 the US tech industry has sponsored 176,075</a>\n<a class=\"sourceLine\" id=\"cb122-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             H1B work visas. Most of them paid <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;b&gt;</span>$60,660 to $111,668<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/b&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             per year (1 standard deviation). <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;span&gt;</span>The best city for</a>\n<a class=\"sourceLine\" id=\"cb122-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             an H1B is <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;b&gt;</span>Kirkland, WA<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/b&gt;</span> with an average individual</a>\n<a class=\"sourceLine\" id=\"cb122-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             salary <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;b&gt;</span>$39,465 above local household median<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/b&gt;</span>.</a>\n<a class=\"sourceLine\" id=\"cb122-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             Median household salary is a good proxy for cost of</a>\n<a class=\"sourceLine\" id=\"cb122-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             living in an area.<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/span&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">         <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/p&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        // ...and here.</a>\n<a class=\"sourceLine\" id=\"cb122-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/div&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb122-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">&lt;/body&gt;</span></a></code></pre>\n    </div>\n    <p>\n      We add a <code style=\"white-space: pre-wrap;\">&lt;title&gt;</code> and a\n      <code style=\"white-space: pre-wrap;\">canonical</code> URL. Titles\n      configure what shows up in browser tabs, and the canonical URL is there\n      to tell search engines that this is the main and most important URL for\n      this piece of content. This is especially important for when people\n      copy-paste your stuff and put it on other websites.\n    </p>\n    <p>\n      In the body root tag, we add some copy-pasted text from our dataviz.\n      You’ll recognize the default title and description.\n    </p>\n    <p>\n      As soon as React loads, these get overwritten with our preloader, but\n      it’s good to have them here for any search engines that aren’t running\n      JavaScript yet. I think both Google and Bing are capable of running our\n      React app and getting text from there, but you never know.\n    </p>\n    <p>\n      To make social media embeds look great, we’ll use\n      <a href=\"https://dev.twitter.com/cards/types/summary-large-image\"\n        >Twitter card</a\n      >\n      and\n      <a href=\"https://developers.facebook.com/docs/sharing/webmasters\"\n        >Facebook OpenGraph</a\n      >\n      meta tags. I think most other websites just rely on these since most\n      people use them. They go in the\n      <code style=\"white-space: pre-wrap;\">&lt;head&gt;</code> of our HTML.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb123\"\n      data-caption=\"Add FB and Twitter cards\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb123-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">&lt;!--</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">public</span><span class=\"ss\" style=\"color: #bb6688;\">/index.html --&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb123-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"ss\" style=\"color: #bb6688;\">&lt;head&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb123-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"ss\" style=\"color: #bb6688;\">    &lt;meta property=&quot;og:locale&quot; content=&quot;en_US&quot; /</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb123-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta property<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;og:type&quot;</span> content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;article&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta property<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;og:title&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb123-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;The average H1B in tech pays $86,164/year&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta property<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;og:description&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb123-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;Since 2012 the US tech industry has sponsored</span></a>\n<a class=\"sourceLine\" id=\"cb123-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"dv\" style=\"color: #40a070;\">176</span><span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">075</span> H1B work <span class=\"va\" style=\"color: #19177c;\">visas</span>. <span class=\"at\" style=\"color: #7d9029;\">With</span> an average individual salary</a>\n<a class=\"sourceLine\" id=\"cb123-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">up to $39<span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">465</span> above median household <span class=\"va\" style=\"color: #19177c;\">income</span>.<span class=\"st\" style=\"color: #4070a0;\">&quot; /&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb123-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta property<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;og:url&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb123-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;https://swizec.github.io/react-d3js-step-by-step&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta property<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;og:site_name&quot;</span> content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;A geek with a hat&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta property<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;article:publisher&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb123-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;https://facebook.com/swizecpage&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta property<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;fb:admins&quot;</span> content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;624156314&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta property<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;og:image&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb123-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;https://swizec.github.io/react-d3js-step-by-step/thumbnail.png&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb123-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta name<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;twitter:card&quot;</span> content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;summary_large_image&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta name<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;twitter:description&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb123-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;Since 2012 the US tech industry has sponsored</span></a>\n<a class=\"sourceLine\" id=\"cb123-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"dv\" style=\"color: #40a070;\">176</span><span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">075</span> H1B work <span class=\"va\" style=\"color: #19177c;\">visas</span>. <span class=\"at\" style=\"color: #7d9029;\">With</span> an average individual salary</a>\n<a class=\"sourceLine\" id=\"cb123-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">up to $39<span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">465</span> above median household <span class=\"va\" style=\"color: #19177c;\">income</span>.<span class=\"st\" style=\"color: #4070a0;\">&quot; /&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb123-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta name<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;twitter:title&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb123-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;The average H1B in tech pays $86,164/year&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta name<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;twitter:site&quot;</span> content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;@swizec&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta name<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;twitter:image&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb123-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;https://swizec.github.io/react-d3js-step-by-step/thumbnail.png&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>meta name<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;twitter:creator&quot;</span> content<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;@swizec&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb123-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">&lt;/head<span class=\"op\" style=\"color: #666666;\">&gt;</span></a></code></pre>\n    </div>\n    <p>\n      Much of this code is repetitive. Both Twitter and Facebook want the same\n      info, but they’re stubborn and won’t read each other’s formats. You can\n      copy all of this, but make sure to change\n      <code style=\"white-space: pre-wrap;\">og:url</code>,\n      <code style=\"white-space: pre-wrap;\">og:site_name</code>,\n      <code style=\"white-space: pre-wrap;\">article:publisher</code>,\n      <code style=\"white-space: pre-wrap;\">fb:admins</code>,\n      <code style=\"white-space: pre-wrap;\">og:image</code>,\n      <code style=\"white-space: pre-wrap;\">twitter:site</code>,\n      <code style=\"white-space: pre-wrap;\">twitter:image</code>, and\n      <code style=\"white-space: pre-wrap;\">twitter:creator</code>. They’re\n      specific to you.\n    </p>\n    <p>\n      The URLs you should change to the\n      <code style=\"white-space: pre-wrap;\">homepage</code> URL you used above.\n      The rest you should change to use your name and Twitter/Facebook handles.\n      I’m not sure <em>why</em> it matters, but I’m sure it does.\n    </p>\n    <p>\n      An important one is <code style=\"white-space: pre-wrap;\">fb:admin</code>.\n      It enables admin features on your site if you add their social plugins.\n      If you don’t, it probably doesn’t matter.\n    </p>\n    <p>\n      You’re also going to need a thumbnail image. I made mine by taking a\n      screenshot of the final visualization, then I put it in\n      <code style=\"white-space: pre-wrap;\">public/thumbnail.png</code>.\n    </p>\n    <p>\n      Now when somebody shares your dataviz on Twitter or Facebook, it’s going\n      to look something like this:\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/twitter-card.png\"\n        alt=\"Dataviz Twitter card\"\n      />\n      <figcaption>Dataviz Twitter card</figcaption>\n    </figure>"
        },
        {
          "lectureTitle": "Use full dataset",
          "lectureBody": "    <h2 id=\"full-dataset\">Full dataset</h2>\n    <p>One more step left. Use the whole dataset!</p>\n    <p>\n      Go into\n      <code style=\"white-space: pre-wrap;\">src/DataHandling.js</code> and\n      change one line:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb124\"\n      data-caption=\"Switch to full dataset\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb124-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Example 4</span></a>\n<a class=\"sourceLine\" id=\"cb124-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//</span></a>\n<a class=\"sourceLine\" id=\"cb124-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/DataHandling.js</span></a>\n<a class=\"sourceLine\" id=\"cb124-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> loadAllData <span class=\"op\" style=\"color: #666666;\">=</span> (callback <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">_</span>.<span class=\"at\" style=\"color: #7d9029;\">noop</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb124-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">queue</span>()</a>\n<a class=\"sourceLine\" id=\"cb124-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb124-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Delete the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb124-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">defer</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">csv</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;data/h1bs-2012-2016-shortened.csv&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> cleanSalary)</a>\n<a class=\"sourceLine\" id=\"cb124-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a>\n<a class=\"sourceLine\" id=\"cb124-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Insert the line(s) between here...</span></a>\n<a class=\"sourceLine\" id=\"cb124-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        .<span class=\"at\" style=\"color: #7d9029;\">defer</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">csv</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;data/h1bs-2012-2016.csv&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> cleanSalary)</a>\n<a class=\"sourceLine\" id=\"cb124-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...and here.</span></a></code></pre>\n    </div>\n    <p>\n      We change the file name, and that’s that. Full dataset locked and loaded.\n      Dataviz ready to go.\n    </p>"
        },
        {
          "lectureTitle": "Launch! 🚀",
          "lectureBody": "    <h1 id=\"launch\">Launch!</h1>\n    <p>\n      To show your dataviz to the world, make sure you’ve committed all\n      changes. Using\n      <code style=\"white-space: pre-wrap;\">git status</code> shows you anything\n      you missed.\n    </p>\n    <p>Then run:</p>\n    <pre><code style=\"white-space: pre-wrap;\">$ npm run deploy</code></pre>\n    <p>You’ll see a bunch of output:</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/npm-run-deploy.png\"\n        alt=\"Deploy output\"\n      />\n      <figcaption>Deploy output</figcaption>\n    </figure>\n    <p>\n      And you’re ready to go. Your visualization is online. My URL is\n      <code style=\"white-space: pre-wrap;\"\n        >https://swizec.github.io/react-d3js-step-by-step/</code\n      >, yours is different. Visit it and you’ll see what you’ve built. Share\n      it and others will see it too.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/deployed-dataviz.png\"\n        alt=\"Deployed dataviz\"\n      />\n      <figcaption>Deployed dataviz</figcaption>\n    </figure>\n    <p>\n      Congratz! You’ve built and deployed your first React and D3 dataviz.\n      You’re amazing \\o/\n    </p>\n    <p>\n      Thanks for following along with the meaty part of my book. You’re now\n      well equipped to build cool things.\n    </p>\n    <p>In the next section, we’re going to look at building animations.</p>"
        }
      ]
    },
    {
      "sectionTitle": "Animation",
      "lectures": [
        {
          "lectureTitle": "Intro",
          "lectureBody": "    <h1 id=\"animation\">Animation</h1>\n    <p>\n      Welcome to the animation section. This is where the real fun begins.\n      Demos that look cool, impress your friends, and sound good at the dinner\n      table.\n    </p>\n    <p>At my dinner table at least …</p>\n    <p>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/puking-rainbows.png\"\n      />\n    </p>\n    <p>\n      You already know how React and D3 work together, so these examples are\n      going to go faster. You know that we’re using React for rendering SVG and\n      D3 for calculating props. You know how to make your dataviz interactive\n      and how to handle oodles of data.\n    </p>\n    <p>\n      Now you’re going to learn how to make it dance. Smooth transitions\n      between states, complex animations, interacting with users in real-time.\n      60 frames per second, baby!\n    </p>\n    <p>Animation looks like this in a nutshell:</p>\n    <ul>\n      <li>render something</li>\n      <li>change it 60 times per second</li>\n    </ul>\n    <p>\n      When that happens humans perceive smooth motion. You can go as low as 24\n      frames per second, like old TVs used to, but that often looks jaggeddy on\n      modern monitors.\n    </p>\n    <p>\n      You’re about to learn two different approaches to building these\n      animations. Using game loops and using transitions.\n    </p>\n    <ol type=\"1\">\n      <li>Game loops give you more control</li>\n      <li>Transitions are easier to implement</li>\n    </ol>\n    <p>\n      We’re starting with an example or two in CodeSandbox, then building some\n      bigger stuff. No more big huge projects like the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6888870#salary-visualization\"\n        >tech salary visualization</a\n      >, though. Takes too long to set up and doesn’t focus on animation.\n    </p>"
        },
        {
          "lectureTitle": "Using a game loop for rich animation",
          "lectureBody": "    <h1 id=\"game-loop\">Using a game loop for rich animation</h1>\n    <p>\n      Game loops are fun! They’re my favorite. They even sound fun: “game\n      loop”. Doesn’t it sound fun to go build a game loop? Maybe it’s because\n      I’ve always used game loops when building something fun to play with.\n    </p>\n    <p>\n      At its core, a game loop is an infinite loop where each iteration renders\n      the next frame of your animation.\n    </p>\n    <p>\n      The concept comes from the video game industry. At some point they\n      realized that building game engines is much easier when you think about\n      each frame as its own static representation of your game state.\n    </p>\n    <p>\n      You take every object in the game and render it. Then you throw it all\n      away, make small adjustments, and render again.\n    </p>\n    <p>\n      This turns out to be both faster to run and easier to implement than\n      diffing scenes and figuring out what moves and what doesn’t. Of course as\n      you get more objects on the screen it becomes silly to re-render the\n      immovable background every time.\n    </p>\n    <p>But you don’t have to worry about that. That’s React’s job.</p>\n    <p>\n      React can figure out a diff between hierarchical representations of your\n      scene and re-render the appropriate objects.\n    </p>\n    <p>That’s a hard engineering problem, but you can think of it this way:</p>\n    <ol type=\"1\">\n      <li>Render a DOM from state</li>\n      <li>Change some values in state</li>\n      <li>Trigger a re-render</li>\n    </ol>\n    <p>\n      Make those state changes fast enough and you get 60 frames per second.\n      The hard part then becomes thinking about your movement as snapshots in\n      time.\n    </p>\n    <p>\n      When something speeds up, what does that mean for changes in its\n      position?\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "A bouncy ball game loop example",
      "lectures": [
        {
          "lectureTitle": "Begin bouncy ball",
          "lectureBody": "    <h2 id=\"a-bouncing-ball-game-loop-example\">\n      A bouncing ball game loop example\n    </h2>\n    <p>\n      Let’s get our feet wet with my favorite childhood example: a bouncing\n      ball.\n    </p>\n    <p>\n      I must have built dozens of them back in my\n      <a href=\"https://en.wikipedia.org/wiki/Turbo_Pascal\">Turbo Pascal</a>\n      days using\n      <a href=\"https://en.wikipedia.org/wiki/Borland_Graphics_Interface\">BGI</a\n      >. Endless afternoons playing with different parameters in my bouncy ball\n      examples.\n    </p>\n    <p>\n      Yes, those Turbo Pascal and BGI are from the 80’s. No, I’m not that old.\n      I started young and with old equipment. Coding for DOS is easier when\n      you’re a kid than coding for Windows 95.\n    </p>\n    <p>Here is a screenshot of our bouncing ball:</p>\n    <figure>\n      <img\n        alt=\"Bouncing Ball\"\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQEAAADWCAYAAADRoDfeAAAKCGlDQ1BJQ0MgUHJvZmlsZQAASImFlndUVNcWxs+90xtthqH33jsMIL036VVUhgGGOsJQxY4EFYgoIiKgBCRUBaOhxoKIYiEIKGBBM0gQUJ7BAqigvAskMcl7670966zzW9/s8909Z/64HwAkd2ZiYjwsAEACJ4Xr42QrGxQcIosbBxCAAR0AoMBkJSfaeHm5Iwz+2P9eCyNIN1L3tVa9/vP7/1mCEZHJLAAgL4QZrERuCsIHEfZLT0lc5TGEaVxkKITnVpm9xjB6lcPXWXStx8/HDmFNAPBkJpPLBoDIQHTZNBYb8SEGIazLiYjhILzqb8mKZkYgfAthzaj41AyE36/2JCRsQ3SSIsKq4X/xZP/NP/xPfyaT/ScnxKeyfv9dqzdCjuT4+yK7OLIkQRTQBvEgFWQAWZAIuGAbosQgSiRy9//9HGPtnB3SmQi2IydiABtEgxTkvONfvHzXnFJAOmAiPZGI4o587Fb/x3XLd/Q1V4h+56uW1AWAaS4isr9qTAUAOl4AQF34qim8RcY5AsDlAVYqN21dW716gAFEwA9oQAxIAwWgCrSAPjAG5sAaOABX4An8QDDYAljIvAnIVOlgJ9gHckAeOAKOg1JQAc6AOnAOXABt4BK4Bm6Cu2AADIMngAcmwSswBxbAEgRBOIgCUSExSAZSgjQgfYgBWUIOkDvkAwVDYRAb4kCp0E5oP5QHFUKlUCVUD/0AdUDXoNvQIPQIGodmoLfQJxgFk2EaLAUrwzowA7aB3WA/eDPMhpPgTDgbPgyXwFXwWbgVvgbfhYdhHvwKnkcBFAlFR8mhtFAMlB3KExWCikJxUbtRuahiVBWqCdWJ6kXdR/FQs6iPaCyaipZFa6HN0c5ofzQLnYTejc5Hl6Lr0K3oHvR99Dh6Dv0FQ8FIYjQwZhgXTBCGjUnH5GCKMTWYFswNzDBmErOAxWLpWBWsCdYZG4yNxe7A5mNPYZuxXdhB7AR2HofDieE0cBY4TxwTl4LLwZ3EncVdxQ3hJnEf8CS8DF4f74gPwXPwWfhifAP+Cn4IP4VfIggQlAhmBE9CBGE7oYBQTegk3CNMEpaIgkQVogXRjxhL3EcsITYRbxDHiO9IJJI8yZTkTYoh7SWVkM6TbpHGSR/JQmR1sh05lJxKPkyuJXeRH5HfUSgUZYo1JYSSQjlMqadcpzyjfOCj8mnzufBF8O3hK+Nr5Rvie81P4Ffit+Hfwp/JX8x/kf8e/6wAQUBZwE6AKbBboEygQ2BUYF6QKqgn6CmYIJgv2CB4W3BaCCekLOQgFCGULXRG6LrQBBVFVaDaUVnU/dRq6g3qJA1LU6G50GJpebRztH7anLCQsKFwgHCGcJnwZWEeHUVXprvQ4+kF9Av0EfonESkRG5FIkUMiTSJDIouiEqLWopGiuaLNosOin8RkxRzE4sSOirWJPRVHi6uLe4uni58WvyE+K0GTMJdgSeRKXJB4LAlLqkv6SO6QPCPZJzkvJS3lJJUodVLqutSsNF3aWjpWukj6ivSMDFXGUiZGpkjmqsxLWWFZG9l42RLZHtk5OUk5Z7lUuUq5frkleRV5f/ks+Wb5pwpEBYZClEKRQrfCnKKMoofiTsVGxcdKBCWGUrTSCaVepUVlFeVA5QPKbcrTKqIqLiqZKo0qY6oUVSvVJNUq1QdqWDWGWpzaKbUBdVjdSD1avUz9ngasYawRo3FKY1ATo2mqydGs0hzVImvZaKVpNWqNa9O13bWztNu0X+so6oToHNXp1fmia6Qbr1ut+0RPSM9VL0uvU++tvro+S79M/4EBxcDRYI9Bu8EbQw3DSMPThg+NqEYeRgeMuo0+G5sYc42bjGdMFE3CTMpNRhk0hhcjn3HLFGNqa7rH9JLpRzNjsxSzC2a/mWuZx5k3mE9vUNkQuaF6w4SFvAXTotKCZylrGWb5nSXPSs6KaVVl9dxawTrCusZ6ykbNJtbmrM1rW11brm2L7aKdmd0uuy57lL2Tfa59v4OQg79DqcMzR3lHtmOj45yTkdMOpy5njLOb81HnURcpF5ZLvcucq4nrLtceN7Kbr1up23N3dXeue6cH7OHqccxjbKPSRs7GNk/g6eJ5zPOpl4pXktdP3lhvL+8y7xc+ej47fXp9qb5bfRt8F/xs/Qr8nvir+qf6dwfwB4QG1AcsBtoHFgbygnSCdgXdDRYPjgluD8GFBITUhMxvcth0fNNkqFFoTujIZpXNGZtvbxHfEr/l8lb+rcytF8MwYYFhDWHLTE9mFXM+3CW8PHyOZcc6wXoVYR1RFDETaRFZGDkVZRFVGDXNtmAfY89EW0UXR8/G2MWUxryJdY6tiF2M84yrjVuJD4xvTsAnhCV0cIQ4cZyebdLbMrYNJmok5iTyksySjifNcd24NclQ8ubk9hQa8vLsS1VN/SZ1PM0yrSztQ3pA+sUMwQxORt929e2Htk9lOmZ+vwO9g7Wje6fczn07x3fZ7KrcDe0O3929R2FP9p7JvU576/YR98Xt+zlLN6sw6/3+wP2d2VLZe7MnvnH6pjGHL4ebM3rA/EDFQfTBmIP9hwwOnTz0JTci906ebl5x3nI+K//Ot3rflny7cjjqcH+BccHpI9gjnCMjR62O1hUKFmYWThzzONZaJFuUW/T++Nbjt4sNiytOEE+knuCVuJe0n1Q8eeTkcml06XCZbVlzuWT5ofLFUxGnhk5bn26qkKrIq/j0Xcx3DyudKlurlKuKz2DPpJ15UR1Q3fs94/v6GvGavJrPtZxaXp1PXU+9SX19g2RDQSPcmNo4czb07MA5+3PtTVpNlc305rzz4Hzq+Zc/hP0wcsHtQvdFxsWmH5V+LG+htuS2Qq3bW+faott47cHtgx2uHd2d5p0tP2n/VHtJ7lLZZeHLBVeIV7KvrFzNvDrfldg1e419baJ7a/eT60HXH/R49/TfcLtx66bjzeu9Nr1Xb1ncunTb7HbHHcadtrvGd1v7jPpafjb6uaXfuL/1nsm99gHTgc7BDYNXhqyGrt23v3/zgcuDu8MbhwdH/EcejoaO8h5GPJx+FP/ozeO0x0tP9o5hxnKfCjwtfib5rOoXtV+aeca8y+P2433PfZ8/mWBNvPo1+dflyewXlBfFUzJT9dP605dmHGcGXm56Ofkq8dXSbM6/BP9V/lr19Y+/Wf/WNxc0N/mG+2blbf47sXe17w3fd897zT9bSFhYWsz9IPah7iPjY++nwE9TS+nLuOWSz2qfO7+4fRlbSVhZSWRymWtRAIUsOCoKgLe1AFCCkewwgGQhvvXM9Xuegf6SbP5g8HnoKy9vW89la2UMQK01AP57AXBHMsppZCkhTEb21YjoZw1gA4M/1++VHGWgv/4MMheJJh9WVt5JAYDrRJ7DXVlZOrWy8rkaGfYRAF1J/3e2f/B6HlwtLJKSC1Xo4viVPjIB/LP+DYgVvxTNfraPAAABnWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4yNTc8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MjE0PC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CrQ8pN4AAAbsSURBVHgB7drtTZxXFIXRIUohphOoxFCJoRLcCdAJnTh+LVmxgsiAtaNoa6/5k8gmV/ese/QEf1x8+/45+RAgMCvwx+zkBidA4IeACFgEAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYn8GcjwcvLy+nr16+n5+fnH9f/9OnT6cuXL6fjnz4ECHxM4OLb98/H/pP/96ufnp5O19fXry5xBODz58+nu7u7Vz/nBwgQeFugKgLHdwCXl5dvTnOE4PHx0XcEbwr5CQKvBap+T+D+/v71BL/8yBGJ29vbX37EvxIgcE6gKgLHLwXOfY4Q+BAg8H6Bql8OXFxcvGuyst/meNdMvojAfyVQ9Z3A1dXVWYebm5uzX+MLCBD4W6AqAsfv/p/7vOdrzp3h5wksCVRF4Pi//L/9n/74TuE93y0sPbBZCZwTqIrAMczDw8OPvxj062DHHw0ef1no+ONBHwIEPiZQ9RuD/xzt+JOAIwA+BAj8vkB1BH5/bP8lAQI/Bep+OfDz4v5JgEBGQAQyjk4hUCsgArVP5+IEMgIikHF0CoFaARGofToXJ5AREIGMo1MI1AqIQO3TuTiBjIAIZBydQqBWQARqn87FCWQERCDj6BQCtQIiUPt0Lk4gIyACGUenEKgVEIHap3NxAhkBEcg4OoVArYAI1D6dixPICIhAxtEpBGoFRKD26VycQEZABDKOTiFQKyACtU/n4gQyAiKQcXQKgVoBEah9OhcnkBEQgYyjUwjUCohA7dO5OIGMgAhkHJ1CoFZABGqfzsUJZAREIOPoFAK1AiJQ+3QuTiAjIAIZR6cQqBUQgdqnc3ECGQERyDg6hUCtgAjUPp2LE8gIiEDG0SkEagVEoPbpXJxARkAEMo5OIVArIAK1T+fiBDICIpBxdAqBWgERqH06FyeQERCBjKNTCNQKiEDt07k4gYyACGQcnUKgVkAEap/OxQlkBEQg4+gUArUCIlD7dC5OICMgAhlHpxCoFRCB2qdzcQIZARHIODqFQK2ACNQ+nYsTyAiIQMbRKQRqBUSg9ulcnEBGQAQyjk4hUCsgArVP5+IEMgIikHF0CoFaARGofToXJ5AREIGMo1MI1AqIQO3TuTiBjIAIZBydQqBWQARqn87FCWQERCDj6BQCtQIiUPt0Lk4gIyACGUenEKgVEIHap3NxAhkBEcg4OoVArYAI1D6dixPICIhAxtEpBGoFRKD26VycQEZABDKOTiFQKyACtU/n4gQyAiKQcXQKgVoBEah9OhcnkBEQgYyjUwjUCohA7dO5OIGMgAhkHJ1CoFZABGqfzsUJZAREIOPoFAK1AiJQ+3QuTiAjIAIZR6cQqBUQgdqnc3ECGQERyDg6hUCtwF8dFE4FdPS5tAAAAABJRU5ErkJggg==\"\n      />\n      <figcaption>Bouncing Ball</figcaption>\n    </figure>\n    <p>\n      Exciting, isn’t it? Took me five tries to catch it. Future examples will\n      look better as screenshots, I promise.\n    </p>\n    <p>\n      I suggest you follow along on CodeSandbox. Here’s one I prepared for you\n      earlier: <a href=\"https://codesandbox.io/s/rrwz67jl04\">click me</a>\n    </p>"
        },
        {
          "lectureTitle": "Step 1: stub out App and Ball",
          "lectureBody": "    <h3 id=\"step-1-stub-out-app-and-ball\">Step 1: stub out App and Ball</h3>\n    <p>\n      We start with a skeleton: An\n      <code style=\"white-space: pre-wrap;\">App</code> component rendering a\n      <code style=\"white-space: pre-wrap;\">BouncingBall</code> component inside\n      an SVG, and a <code style=\"white-space: pre-wrap;\">Ball</code> component.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb126\"\n      data-caption=\"App component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb126-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// index.js</span></a>\n<a class=\"sourceLine\" id=\"cb126-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb126-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> render <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react-dom&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb126-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb126-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> BouncingBall <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;./BouncingBall&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb126-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb126-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> App <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb126-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb126-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;800&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;600&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb126-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>BouncingBall max_h<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">600</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb126-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb126-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb126-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb126-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb126-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">render</span>(<span class=\"op\" style=\"color: #666666;\">&lt;</span>App /<span class=\"op\" style=\"color: #666666;\">&gt;,</span> <span class=\"va\" style=\"color: #19177c;\">document</span>.<span class=\"at\" style=\"color: #7d9029;\">getElementById</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;root&quot;</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      App imports dependencies, imports\n      <code style=\"white-space: pre-wrap;\">BouncingBall</code>, renders it all\n      into a <code style=\"white-space: pre-wrap;\">root</code> DOM node.\n      CodeSandbox gives us most of this code by default.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb127\"\n      data-caption=\"Ball component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb127-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Ball.js</span></a>\n<a class=\"sourceLine\" id=\"cb127-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb127-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb127-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Ball <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>circle cx<span class=\"op\" style=\"color: #666666;\">={</span>x<span class=\"op\" style=\"color: #666666;\">}</span> cy<span class=\"op\" style=\"color: #666666;\">={</span>y<span class=\"op\" style=\"color: #666666;\">}</span> r<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;5&quot;</span> /&gt;<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb127-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb127-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Ball<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We’re calling it a ball, but eh it’s a just a circle. You can make this\n      more fun if you want. Right now it’s a black SVG circle that renders at a\n      specified <code style=\"white-space: pre-wrap;\">x, y</code> coordinate\n      with a radius of <code style=\"white-space: pre-wrap;\">5</code> pixels.\n    </p>\n    <p>\n      It’s these coordinates that we’re going to play with to make the ball\n      drop and bounce. Each time, React is going to re-render and move our ball\n      to its new coordinates. Because we change them so quickly, it looks like\n      the ball is animated. You’ll see.\n    </p>\n    <hr />\n    <p>\n      Those are the boring components. The animation game loop fun happens in\n      <code style=\"white-space: pre-wrap;\">BouncingBall</code>.\n    </p>"
        },
        {
          "lectureTitle": "Stub out BouncingBall",
          "lectureBody": "    <h3 id=\"step-2-stub-out-bouncingball\">Step 2: Stub out BouncingBall</h3>\n    <p>\n      We encapsulate everything in this component so that\n      <code style=\"white-space: pre-wrap;\">App</code> doesn’t have to know\n      about the details of our animation. App declaratively renders a bouncing\n      ball and that’s it.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb128\"\n      data-caption=\"BouncingBall component stub\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb128-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> Component <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb128-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb128-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb128-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> BouncingBall <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb128-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">constructor</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb128-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">super</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb128-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb128-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb128-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb128-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">vy</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span></a>\n<a class=\"sourceLine\" id=\"cb128-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb128-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb128-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb128-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb128-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// start game loop</span></a>\n<a class=\"sourceLine\" id=\"cb128-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">timer</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">timer</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">gameLoop</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb128-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb128-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb128-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">componentWillUnmount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb128-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// stop loop</span></a>\n<a class=\"sourceLine\" id=\"cb128-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">timer</span>.<span class=\"at\" style=\"color: #7d9029;\">stop</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb128-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb128-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb128-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  gameLoop <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb128-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// move ball by vy</span></a>\n<a class=\"sourceLine\" id=\"cb128-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// increase vy to accelerate</span></a>\n<a class=\"sourceLine\" id=\"cb128-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb128-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb128-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb128-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// render Ball at position y</span></a>\n<a class=\"sourceLine\" id=\"cb128-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>g /<span class=\"op\" style=\"color: #666666;\">&gt;;</span></a>\n<a class=\"sourceLine\" id=\"cb128-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb128-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb128-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb128-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> BouncingBall<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>Nothing renders yet and we’re set up to get started.</p>\n    <p>\n      We start with default state: vertical position\n      <code style=\"white-space: pre-wrap;\">y=5</code>, vertical speed\n      <code style=\"white-space: pre-wrap;\">vy😮</code>.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> fires off a\n      d3 timer and\n      <code style=\"white-space: pre-wrap;\">componentWillUnmount</code> stops it\n      so we don’t have unwanted code running in the background. The timer calls\n      <code style=\"white-space: pre-wrap;\">this.gameLoop</code> every 16\n      milliseconds, which translates to about 60 frames per second.\n    </p>\n    <p>\n      D3 timers work like JavaScript’s own\n      <code style=\"white-space: pre-wrap;\">setInterval</code>, but their\n      implementation is more robust. They use\n      <code style=\"white-space: pre-wrap;\">requestAnimationFrame</code> to save\n      computer resources when possible, and default to\n      <code style=\"white-space: pre-wrap;\">setInterval</code> otherwise.\n    </p>\n    <p>\n      Unlike <code style=\"white-space: pre-wrap;\">setInterval</code> timers are\n      also synced so their frames match up, can be restarted, stopped, etc. You\n      should default to favoring\n      <code style=\"white-space: pre-wrap;\">d3.timer</code> over\n      <code style=\"white-space: pre-wrap;\">setInterval</code> or hacking your\n      own\n      <code style=\"white-space: pre-wrap;\">requestAnimationFrame</code>\n      implementation.\n    </p>"
        },
        {
          "lectureTitle": "Step 3: Rendering",
          "lectureBody": "    <h3 id=\"step-3-rendering\">Step 3: Rendering</h3>\n    <p>\n      To render our Ball we have to tweak BouncingBall’s\n      <code style=\"white-space: pre-wrap;\">render</code> method. A small\n      change. Try it yourself first.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb129\"\n      data-caption=\"Render ball\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb129-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// BouncingBall.js</span></a>\n<a class=\"sourceLine\" id=\"cb129-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Ball <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;./Ball&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb129-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb129-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb129-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb129-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb129-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// render Ball at position y</span></a>\n<a class=\"sourceLine\" id=\"cb129-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>g<span class=\"op\" style=\"color: #666666;\">&gt;&lt;</span>Ball x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">10</span><span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;&lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb129-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb129-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Import our <code style=\"white-space: pre-wrap;\">Ball</code> component,\n      render it at <code style=\"white-space: pre-wrap;\">x=10</code> and use\n      <code style=\"white-space: pre-wrap;\">this.state.y</code> for the vertical\n      coordinate.\n    </p>\n    <p>A black ball shows up on your screen. Like this:</p>\n    <figure>\n      <img\n        alt=\"Black ball\"\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQEAAADWCAYAAADRoDfeAAAKCGlDQ1BJQ0MgUHJvZmlsZQAASImFlndUVNcWxs+90xtthqH33jsMIL036VVUhgGGOsJQxY4EFYgoIiKgBCRUBaOhxoKIYiEIKGBBM0gQUJ7BAqigvAskMcl7670966zzW9/s8909Z/64HwAkd2ZiYjwsAEACJ4Xr42QrGxQcIosbBxCAAR0AoMBkJSfaeHm5Iwz+2P9eCyNIN1L3tVa9/vP7/1mCEZHJLAAgL4QZrERuCsIHEfZLT0lc5TGEaVxkKITnVpm9xjB6lcPXWXStx8/HDmFNAPBkJpPLBoDIQHTZNBYb8SEGIazLiYjhILzqb8mKZkYgfAthzaj41AyE36/2JCRsQ3SSIsKq4X/xZP/NP/xPfyaT/ScnxKeyfv9dqzdCjuT4+yK7OLIkQRTQBvEgFWQAWZAIuGAbosQgSiRy9//9HGPtnB3SmQi2IydiABtEgxTkvONfvHzXnFJAOmAiPZGI4o587Fb/x3XLd/Q1V4h+56uW1AWAaS4isr9qTAUAOl4AQF34qim8RcY5AsDlAVYqN21dW716gAFEwA9oQAxIAwWgCrSAPjAG5sAaOABX4An8QDDYAljIvAnIVOlgJ9gHckAeOAKOg1JQAc6AOnAOXABt4BK4Bm6Cu2AADIMngAcmwSswBxbAEgRBOIgCUSExSAZSgjQgfYgBWUIOkDvkAwVDYRAb4kCp0E5oP5QHFUKlUCVUD/0AdUDXoNvQIPQIGodmoLfQJxgFk2EaLAUrwzowA7aB3WA/eDPMhpPgTDgbPgyXwFXwWbgVvgbfhYdhHvwKnkcBFAlFR8mhtFAMlB3KExWCikJxUbtRuahiVBWqCdWJ6kXdR/FQs6iPaCyaipZFa6HN0c5ofzQLnYTejc5Hl6Lr0K3oHvR99Dh6Dv0FQ8FIYjQwZhgXTBCGjUnH5GCKMTWYFswNzDBmErOAxWLpWBWsCdYZG4yNxe7A5mNPYZuxXdhB7AR2HofDieE0cBY4TxwTl4LLwZ3EncVdxQ3hJnEf8CS8DF4f74gPwXPwWfhifAP+Cn4IP4VfIggQlAhmBE9CBGE7oYBQTegk3CNMEpaIgkQVogXRjxhL3EcsITYRbxDHiO9IJJI8yZTkTYoh7SWVkM6TbpHGSR/JQmR1sh05lJxKPkyuJXeRH5HfUSgUZYo1JYSSQjlMqadcpzyjfOCj8mnzufBF8O3hK+Nr5Rvie81P4Ffit+Hfwp/JX8x/kf8e/6wAQUBZwE6AKbBboEygQ2BUYF6QKqgn6CmYIJgv2CB4W3BaCCekLOQgFCGULXRG6LrQBBVFVaDaUVnU/dRq6g3qJA1LU6G50GJpebRztH7anLCQsKFwgHCGcJnwZWEeHUVXprvQ4+kF9Av0EfonESkRG5FIkUMiTSJDIouiEqLWopGiuaLNosOin8RkxRzE4sSOirWJPRVHi6uLe4uni58WvyE+K0GTMJdgSeRKXJB4LAlLqkv6SO6QPCPZJzkvJS3lJJUodVLqutSsNF3aWjpWukj6ivSMDFXGUiZGpkjmqsxLWWFZG9l42RLZHtk5OUk5Z7lUuUq5frkleRV5f/ks+Wb5pwpEBYZClEKRQrfCnKKMoofiTsVGxcdKBCWGUrTSCaVepUVlFeVA5QPKbcrTKqIqLiqZKo0qY6oUVSvVJNUq1QdqWDWGWpzaKbUBdVjdSD1avUz9ngasYawRo3FKY1ATo2mqydGs0hzVImvZaKVpNWqNa9O13bWztNu0X+so6oToHNXp1fmia6Qbr1ut+0RPSM9VL0uvU++tvro+S79M/4EBxcDRYI9Bu8EbQw3DSMPThg+NqEYeRgeMuo0+G5sYc42bjGdMFE3CTMpNRhk0hhcjn3HLFGNqa7rH9JLpRzNjsxSzC2a/mWuZx5k3mE9vUNkQuaF6w4SFvAXTotKCZylrGWb5nSXPSs6KaVVl9dxawTrCusZ6ykbNJtbmrM1rW11brm2L7aKdmd0uuy57lL2Tfa59v4OQg79DqcMzR3lHtmOj45yTkdMOpy5njLOb81HnURcpF5ZLvcucq4nrLtceN7Kbr1up23N3dXeue6cH7OHqccxjbKPSRs7GNk/g6eJ5zPOpl4pXktdP3lhvL+8y7xc+ej47fXp9qb5bfRt8F/xs/Qr8nvir+qf6dwfwB4QG1AcsBtoHFgbygnSCdgXdDRYPjgluD8GFBITUhMxvcth0fNNkqFFoTujIZpXNGZtvbxHfEr/l8lb+rcytF8MwYYFhDWHLTE9mFXM+3CW8PHyOZcc6wXoVYR1RFDETaRFZGDkVZRFVGDXNtmAfY89EW0UXR8/G2MWUxryJdY6tiF2M84yrjVuJD4xvTsAnhCV0cIQ4cZyebdLbMrYNJmok5iTyksySjifNcd24NclQ8ubk9hQa8vLsS1VN/SZ1PM0yrSztQ3pA+sUMwQxORt929e2Htk9lOmZ+vwO9g7Wje6fczn07x3fZ7KrcDe0O3929R2FP9p7JvU576/YR98Xt+zlLN6sw6/3+wP2d2VLZe7MnvnH6pjGHL4ebM3rA/EDFQfTBmIP9hwwOnTz0JTci906ebl5x3nI+K//Ot3rflny7cjjqcH+BccHpI9gjnCMjR62O1hUKFmYWThzzONZaJFuUW/T++Nbjt4sNiytOEE+knuCVuJe0n1Q8eeTkcml06XCZbVlzuWT5ofLFUxGnhk5bn26qkKrIq/j0Xcx3DyudKlurlKuKz2DPpJ15UR1Q3fs94/v6GvGavJrPtZxaXp1PXU+9SX19g2RDQSPcmNo4czb07MA5+3PtTVpNlc305rzz4Hzq+Zc/hP0wcsHtQvdFxsWmH5V+LG+htuS2Qq3bW+faott47cHtgx2uHd2d5p0tP2n/VHtJ7lLZZeHLBVeIV7KvrFzNvDrfldg1e419baJ7a/eT60HXH/R49/TfcLtx66bjzeu9Nr1Xb1ncunTb7HbHHcadtrvGd1v7jPpafjb6uaXfuL/1nsm99gHTgc7BDYNXhqyGrt23v3/zgcuDu8MbhwdH/EcejoaO8h5GPJx+FP/ozeO0x0tP9o5hxnKfCjwtfib5rOoXtV+aeca8y+P2433PfZ8/mWBNvPo1+dflyewXlBfFUzJT9dP605dmHGcGXm56Ofkq8dXSbM6/BP9V/lr19Y+/Wf/WNxc0N/mG+2blbf47sXe17w3fd897zT9bSFhYWsz9IPah7iPjY++nwE9TS+nLuOWSz2qfO7+4fRlbSVhZSWRymWtRAIUsOCoKgLe1AFCCkewwgGQhvvXM9Xuegf6SbP5g8HnoKy9vW89la2UMQK01AP57AXBHMsppZCkhTEb21YjoZw1gA4M/1++VHGWgv/4MMheJJh9WVt5JAYDrRJ7DXVlZOrWy8rkaGfYRAF1J/3e2f/B6HlwtLJKSC1Xo4viVPjIB/LP+DYgVvxTNfraPAAABnWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj4yNTc8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MjE0PC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CrQ8pN4AAAbsSURBVHgB7drtTZxXFIXRIUohphOoxFCJoRLcCdAJnTh+LVmxgsiAtaNoa6/5k8gmV/ese/QEf1x8+/45+RAgMCvwx+zkBidA4IeACFgEAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYnIAJ2gMC4gAiML4DxCYiAHSAwLiAC4wtgfAIiYAcIjAuIwPgCGJ+ACNgBAuMCIjC+AMYn8GcjwcvLy+nr16+n5+fnH9f/9OnT6cuXL6fjnz4ECHxM4OLb98/H/pP/96ufnp5O19fXry5xBODz58+nu7u7Vz/nBwgQeFugKgLHdwCXl5dvTnOE4PHx0XcEbwr5CQKvBap+T+D+/v71BL/8yBGJ29vbX37EvxIgcE6gKgLHLwXOfY4Q+BAg8H6Bql8OXFxcvGuyst/meNdMvojAfyVQ9Z3A1dXVWYebm5uzX+MLCBD4W6AqAsfv/p/7vOdrzp3h5wksCVRF4Pi//L/9n/74TuE93y0sPbBZCZwTqIrAMczDw8OPvxj062DHHw0ef1no+ONBHwIEPiZQ9RuD/xzt+JOAIwA+BAj8vkB1BH5/bP8lAQI/Bep+OfDz4v5JgEBGQAQyjk4hUCsgArVP5+IEMgIikHF0CoFaARGofToXJ5AREIGMo1MI1AqIQO3TuTiBjIAIZBydQqBWQARqn87FCWQERCDj6BQCtQIiUPt0Lk4gIyACGUenEKgVEIHap3NxAhkBEcg4OoVArYAI1D6dixPICIhAxtEpBGoFRKD26VycQEZABDKOTiFQKyACtU/n4gQyAiKQcXQKgVoBEah9OhcnkBEQgYyjUwjUCohA7dO5OIGMgAhkHJ1CoFZABGqfzsUJZAREIOPoFAK1AiJQ+3QuTiAjIAIZR6cQqBUQgdqnc3ECGQERyDg6hUCtgAjUPp2LE8gIiEDG0SkEagVEoPbpXJxARkAEMo5OIVArIAK1T+fiBDICIpBxdAqBWgERqH06FyeQERCBjKNTCNQKiEDt07k4gYyACGQcnUKgVkAEap/OxQlkBEQg4+gUArUCIlD7dC5OICMgAhlHpxCoFRCB2qdzcQIZARHIODqFQK2ACNQ+nYsTyAiIQMbRKQRqBUSg9ulcnEBGQAQyjk4hUCsgArVP5+IEMgIikHF0CoFaARGofToXJ5AREIGMo1MI1AqIQO3TuTiBjIAIZBydQqBWQARqn87FCWQERCDj6BQCtQIiUPt0Lk4gIyACGUenEKgVEIHap3NxAhkBEcg4OoVArYAI1D6dixPICIhAxtEpBGoFRKD26VycQEZABDKOTiFQKyACtU/n4gQyAiKQcXQKgVoBEah9OhcnkBEQgYyjUwjUCohA7dO5OIGMgAhkHJ1CoFZABGqfzsUJZAREIOPoFAK1AiJQ+3QuTiAjIAIZR6cQqBUQgdqnc3ECGQERyDg6hUCtwF8dFE4FdPS5tAAAAABJRU5ErkJggg==\"\n      />\n      <figcaption>Black ball</figcaption>\n    </figure>"
        },
        {
          "lectureTitle": "Step 4: The Game Loop",
          "lectureBody": "    <h3 id=\"step-4-the-game-loop\">Step 4: The Game Loop</h3>\n    <p>\n      Our game loop is already running. It’s that\n      <code style=\"white-space: pre-wrap;\">d3.timer</code> we started on\n      component mount.\n    </p>\n    <p>\n      What do you think we should do every time\n      <code style=\"white-space: pre-wrap;\">gameLoop</code> is called?\n    </p>\n    <p>Move the ball. Accelerate. Bounce it back. 🏀</p>\n    <p>\n      The physics is tricky to think about. Few students at my workshops figure\n      this one out and that’s the point: Game loop gives you control. All the\n      control.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb130\"\n      data-caption=\"Bouncy ball at 60fps\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb130-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// BouncingBall.js</span></a>\n<a class=\"sourceLine\" id=\"cb130-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb130-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// start game loop</span></a>\n<a class=\"sourceLine\" id=\"cb130-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">timer</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">timer</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">gameLoop</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb130-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb130-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb130-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">componentWillUnmount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb130-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">timer</span>.<span class=\"at\" style=\"color: #7d9029;\">stop</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb130-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb130-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb130-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  gameLoop <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb130-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> <span class=\"op\" style=\"color: #666666;\">{</span> y<span class=\"op\" style=\"color: #666666;\">,</span> vy <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb130-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb130-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (y <span class=\"op\" style=\"color: #666666;\">&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">max_h</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb130-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      vy <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">-</span>vy <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"fl\" style=\"color: #40a070;\">.87</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb130-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb130-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb130-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb130-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> y <span class=\"op\" style=\"color: #666666;\">+</span> vy<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb130-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">vy</span><span class=\"op\" style=\"color: #666666;\">:</span> vy <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"fl\" style=\"color: #40a070;\">0.3</span></a>\n<a class=\"sourceLine\" id=\"cb130-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb130-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Our <code style=\"white-space: pre-wrap;\">gameLoop</code> method is called\n      every 16 milliseconds give or take. Sometimes more, if the computer is\n      busy, low on batter, or the tab is left inactive for too long\n    </p>\n    <p>Bounce physics go like this:</p>\n    <ul>\n      <li>\n        add vertical speed, <code style=\"white-space: pre-wrap;\">vy</code>, to\n        position, <code style=\"white-space: pre-wrap;\">y</code>\n      </li>\n      <li>\n        increased <code style=\"white-space: pre-wrap;\">vy</code> by amount of\n        acceleration\n      </li>\n      <li>if position is more than max, bounce</li>\n      <li>bounce means invert speed</li>\n      <li>bounce means energy loss, reduce speed by 13%</li>\n    </ul>\n    <p>High school physics my friend. You might not remember.</p>\n    <p>\n      Speed tells you how much an object moves per unit of time. Our speed\n      starts at 5 pixels per frame.\n    </p>\n    <p>\n      Acceleration tells you how much speed increases per unit of time. Gravity\n      makes you fall 10 meters per second faster every second. Our gravity\n      looks best at 0.3 pixels per frame.\n    </p>\n    <p>Bounce is what really breaks people’s brains.</p>\n    <p>\n      I think it’s one of Newton’s laws? Or a derivation from there. Bouncing\n      means balls maintain the same speed, but change direction. Our wall is\n      perpendicular to the path of travel, so the speed inverts.\n    </p>\n    <p>We add some energy loss to make the bounce more realistic.</p>\n    <p>\n      Gravity acceleration points the same downwards direction as always.\n      Except now it’s slowing down the ball instead of speeding it up.\n    </p>\n    <p>Eventually speed reaches zero and the ball starts falling again.</p>\n    <figure>\n      <img\n        src=\"https://media.giphy.com/media/12NUbkX6p4xOO4/giphy.gif\"\n        alt=\"Magic\"\n      />\n      <figcaption>Magic</figcaption>\n    </figure>\n    <p>\n      Here’s a CodeSandbox with the\n      <a href=\"https://codesandbox.io/s/o4vk8zkn96\">final bouncy ball code</a>.\n    </p>\n    <p>\n      Experiment with multiple balls. Start them at different heights. Play\n      with different factors in those equations. It’s fun if you’re a nerd like\n      me.\n    </p>"
        },
        {
          "lectureTitle": "Step 5: Correcting for time and frame drops",
          "lectureBody": "    <h3 id=\"step-5-correcting-for-time-and-frame-drops\">\n      Step 5: Correcting for time and frame drops\n    </h3>\n    <p>If you run the CodeSandbox a few times, you’ll notice two bugs.</p>\n    <ol type=\"1\">\n      <li>\n        <p>\n          Sometimes our ball gets trapped at the bottom of the bounce. We won’t\n          fix this one; it’s tricky.\n        </p>\n      </li>\n      <li>\n        <p>\n          When you slow down your computer, the ball lags. That’s not how\n          things behave in real life.\n        </p>\n      </li>\n    </ol>\n    <p>We’re dealing with dropped frames.</p>\n    <p>\n      Modern browsers slow down JavaScript in tabs that aren’t focused, on\n      computers running off batteries, when batteries get low… many different\n      reasons. To make our animation silky smooth, we have to take this into\n      account.\n    </p>\n    <p>\n      That involves calculating how many frames we dropped and adjusting our\n      physics.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb131\"\n      data-caption=\"Adjust for frame drops\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb131-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// BouncingBall.js</span></a>\n<a class=\"sourceLine\" id=\"cb131-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  gameLoop <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb131-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> <span class=\"op\" style=\"color: #666666;\">{</span> y<span class=\"op\" style=\"color: #666666;\">,</span> vy<span class=\"op\" style=\"color: #666666;\">,</span> lastFrame <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb131-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb131-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> frames <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb131-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb131-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (lastFrame) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb131-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      frames <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">now</span>() <span class=\"op\" style=\"color: #666666;\">-</span> lastFrame) / (<span class=\"dv\" style=\"color: #40a070;\">1000</span> / <span class=\"dv\" style=\"color: #40a070;\">60</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb131-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb131-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb131-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">for</span> (<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> i <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">;</span> i <span class=\"op\" style=\"color: #666666;\">&lt;</span> frames<span class=\"op\" style=\"color: #666666;\">;</span> i<span class=\"op\" style=\"color: #666666;\">++</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb131-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (y <span class=\"op\" style=\"color: #666666;\">&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">max_h</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb131-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        vy <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">-</span>vy <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"fl\" style=\"color: #40a070;\">0.87</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb131-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb131-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb131-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      y <span class=\"op\" style=\"color: #666666;\">=</span> y <span class=\"op\" style=\"color: #666666;\">+</span> vy<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb131-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      vy <span class=\"op\" style=\"color: #666666;\">=</span> vy <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"fl\" style=\"color: #40a070;\">0.3</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb131-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb131-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb131-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb131-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      y<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb131-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      vy<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb131-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">lastFrame</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">now</span>()</a>\n<a class=\"sourceLine\" id=\"cb131-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb131-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      We add <code style=\"white-space: pre-wrap;\">lastFrame</code> to game\n      state and set it with\n      <code style=\"white-space: pre-wrap;\">d3.now()</code>. This gives us a\n      high resolution timestamp that’s pegged to\n      <code style=\"white-space: pre-wrap;\">requestAnimationFrame</code>. D3\n      guarantees that every\n      <code style=\"white-space: pre-wrap;\">d3.now()</code> called within the\n      same frame gets the same timestamp.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">(d3.now()-lastFrame)/16</code> tells\n      us how many frames were meant to have happened since last iteration. Most\n      of the time, this value will be\n      <code style=\"white-space: pre-wrap;\">1</code>.\n    </p>\n    <p>\n      We use <code style=\"white-space: pre-wrap;\">frames</code> to simulate as\n      many frames as we need in a quick loop. Run the same calculations with\n      the same height checks. This simulates the missing frames and makes our\n      animation look smooth.\n    </p>\n    <p>\n      Try it out on CodeSandbox:\n      <a href=\"https://codesandbox.io/s/8n3p6720wl\"\n        >click me for time-fixed bouncy ball</a\n      >\n    </p>"
        },
        {
          "lectureTitle": "Game loop recap",
          "lectureBody": "    <h2 id=\"game-loop-recap\">Game loop recap</h2>\n    <p>\n      You now know how to build a game loop and use it to run custom\n      animations. 👏\n    </p>\n    <ul>\n      <li>render from state</li>\n      <li>change state 60 times per second</li>\n      <li>reason about movement in snapshots</li>\n      <li>deal with dropped frames</li>\n      <li>complete control</li>\n    </ul>\n    <p>\n      Complete control is nice, but the mental acrobatics are not. Getting game\n      loops just right is hard.\n    </p>\n    <p>\n      And that’s why I recommend transitions in most cases. Transitions can\n      handle all of that for you out of the box.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Use transitions for simple animation",
      "lectures": [
        {
          "lectureTitle": "Transition basics",
          "lectureBody": "    <h1 id=\"using-transitions-for-simple-animation\">\n      Using transitions for simple animation\n    </h1>\n    <p>\n      Game loops are great for fine-grained control. And when all you need is a\n      little flourish on user action, that’s where transitions shine.\n    </p>\n    <p>No details, just keyframes.</p>\n    <p>\n      Transitions let you animate SVG elements by saying\n      <em\n        >“I want this property to change to this new value and take this long\n        to do so”</em\n      >.\n    </p>\n    <p>\n      Start-end keyframes are the simplest. You define the starting position.\n      Start a transition. Define the end position. D3 figures out the rest.\n      Everything from calculating the perfect rate of change to match your\n      start and end values and your duration, to <em>what</em> to change and\n      handling dropped frames.\n    </p>\n    <p>Quite magical.</p>\n    <p>\n      You can also sequence transitions to create complex keyframe-based\n      animation. Each new transition definition is like a new keyframe. D3\n      figures out the rest.\n    </p>\n    <p>\n      Better yet, you can use easing functions to make your animation look more\n      natural. Make rate of change follow a mathematical curve to create smooth\n      natural movement.\n    </p>\n    <p>\n      You can read more about the <em>why</em> of easing functions in Disney’s\n      <a href=\"https://en.wikipedia.org/wiki/12_basic_principles_of_animation\"\n        >12 Basic Principles of Animation</a\n      >. Bottom line is that it makes your animation feel natural.\n    </p>\n    <p>\n      <em>How</em> they work is hard to explain. You can grok part of it in my\n      <a\n        href=\"https://swizec.com/blog/silky-smooth-piechart-transitions-react-d3js/swizec/8258\"\n        >Custom transition tweens</a\n      >\n      article.\n    </p>\n    <p>\n      But don’t worry about it. All you have to know is that many easing\n      functions exist. <a href=\"https://easings.net/\">easings.net</a> lists the\n      common ones. D3 implements everything on that list.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/easings.net.png\"\n        alt=\"Common easing functions\"\n      />\n      <figcaption>Common easing functions</figcaption>\n    </figure>\n    <p>Let’s try an example: A swipe transition.</p>"
        }
      ]
    },
    {
      "sectionTitle": "Build a simple transition component",
      "lectures": [
        {
          "lectureTitle": "A swipe transition component",
          "lectureBody": "    <h2 id=\"swipe-transition\">Swipe transition</h2>\n    <p>\n      Our goal is to build a declarative component fully controlled by props.\n      We pass in the <code style=\"white-space: pre-wrap;\">x</code> coordinate\n      and the coordinate figures out the rest.\n    </p>\n    <p>\n      We shouldn’t care about the transition or how long it takes. That’s up to\n      the component. We just change\n      <code style=\"white-space: pre-wrap;\">x</code>.\n    </p>\n    <p>\n      You can see it in action\n      <a href=\"https://codesandbox.io/s/618mr9r6nr\">on CodeSandbox, here</a>.\n      Tweak params, see what happens. Follow along as I explain how it works.\n    </p>\n    <p>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/ball-swipe-left.png\"\n        alt=\"Ball on the left before you click\"\n      />\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/ball-swipe-right.png\"\n        alt=\"Ball on the right before you click\"\n      />\n    </p>"
        },
        {
          "lectureTitle": "App.js",
          "lectureBody": "    <h3 id=\"app.js\">App.js</h3>\n    <p>\n      Like we said: the hard stuff happens inside our Ball component. That\n      means App has render our Ball and implement a mechanism to toggle the\n      <code style=\"white-space: pre-wrap;\">x</code> coordinate between two\n      states: Left and right.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb132\"\n      data-caption=\"Rendering a declarative transitionable component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb132-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb132-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb132-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">ballLeft</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span></a>\n<a class=\"sourceLine\" id=\"cb132-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb132-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  ballJump <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb132-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb132-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">ballLeft</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">!</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">ballLeft</span></a>\n<a class=\"sourceLine\" id=\"cb132-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb132-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb132-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb132-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> ballLeft <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb132-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb132-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>div style<span class=\"op\" style=\"color: #666666;\">={</span>styles<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb132-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>h1<span class=\"op\" style=\"color: #666666;\">&gt;</span>D3 transitions <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">in</span> React <span class=\"fl\" style=\"color: #40a070;\">16.3</span> <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"st\" style=\"color: #4070a0;\">&quot;</span><span class=\"sc\" style=\"color: #4070a0;\">\\u2728</span><span class=\"st\" style=\"color: #4070a0;\">&quot;</span><span class=\"op\" style=\"color: #666666;\">}</span>&lt;/h1<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb132-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>p<span class=\"op\" style=\"color: #666666;\">&gt;</span>Click the <span class=\"dt\" style=\"color: #902000;\">ball </span><span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">point_down</span><span class=\"op\" style=\"color: #666666;\">:</span>&lt;/p<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb132-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg style<span class=\"op\" style=\"color: #666666;\">={{</span> <span class=\"dt\">width</span><span class=\"op\">:</span> <span class=\"st\">&quot;300&quot;</span><span class=\"op\">,</span> <span class=\"dt\">height</span><span class=\"op\">:</span> <span class=\"st\">&quot;300px&quot;</span> <span class=\"op\">}}</span> onClick<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">ballJump</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb132-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          <span class=\"op\" style=\"color: #666666;\">&lt;</span>Ball x<span class=\"op\" style=\"color: #666666;\">={</span>ballLeft <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"dv\" style=\"color: #40a070;\">15</span> : <span class=\"dv\" style=\"color: #40a070;\">250</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb132-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb132-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb132-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb132-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb132-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>Typical class based component:</p>\n    <ol type=\"1\">\n      <li>\n        State holding a\n        <code style=\"white-space: pre-wrap;\">ballLeft</code> boolean\n      </li>\n      <li>A method to toggle said boolean</li>\n      <li>\n        A render method that renders an SVG with an\n        <code style=\"white-space: pre-wrap;\">onClick</code> event\n      </li>\n    </ol>\n    <p>\n      When <code style=\"white-space: pre-wrap;\">state.ballLeft</code> is true,\n      ball renders on the left. When it’s false, on the right. Left and right\n      are hardcoded <code style=\"white-space: pre-wrap;\">x</code> coordinates.\n    </p>\n    <p>Ball component handles the rest.</p>"
        },
        {
          "lectureTitle": "Ball.js",
          "lectureBody": "    <h3 id=\"ball.js\">Ball.js</h3>\n    <p>\n      You’ve rendered a ball before: It’s an SVG circle. You can make it\n      fancier, but that’s not the point. The point are transitions.\n    </p>\n    <p>\n      The way D3 transitions work with React feels like combining the blackbox\n      and full integration approaches. Full integration for rendering, switch\n      to blackbox for the transition, release control back to React. 🤯\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb133\"\n      data-caption=\"Rendering a ball\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb133-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Ball <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">PureComponent</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb133-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">constructor</span>(props) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb133-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">super</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb133-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb133-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span></a>\n<a class=\"sourceLine\" id=\"cb133-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb133-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb133-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb133-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  circleRef <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">createRef</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb133-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb133-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb133-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb133-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb133-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb133-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>circle r<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;10&quot;</span> cx<span class=\"op\" style=\"color: #666666;\">={</span>x<span class=\"op\" style=\"color: #666666;\">}</span> cy<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">10</span><span class=\"op\" style=\"color: #666666;\">}</span> ref<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">circleRef</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb133-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb133-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We render a <code style=\"white-space: pre-wrap;\">circle</code> at\n      <code style=\"white-space: pre-wrap;\">x</code> coordinate and a random\n      <code style=\"white-space: pre-wrap;\">y</code> and give it a React ref.\n      We’ll use this ref to give control of the DOM node to D3. Just like\n      blackbox components.\n    </p>\n    <p>\n      The interesting part is that we use a constructor to copy our\n      <code style=\"white-space: pre-wrap;\">x</code> prop into state. That’s\n      because we’re going to use props as a sort of staging area for what we\n      <em>want</em> <code style=\"white-space: pre-wrap;\">x</code> to be, not\n      what it currently is.\n    </p>\n    <p>Props change, state stays the same. React doesn’t move our ball.</p>"
        },
        {
          "lectureTitle": "Ball.js state transition",
          "lectureBody": "    <h3 id=\"ball.js-state-transition\">Ball.js state transition</h3>\n    <p>\n      What does move our ball, is our transition. We do that in\n      <code style=\"white-space: pre-wrap;\">componentDidUpdate</code>.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb134\"\n      data-caption=\"D3 transition our ball\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb134-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">componentDidUpdate</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb134-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> el <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">circleRef</span>.<span class=\"at\" style=\"color: #7d9029;\">current</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb134-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb134-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">el</span>.<span class=\"at\" style=\"color: #7d9029;\">transition</span>()</a>\n<a class=\"sourceLine\" id=\"cb134-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">duration</span>(<span class=\"dv\" style=\"color: #40a070;\">800</span>)</a>\n<a class=\"sourceLine\" id=\"cb134-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">ease</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">easeBounceOut</span>)</a>\n<a class=\"sourceLine\" id=\"cb134-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;cx&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">satisfied</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb134-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      .<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;end&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb134-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb134-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span></a>\n<a class=\"sourceLine\" id=\"cb134-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb134-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb134-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      React calls\n      <code style=\"white-space: pre-wrap;\">componentDidUpdate</code> when props\n      or state change. We use this as an opportunity to run a D3 transition on\n      our DOM node.\n    </p>\n    <p>Here’s what happens:</p>\n    <ol type=\"1\">\n      <li>\n        Take the node with\n        <code style=\"white-space: pre-wrap;\">d3.select</code>\n      </li>\n      <li>\n        Start a transition with\n        <code style=\"white-space: pre-wrap;\">.transition</code>\n      </li>\n      <li>\n        Specify 800ms duration with\n        <code style=\"white-space: pre-wrap;\">.duration</code>\n      </li>\n      <li>\n        Add an easing function for that beautiful bounce effect with\n        <code style=\"white-space: pre-wrap;\">.ease</code>\n      </li>\n      <li>\n        Define which attributes are changing with\n        <code style=\"white-space: pre-wrap;\">.attr</code>\n      </li>\n      <li>\n        Use <code style=\"white-space: pre-wrap;\">.on(\"end\")</code> to sync\n        React worldview with reality after transition ends\n      </li>\n    </ol>\n    <p>\n      What’s great about D3 transitions is that D3 figures everything for you.\n      You can throw as many attributes at a transition as you want. The\n      attributes can be as complex as you can imagine.\n    </p>\n    <p>\n      D3’s interpolation methods will figure it out for you. Numbers, strings,\n      colors, it all works great.\n    </p>\n    <p>\n      After a transition is done, I like to sync React’s worldview with what\n      the transition changed. It’s not strictly required but it can sometimes\n      lead to React freaking out that you moved an element.\n    </p>\n    <p>\n      Play around. Try adding some more transitions. Make the ball move\n      diagonally. Make it go right then down. It’s fun. 😊\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Enter-update-exit animation",
      "lectures": [
        {
          "lectureTitle": "Enter-update-exit animation intro",
          "lectureBody": "    <h1 id=\"enter-exit-animation\">Enter/update/exit animation</h1>\n    <p>\n      Now that you know how to use transitions, it’s time to take it up a\n      notch. Enter/exit animations.\n    </p>\n    <p>\n      Enter/exit animations are the most common use of transitions. They’re\n      what happens when a new element enters or exits the picture. For example:\n      in visualizations like this famous\n      <a href=\"https://www.youtube.com/watch?v=LLCF7vPanrY\"\n        >Nuclear Detonation Timeline</a\n      >\n      by Isao Hashimoto. Each new Boom! flashes to look like an explosion.\n    </p>\n    <p>\n      I don’t know how Hashimoto did it, but with React &amp; D3, you’d do it\n      with enter/exit transitions.\n    </p>\n    <p>\n      Another favorite of mine is this\n      <a href=\"https://bl.ocks.org/mbostock/3808234\">animated alphabet</a>\n      example by Mike Bostock, the creator of D3, that showcases\n      enter/update/exit transitions.\n    </p>\n    <p>\n      That’s what we’re going to build: An animated alphabet. New letters fall\n      down and are green, updated letters move right or left, deleted letters\n      are red and fall down.\n    </p>\n    <p>\n      You can play with a more advanced version\n      <a href=\"https://swizec.github.io/react-d3-enter-exit-transitions/\"\n        >here</a\n      >. Same principle as the alphabet, but it animates what you type.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/typing-screenshot.png\"\n        alt=\"Typing animation screenshot\"\n      />\n      <figcaption>Typing animation screenshot</figcaption>\n    </figure>\n    <p>\n      We’re building the alphabet version because the\n      <a\n        href=\"https://swizec.com/blog/animated-string-diffing-with-react-and-d3/swizec/6952\"\n        >string diffing algorithm</a\n      >\n      is a pain to explain. I learned that the hard way when giving workshops\n      on React and D3…\n    </p>\n    <figure>\n      <img\n        src=\"https://cdn.staticaly.com/gh/hsribei/react-d3js-es6-ebook/024f7e0ae8547f5288f61bc442370f0f689d84eb/manuscript/resources/images/es6v2/string-diffing.jpg\"\n        alt=\"String diffing algorithm sketch\"\n      />\n      <figcaption>String diffing algorithm sketch</figcaption>\n    </figure>\n    <p>See?</p>\n    <p>\n      Easy on paper, but the code is long and weird. That, or I’m bad at\n      implementing it. Either way, it’s too tangential to explain here. You can\n      <a\n        href=\"https://swizec.com/blog/animated-string-diffing-with-react-and-d3/swizec/6952\"\n        >read the article about it</a\n      >.\n    </p>"
        },
        {
          "lectureTitle": "Build a declarative animated alphabet",
          "lectureBody": "    <h2 id=\"animated-alphabet\">Animated alphabet</h2>\n    <p>\n      Our goal is to render a random subset of the alphabet. Every time the set\n      updates, old letters transition out, new letters transition in, and\n      updated letters transition into a new position.\n    </p>\n    <p>We need two components:</p>\n    <ul>\n      <li>\n        <code style=\"white-space: pre-wrap;\">Alphabet</code>, which creates\n        random lists of letters every 1.5 seconds, then maps through them to\n        render <code style=\"white-space: pre-wrap;\">Letter</code> components\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">Letter</code>, which renders an\n        SVG text element and takes care of its own enter/update/exit\n        transitions\n      </li>\n    </ul>\n    <p>\n      You can see the full code on GitHub\n      <a\n        href=\"https://github.com/Swizec/react-d3-enter-exit-transitions/blob/master/src/components/Alphabet.jsx\"\n        >here</a\n      >.\n    </p>"
        },
        {
          "lectureTitle": "Project setup",
          "lectureBody": "    <h3 id=\"project-setup\">Project setup</h3>\n    <p>\n      To get started you’ll need a project. Either start one with\n      <code style=\"white-space: pre-wrap;\">create-react-app</code> or in\n      CodeSandbox. Either will work.\n    </p>\n    <p>\n      You’ll need a base App component that renders an SVG with an\n      <code style=\"white-space: pre-wrap;\">&lt;Alphabet&gt;</code> child. Our\n      component is self-contained so that’s all you need.\n    </p>\n    <p>Something like this 👇</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb135\"\n      data-caption=\"Base App component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb135-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Alphabet <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./components/Alphabet`;</span></a>\n<a class=\"sourceLine\" id=\"cb135-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb135-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> App <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb135-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;100%&quot;</span> height<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;600&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb135-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>Alphabet x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">32</span><span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">300</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb135-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb135-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)</a></code></pre>\n    </div>\n    <p>\n      I follow the convention of putting components in a\n      <code style=\"white-space: pre-wrap;\">src/components</code> directory. You\n      don’t have to.\n    </p>\n    <p>Remember to install dependencies: d3 and react-transition-group</p>"
        },
        {
          "lectureTitle": "The Alphabet component",
          "lectureBody": "    <h3 id=\"the-alphabet-component\">The Alphabet component</h3>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">Alphabet</code> component holds\n      a list of letters in component state and renders a collection of\n      <code style=\"white-space: pre-wrap;\">Letter</code> components in a loop.\n    </p>\n    <p>We start with a skeleton like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb136\"\n      data-caption=\"Alphabet skeleton\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb136-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Alphabet.js</span></a>\n<a class=\"sourceLine\" id=\"cb136-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb136-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb136-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> TransitionGroup <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react-transition-group&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb136-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb136-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Letter <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;./Letter&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb136-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb136-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Alphabet <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb136-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">static</span> letters <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span>.<span class=\"at\" style=\"color: #7d9029;\">split</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb136-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">alphabet</span><span class=\"op\" style=\"color: #666666;\">:</span> [] <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb136-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb136-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb136-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// start interval</span></a>\n<a class=\"sourceLine\" id=\"cb136-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb136-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb136-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    shuffleAlphabet <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb136-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">       <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// generate new alphabet</span></a>\n<a class=\"sourceLine\" id=\"cb136-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb136-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb136-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb136-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> transform <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span><span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span><span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb136-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb136-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb136-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// spit out letters</span></a>\n<a class=\"sourceLine\" id=\"cb136-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb136-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb136-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb136-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb136-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Alphabet<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We import dependencies and define the\n      <code style=\"white-space: pre-wrap;\">Alphabet</code> component. It keeps\n      a list of available letters in a static\n      <code style=\"white-space: pre-wrap;\">letters</code> property and an empty\n      <code style=\"white-space: pre-wrap;\">alphabet</code> in component state.\n    </p>\n    <p>\n      We’ll start a <code style=\"white-space: pre-wrap;\">d3.interval</code> on\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> and use\n      <code style=\"white-space: pre-wrap;\">shuffleAlphabet</code> to generate\n      alphabet subsets.\n    </p>\n    <p>\n      To showcase enter-update-exit transitions, we create a new alphabet every\n      second and a half. Using\n      <code style=\"white-space: pre-wrap;\">d3.interval</code> lets us do that\n      in a browser friendly way.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb137\"\n      data-caption=\"Alphabet game loop\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb137-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Alphabet/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb137-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb137-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">interval</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">shuffleAlphabet</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">1500</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb137-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb137-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb137-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    shuffleAlphabet <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb137-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> alphabet <span class=\"op\" style=\"color: #666666;\">=</span> d3</a>\n<a class=\"sourceLine\" id=\"cb137-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">shuffle</span>(<span class=\"va\" style=\"color: #19177c;\">Alphabet</span>.<span class=\"at\" style=\"color: #7d9029;\">letters</span>)</a>\n<a class=\"sourceLine\" id=\"cb137-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">slice</span>(<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">floor</span>(<span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">random</span>() <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"va\" style=\"color: #19177c;\">Alphabet</span>.<span class=\"va\" style=\"color: #19177c;\">letters</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span>))</a>\n<a class=\"sourceLine\" id=\"cb137-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">sort</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb137-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb137-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb137-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            alphabet</a>\n<a class=\"sourceLine\" id=\"cb137-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb137-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      Think of this as our game loop: Change alphabet state in consistent time\n      intervals.\n    </p>\n    <p>\n      We use\n      <code style=\"white-space: pre-wrap;\">d3.interval( //.., 1500)</code> to\n      call <code style=\"white-space: pre-wrap;\">shuffleAlphabet</code> every\n      1.5 seconds. Same as\n      <code style=\"white-space: pre-wrap;\">setInterval</code>, but friendlier\n      to batteries and CPUs because it pegs to\n      <code style=\"white-space: pre-wrap;\">requestAnimationFrame</code>. On\n      each period, we use\n      <code style=\"white-space: pre-wrap;\">shuffleAlphabet</code> to shuffle\n      available letters, slice out a random amount, sort them, and update\n      component state with\n      <code style=\"white-space: pre-wrap;\">setState</code>.\n    </p>\n    <p>\n      This process ensures our alphabet is both random and in alphabetical\n      order.\n    </p>\n    <p>\n      Starting the interval in\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> ensures it\n      only runs when our Alphabet is on the page. In real life you should stop\n      it on <code style=\"white-space: pre-wrap;\">componentWillUnmount</code>.\n      Since this is a tiny experiment and we know\n      <code style=\"white-space: pre-wrap;\">&lt;Alphabet&gt;</code> never\n      unmounts without a page refresh, it’s okay to skip that step.\n    </p>"
        },
        {
          "lectureTitle": "Declarative render for enter-exit transitions",
          "lectureBody": "    <h4 id=\"declarative-render-for-enterexit-transitions\">\n      Declarative render for enter/exit transitions\n    </h4>\n    <p>\n      Our declarative enter/exit transitions start in the\n      <code style=\"white-space: pre-wrap;\">render</code> method.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb138\"\n      data-caption=\"Letter rendering\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb138-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Alphabet/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb138-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb138-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> transform <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span><span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span><span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb138-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb138-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb138-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">={</span>transform<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb138-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>TransitionGroup enter<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">}</span> exit<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">}</span> component<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;g&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb138-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"va\" style=\"color: #19177c;\">alphabet</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>((d<span class=\"op\" style=\"color: #666666;\">,</span> i) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb138-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"op\" style=\"color: #666666;\">&lt;</span>Letter letter<span class=\"op\" style=\"color: #666666;\">={</span>d<span class=\"op\" style=\"color: #666666;\">}</span> index<span class=\"op\" style=\"color: #666666;\">={</span>i<span class=\"op\" style=\"color: #666666;\">}</span> key<span class=\"op\" style=\"color: #666666;\">={</span>d<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb138-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    ))<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb138-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                &lt;/TransitionGroup<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb138-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb138-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb138-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      An SVG transformation moves our alphabet into the specified\n      <code style=\"white-space: pre-wrap;\">(x, y)</code> position. We map\n      through\n      <code style=\"white-space: pre-wrap;\">this.state.alphabet</code> inside a\n      <code style=\"white-space: pre-wrap;\">&lt;TransitionGroup&gt;</code>\n      component and render a\n      <code style=\"white-space: pre-wrap;\">&lt;Letter&gt;</code> component for\n      every letter. Each\n      <code style=\"white-space: pre-wrap;\">Letter</code> gets a\n      <code style=\"white-space: pre-wrap;\">letter</code> prop for the text, an\n      <code style=\"white-space: pre-wrap;\">index</code> prop to know where it\n      stands, and a <code style=\"white-space: pre-wrap;\">key</code> so React\n      can tell them apart.\n    </p>\n    <h4 id=\"the-key-property\">The key property</h4>\n    <p>\n      The key property is how React identifies components. Pick wrong, and\n      you’re gonna have a bad time. I spent many hours debugging and writing\n      workarounds before I realized that basing my key on the index was a Bad\n      Move™. <em>Obviously</em>, you want the letter to stay constant in each\n      component and the index to change.\n    </p>\n    <p>That’s how x-axis transitions work.</p>\n    <p>\n      You move the letter into a specific place in the alphabet. You’ll see\n      what I mean when we look at the\n      <code style=\"white-space: pre-wrap;\">Letter</code> component.\n    </p>"
        },
        {
          "lectureTitle": "TransitionGroup",
          "lectureBody": "    <h4 id=\"transitiongroup\">TransitionGroup</h4>\n    <p>\n      React TransitionGroup gives us coordinated control over a set of\n      transitionable components. Each Letter is going to be a\n      <code style=\"white-space: pre-wrap;\">&lt;Transition&gt;</code>, you’ll\n      see.\n    </p>\n    <p>\n      We need TransitionGroup to gain declarative control over the enter/exit\n      cycle. Transition components can handle transitions themselves, but they\n      need an <code style=\"white-space: pre-wrap;\">in</code> prop to say\n      whether they’re in or out of the visualization.\n    </p>\n    <p>\n      Flip from <code style=\"white-space: pre-wrap;\">false</code> to\n      <code style=\"white-space: pre-wrap;\">true</code>, run an enter\n      transition.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">true</code> to\n      <code style=\"white-space: pre-wrap;\">false</code>, run an exit\n      transition.\n    </p>\n    <p>\n      We can make this change from within our component, of course. When\n      responding to user events for example. In our case we need that control\n      to come from outside based on which letters exist in the\n      <code style=\"white-space: pre-wrap;\">alphabet</code> array.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">TransitionGroup</code> handles that\n      for us. It automatically passes the correct\n      <code style=\"white-space: pre-wrap;\">in</code> prop to its children based\n      on who is and isn’t being rendered.\n    </p>\n    <p>\n      As an added bonus, we can use TransitionGroup to set a bunch of default\n      parameters for child Transitions. Whether to use\n      <code style=\"white-space: pre-wrap;\">enter</code> animations,\n      <code style=\"white-space: pre-wrap;\">exit</code> animations, stuff like\n      that. You can read\n      <a href=\"https://github.com/reactjs/react-transition-group\"\n        >a full list in the docs</a\n      >.\n    </p>"
        },
        {
          "lectureTitle": "The Letter component",
          "lectureBody": "    <h3 id=\"the-letter-component\">The Letter component</h3>\n    <p>\n      We’re ready for the component that can transition itself into and out of\n      a visualization. Without consumers having to worry about what’s going on\n      behind the scenes 👌\n    </p>\n    <p>\n      The skeleton for our\n      <code style=\"white-space: pre-wrap;\">Letter</code> component looks like\n      this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb139\"\n      data-caption=\"Letter component skeleton\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb139-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Letter.js</span></a>\n<a class=\"sourceLine\" id=\"cb139-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb139-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb139-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb139-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Transition <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react-transition-group/Transition&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb139-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb139-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> ExitColor <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;brown&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb139-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    UpdateColor <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;#333&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb139-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    EnterColor <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;green&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb139-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb139-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Letter <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb139-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    defaultState <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb139-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-60</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb139-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">index</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"dv\" style=\"color: #40a070;\">32</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb139-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">color</span><span class=\"op\" style=\"color: #666666;\">:</span> EnterColor<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb139-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">fillOpacity</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"fl\" style=\"color: #40a070;\">1e-6</span></a>\n<a class=\"sourceLine\" id=\"cb139-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb139-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">defaultState</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb139-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    letterRef <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">createRef</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb139-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb139-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    onEnter <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb139-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Letter enters the visualization</span></a>\n<a class=\"sourceLine\" id=\"cb139-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb139-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb139-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    onExit <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb139-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Letter drops out transition</span></a>\n<a class=\"sourceLine\" id=\"cb139-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb139-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb139-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidUpdate</span>(prevProps<span class=\"op\" style=\"color: #666666;\">,</span> prevState) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb139-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// update transition</span></a>\n<a class=\"sourceLine\" id=\"cb139-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb139-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb139-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb139-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> fillOpacity<span class=\"op\" style=\"color: #666666;\">,</span> color <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb139-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span> letter <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb139-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb139-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb139-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// render Transition with text</span></a>\n<a class=\"sourceLine\" id=\"cb139-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb139-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb139-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb139-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb139-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Letter<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We start with some imports and define a\n      <code style=\"white-space: pre-wrap;\">Letter</code> component with a\n      default state. We keep\n      <code style=\"white-space: pre-wrap;\">defaultState</code> in a separate\n      value because we’re going to manually reset state in some cases.\n    </p>\n    <p>\n      A <code style=\"white-space: pre-wrap;\">letterRef</code> helps us hand\n      over control to D3 during transitions, the\n      <code style=\"white-space: pre-wrap;\">onEnter</code> callback handles\n      enter transitions,\n      <code style=\"white-space: pre-wrap;\">onExit</code> exit transitions, and\n      <code style=\"white-space: pre-wrap;\">componentDidUpdate</code> update\n      transitions. Render is where it call comes together.\n    </p>\n    <p>\n      Each of these transition methods is going to follow the same approach you\n      learned about in the swipe transition example. Render from state,\n      transition with D3, update state to match.\n    </p>\n    <p>\n      You can make this component more flexible by moving the various magic\n      numbers we use into props. Default\n      <code style=\"white-space: pre-wrap;\">y</code> offset, transition\n      duration, colors, stuff like that. The world is your oyster my friend.\n    </p>"
        },
        {
          "lectureTitle": "onEnter",
          "lectureBody": "    <h4 id=\"onenter\">onEnter</h4>\n    <p>\n      We start with the enter transition in the\n      <code style=\"white-space: pre-wrap;\">onEnter</code> callback.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb140\"\n      data-caption=\"Enter transition\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb140-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Letter.js</span></a>\n<a class=\"sourceLine\" id=\"cb140-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    onEnter <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb140-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Letter is entering the visualization</span></a>\n<a class=\"sourceLine\" id=\"cb140-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> node <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">letterRef</span>.<span class=\"at\" style=\"color: #7d9029;\">current</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb140-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb140-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">node</span>.<span class=\"at\" style=\"color: #7d9029;\">transition</span>()</a>\n<a class=\"sourceLine\" id=\"cb140-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">duration</span>(<span class=\"dv\" style=\"color: #40a070;\">750</span>)</a>\n<a class=\"sourceLine\" id=\"cb140-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">ease</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">easeCubicInOut</span>)</a>\n<a class=\"sourceLine\" id=\"cb140-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>)</a>\n<a class=\"sourceLine\" id=\"cb140-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">style</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;fill-opacity&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>)</a>\n<a class=\"sourceLine\" id=\"cb140-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;end&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb140-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb140-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb140-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"dt\" style=\"color: #902000;\">fillOpacity</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb140-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"dt\" style=\"color: #902000;\">color</span><span class=\"op\" style=\"color: #666666;\">:</span> UpdateColor</a>\n<a class=\"sourceLine\" id=\"cb140-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb140-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb140-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      We use <code style=\"white-space: pre-wrap;\">d3.select</code> to grab our\n      DOM node and take control with D3. Start a new transition with\n      <code style=\"white-space: pre-wrap;\">.transition()</code>, specify a\n      duration, an easing function, and specify the changes. Vertical position\n      moves to <code style=\"white-space: pre-wrap;\">0</code>, opacity changes\n      to <code style=\"white-space: pre-wrap;\">1</code>.\n    </p>\n    <p>This creates a drop-in fade-in effect.</p>\n    <p>\n      When our transition ends, we update state with the new\n      <code style=\"white-space: pre-wrap;\">y</code> coordinate,\n      <code style=\"white-space: pre-wrap;\">fillOpacity</code>, and\n      <code style=\"white-space: pre-wrap;\">color</code>.\n    </p>\n    <p>\n      The result is an invisible letter that starts at -60px and moves into 0px\n      and full visibility over 750 milliseconds.\n    </p>"
        },
        {
          "lectureTitle": "onExit",
          "lectureBody": "    <h4 id=\"onexit\">onExit</h4>\n    <p>\n      Our exit transition goes in the\n      <code style=\"white-space: pre-wrap;\">onExit</code> callback.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb141\"\n      data-caption=\"Leave transition\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb141-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Alphabet/</span></a>\n<a class=\"sourceLine\" id=\"cb141-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    onExit <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb141-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Letter is dropping out</span></a>\n<a class=\"sourceLine\" id=\"cb141-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> node <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">letterRef</span>.<span class=\"at\" style=\"color: #7d9029;\">current</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb141-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb141-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">node</span>.<span class=\"at\" style=\"color: #7d9029;\">style</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;fill&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> ExitColor)</a>\n<a class=\"sourceLine\" id=\"cb141-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">transition</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">transition</span>)</a>\n<a class=\"sourceLine\" id=\"cb141-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;y&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">60</span>)</a>\n<a class=\"sourceLine\" id=\"cb141-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">style</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;fill-opacity&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"fl\" style=\"color: #40a070;\">1e-6</span>)</a>\n<a class=\"sourceLine\" id=\"cb141-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;end&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">defaultState</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb141-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      Same as before, we take control of the DOM, run a transition, and update\n      state when we’re done. We start with forcing our letter into a new color,\n      then move it 60px down, transition to invisible, and reset state.\n    </p>\n    <p>\n      But why are we resetting state instead of updating to current reality?\n    </p>\n    <p>Our components never unmount.</p>\n    <p>\n      We avoid unmounts to keep transitions smoother. Instead of unmounting, we\n      have to reset state back to its default values.\n    </p>\n    <p>\n      That moves the letter back into its enter state and ensures even re-used\n      letters drop down from the top. Took me a while to tinker that one out.\n    </p>"
        },
        {
          "lectureTitle": "componentDidUpdate",
          "lectureBody": "    <h4 id=\"componentdidupdate\">componentDidUpdate</h4>\n    <p>\n      <code style=\"white-space: pre-wrap;\">componentDidUpdate</code> is our\n      trickiest transition yet. It has two jobs:\n    </p>\n    <ul>\n      <li>\n        jump existing components to correct horizontal position when a new\n        <code style=\"white-space: pre-wrap;\">enter</code> transition begins\n      </li>\n      <li>\n        transition components into new horizontal positions based on changing\n        indexes\n      </li>\n    </ul>\n    <p>It goes like this 👇</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb142\"\n      data-caption=\"Update transition\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb142-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Alphabet/Letter.js</span></a>\n<a class=\"sourceLine\" id=\"cb142-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidUpdate</span>(prevProps<span class=\"op\" style=\"color: #666666;\">,</span> prevState) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb142-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"va\" style=\"color: #19177c;\">prevProps</span>.<span class=\"at\" style=\"color: #7d9029;\">in</span> <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">in</span> <span class=\"op\" style=\"color: #666666;\">&amp;&amp;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">in</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb142-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// A new enter transition has begun</span></a>\n<a class=\"sourceLine\" id=\"cb142-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb142-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">index</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"dv\" style=\"color: #40a070;\">32</span></a>\n<a class=\"sourceLine\" id=\"cb142-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb142-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">else</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"va\" style=\"color: #19177c;\">prevProps</span>.<span class=\"at\" style=\"color: #7d9029;\">index</span> <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">index</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb142-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Letter is moving to a new location</span></a>\n<a class=\"sourceLine\" id=\"cb142-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> node <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">letterRef</span>.<span class=\"at\" style=\"color: #7d9029;\">current</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb142-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                targetX <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">index</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"dv\" style=\"color: #40a070;\">32</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb142-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb142-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">node</span>.<span class=\"at\" style=\"color: #7d9029;\">style</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;fill&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> UpdateColor)</a>\n<a class=\"sourceLine\" id=\"cb142-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                .<span class=\"at\" style=\"color: #7d9029;\">transition</span>()</a>\n<a class=\"sourceLine\" id=\"cb142-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                .<span class=\"at\" style=\"color: #7d9029;\">duration</span>(<span class=\"dv\" style=\"color: #40a070;\">750</span>)</a>\n<a class=\"sourceLine\" id=\"cb142-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                .<span class=\"at\" style=\"color: #7d9029;\">ease</span>(<span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">easeCubicInOut</span>)</a>\n<a class=\"sourceLine\" id=\"cb142-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                .<span class=\"at\" style=\"color: #7d9029;\">attr</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;x&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> targetX)</a>\n<a class=\"sourceLine\" id=\"cb142-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                .<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;end&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb142-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb142-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> targetX<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb142-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"dt\" style=\"color: #902000;\">color</span><span class=\"op\" style=\"color: #666666;\">:</span> UpdateColor</a>\n<a class=\"sourceLine\" id=\"cb142-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb142-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb142-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb142-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      When the <code style=\"white-space: pre-wrap;\">in</code> prop changes to\n      <code style=\"white-space: pre-wrap;\">true</code>, we’re starting a new\n      enter transition on an existing component. We already moved it to the top\n      of the visualization after exiting, but we couldn’t have known its future\n      index.\n    </p>\n    <p>\n      A quick <code style=\"white-space: pre-wrap;\">setState</code> makes sure\n      our letter is in the right place and\n      <code style=\"white-space: pre-wrap;\">onEnter</code> takes care of the\n      rest.\n    </p>\n    <p>\n      Otherwise we check if index changed and if it has, we run a transition in\n      much the same way as we have so far:\n    </p>\n    <ul>\n      <li>\n        calculate new <code style=\"white-space: pre-wrap;\">targetX</code>\n      </li>\n      <li>update letter color</li>\n      <li>start a transition with the usual parameters</li>\n      <li>update <code style=\"white-space: pre-wrap;\">x</code> coordinate</li>\n      <li>update state when transition ends</li>\n    </ul>\n    <p>\n      You now have a component that knows how to run its own enter/update/exit\n      transitions. Time to wire it all up in the\n      <code style=\"white-space: pre-wrap;\">render</code> method.\n    </p>"
        },
        {
          "lectureTitle": "render",
          "lectureBody": "    <h4 id=\"render-3\">render</h4>\n    <p>Hard work is done. Here’s how you render:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb143\"\n      data-caption=\"Letter render method\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb143-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Alphabet/Letter.js</span></a>\n<a class=\"sourceLine\" id=\"cb143-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb143-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> fillOpacity<span class=\"op\" style=\"color: #666666;\">,</span> color <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb143-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">{</span> letter <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb143-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb143-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb143-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>Transition</a>\n<a class=\"sourceLine\" id=\"cb143-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">in</span><span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">in</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb143-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                unmountOnExit<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">false</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb143-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                timeout<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">750</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb143-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                onEnter<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">onEnter</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb143-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                onExit<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">onExit</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb143-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb143-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>text</a>\n<a class=\"sourceLine\" id=\"cb143-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    dy<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;.35em&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb143-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    x<span class=\"op\" style=\"color: #666666;\">={</span>x<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb143-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    y<span class=\"op\" style=\"color: #666666;\">={</span>y<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb143-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    style<span class=\"op\" style=\"color: #666666;\">={{</span></a>\n<a class=\"sourceLine\" id=\"cb143-19\" title=\"19\">                        <span class=\"dt\">fillOpacity</span><span class=\"op\">:</span> fillOpacity<span class=\"op\">,</span></a>\n<a class=\"sourceLine\" id=\"cb143-20\" title=\"20\">                        <span class=\"dt\">fill</span><span class=\"op\">:</span> color<span class=\"op\">,</span></a>\n<a class=\"sourceLine\" id=\"cb143-21\" title=\"21\">                        <span class=\"dt\">font</span><span class=\"op\">:</span> <span class=\"st\">&quot;bold 48px monospace&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb143-22\" title=\"22\">                    <span class=\"op\">}}</span></a>\n<a class=\"sourceLine\" id=\"cb143-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    ref<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">letterRef</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb143-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb143-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">{</span>letter<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb143-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                &lt;/text<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb143-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/Transition<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb143-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb143-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We render a\n      <code style=\"white-space: pre-wrap;\">Transition</code> element, which\n      gives us the transition super powers we need to run enter/exit\n      transitions. Update transitions work on all React components.\n    </p>\n    <p>\n      The outside\n      <code style=\"white-space: pre-wrap;\">TransitionGroup</code> gives us the\n      correct <code style=\"white-space: pre-wrap;\">in</code> prop value, we\n      just have to pass it into\n      <code style=\"white-space: pre-wrap;\">Transition</code>. We disable\n      <code style=\"white-space: pre-wrap;\">unmountOnExit</code> to make\n      transitions smoother, define a\n      <code style=\"white-space: pre-wrap;\">timeout</code> which has to match\n      what we’re using in our transitions, and define\n      <code style=\"white-space: pre-wrap;\">onEnter</code> and\n      <code style=\"white-space: pre-wrap;\">onExit</code> callbacks.\n    </p>\n    <p>\n      There’s a lot more to the API that we can use and you should check that\n      out in the docs. Docs don’t go into detail on everything, but if you\n      experiment I’m sure you’ll figure it out.\n    </p>\n    <p>\n      Inside the transition we render an SVG\n      <code style=\"white-space: pre-wrap;\">&lt;text&gt;</code> element rendered\n      at an <code style=\"white-space: pre-wrap;\">(x, y)</code> position with a\n      <code style=\"white-space: pre-wrap;\">color</code> and\n      <code style=\"white-space: pre-wrap;\">fillOpacity</code> style. It shows a\n      single letter taken from the\n      <code style=\"white-space: pre-wrap;\">letter</code> prop.\n    </p>"
        },
        {
          "lectureTitle": "That's it 👍",
          "lectureBody": "    <h3 id=\"thats-it-thumbsup\">That’s it 👍</h3>\n    <p>Boom. We’re done.</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/alphabet-transitions.png\"\n        alt=\"Alphabet transitions are hard to screenshot\"\n      />\n      <figcaption>Alphabet transitions are hard to screenshot</figcaption>\n    </figure>\n    <p>\n      You can play with a more complex version of this example here:\n      <a href=\"https://swizec.github.io/react-d3-enter-exit-transitions/\"\n        >https://swizec.github.io/react-d3-enter-exit-transitions/</a\n      >. Try typing different strings and see how the visualization reacts.\n    </p>\n    <p>\n      The typing example uses the same Letter components to declaratively\n      render its string, but it drives the input through your typing instead of\n      an automatic shuffler.\n    </p>"
        },
        {
          "lectureTitle": "Key transition takeaways",
          "lectureBody": "    <h3 id=\"key-takeaways-for-transitions-are\">\n      Key takeaways for transitions are:\n    </h3>\n    <ul>\n      <li>use d3 for transitions</li>\n      <li>use React to manage SVG elements</li>\n      <li>\n        use TransitionGroup and Transition for the enter/update/exit pattern\n      </li>\n    </ul>"
        }
      ]
    },
    {
      "sectionTitle": "Animating with React, Redux, and D3",
      "lectures": [
        {
          "lectureTitle": "Redux animation intro",
          "lectureBody": "    <h1 id=\"animating-react-redux\">Animating with React, Redux, and d3</h1>\n    <p>\n      And now for some pure nerdy fun: A particle generator… or, well, as close\n      as you can get with React and D3. You’d need WebGL for a\n      <em>real</em> particle generator.\n    </p>\n    <p>\n      We’re making tiny circles fly out of your mouse cursor. Works on mobile\n      with your finger, too.\n    </p>\n    <p>\n      To see the particle generator in action,\n      <a href=\"https://swizec.github.io/react-particles-experiment/\">go here</a\n      >. Github won’t let me host different branches, so you’ll see the\n      advanced 20,000 particle version from next chapter.\n    </p>\n    <p>\n      We’re using the\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906604#game-loop\"\n        >game loop</a\n      >\n      approach to animation and Redux to store the state tree and drive changes\n      for each frame.\n    </p>\n    <p>\n      You can see the full code\n      <a href=\"https://github.com/Swizec/react-particles-experiment\"\n        >on GitHub</a\n      >. I’ve merged the SVG and Canvas branches. Redux part is the same, some\n      parameters differ. We’re focusing on the Redux part because that’s what’s\n      new.\n    </p>\n    <p>It’s going to be great.</p>\n    <p>\n      {aside} Code in this example uses the\n      <code style=\"white-space: pre-wrap;\">.jsx</code> file extension. I\n      originally wrote it back when that was still a thing, and while I did\n      update everything to React 16+, I felt that changing filenames was\n      unnecessary. {/aside}\n    </p>"
        },
        {
          "lectureTitle": "Here's how it works",
          "lectureBody": "    <h2 id=\"heres-how-it-works\">Here’s how it works</h2>\n    <p>\n      We use <strong>React to render everything</strong>: the page, the SVG\n      element, the particles inside. This lets us tap into React’s algorithms\n      that decide which nodes to update and when to garbage collect old nodes.\n    </p>\n    <p>\n      Then we use some <strong>d3 calculations and event detection</strong>. D3\n      has great random generators, so we take advantage of that. D3’s mouse and\n      touch event handlers calculate coordinates relative to our SVG. We need\n      those, but React’s click handlers are based on DOM nodes, which don’t\n      correspond to\n      <code style=\"white-space: pre-wrap;\">(x, y)</code> coordinates. D3 looks\n      at real cursor position on screen.\n    </p>\n    <p>\n      All <strong>particle coordinates are in a Redux store</strong>. Each\n      particle also has a movement vector. The store holds some useful flags\n      and general parameters, as well. This lets us treat animation as data\n      transformations. I’ll show you what that means.\n    </p>\n    <p>\n      We use <strong>actions to communicate user events</strong> like creating\n      particles, starting the animation, changing mouse position, and so on. On\n      each requestAnimationFrame, we\n      <strong>dispatch an “advance animation” action</strong>.\n    </p>\n    <p>\n      On each action, the <strong>reducer calculates a new state</strong> for\n      the whole app. This includes <strong>new particle positions</strong> for\n      each step of the animation.\n    </p>\n    <p>\n      When the store updates, <strong>React flushes changes</strong> via props\n      and because <strong>coordinates are state, the particles move</strong>.\n    </p>\n    <p>\n      The result is smooth animation. Just like the game loop example from\n      before.\n    </p>"
        },
        {
          "lectureTitle": "Some basic terminology",
          "lectureBody": "    <h2 id=\"some-basic-terminology\">Some basic terminology</h2>\n    <p>\n      We’re about to throw around some terms. You’ll understand what they mean\n      in detail after this chapter.\n    </p>\n    <p>Until then, here’s a quick glossary so you don’t feel lost:</p>\n    <p>\n      <strong>The store, or the state</strong>, is Redux state. Held globally\n      and shared by all components. It’s like the App local state from earlier\n      chapters.\n    </p>\n    <p>\n      <strong>Actions</strong> are packets of information that tell us what\n      happened.\n    </p>\n    <p>\n      <strong>Reducers</strong> are functions that take the current state and\n      an action, and use that information to generate a new state.\n    </p>\n    <p>Got it? No worries. You will soon 😃</p>"
        },
        {
          "lectureTitle": "3 presentation components",
          "lectureBody": "    <h2 id=\"presentation-components\">3 presentation components</h2>\n    <p>\n      We start with the presentation components because they’re the simplest.\n      To render a collection of particles, we need:\n    </p>\n    <ul>\n      <li>a stateless <code style=\"white-space: pre-wrap;\">Particle</code></li>\n      <li>\n        a stateless <code style=\"white-space: pre-wrap;\">Particles</code>\n      </li>\n      <li>a class-based <code style=\"white-space: pre-wrap;\">App</code></li>\n    </ul>\n    <p>\n      None of them contain state, but\n      <code style=\"white-space: pre-wrap;\">App</code> has to be a class-based\n      component so that we can use\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code>. We need it\n      to attach D3 event listeners.\n    </p>\n    <h3 id=\"particle\">Particle</h3>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">Particle</code> component is a\n      circle. It looks like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb144\"\n      data-caption=\"Particle component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb144-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Particles/Particle.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb144-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb144-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb144-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Particle <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb144-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>circle cx<span class=\"op\" style=\"color: #666666;\">={</span>x<span class=\"op\" style=\"color: #666666;\">}</span> cy<span class=\"op\" style=\"color: #666666;\">={</span>y<span class=\"op\" style=\"color: #666666;\">}</span> r<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;1.8&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb144-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb144-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb144-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Particle<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      It takes <code style=\"white-space: pre-wrap;\">x</code> and\n      <code style=\"white-space: pre-wrap;\">y</code> coordinates and returns an\n      SVG circle.\n    </p>\n    <h3 id=\"svg-particles\">Particles</h3>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">Particles</code> component isn’t\n      much smarter – it returns a list of circles wrapped in a grouping\n      element, like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb145\"\n      data-caption=\"Particles list\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb145-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Particles/index.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb145-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb145-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Particle <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./Particle&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb145-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb145-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Particles <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span> particles <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb145-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>g<span class=\"op\" style=\"color: #666666;\">&gt;{</span><span class=\"va\" style=\"color: #19177c;\">particles</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>(particle <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb145-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>Particle key<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"va\" style=\"color: #19177c;\">particle</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span><span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">{</span>...<span class=\"at\" style=\"color: #7d9029;\">particle</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb145-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb145-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb145-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb145-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb145-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Particles<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Walk through the array of particles, render a Particle component for\n      each. Declarative rendering that you’ve seen before 😃\n    </p>\n    <p>\n      We can take an array of\n      <code style=\"white-space: pre-wrap;\">{id, x, y}</code> objects and render\n      SVG circles. Now comes our first fun component: the\n      <code style=\"white-space: pre-wrap;\">App</code>.\n    </p>\n    <h3 id=\"app\">App</h3>\n    <p>\n      <code style=\"white-space: pre-wrap;\">App</code> takes care of rendering\n      the scene and attaching d3 event listeners. It gets actions via props and\n      ties them to mouse events. You can think of actions as callbacks that\n      work on the global data store directly. No need to pass them through many\n      levels of props.\n    </p>\n    <p>The rendering part looks like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb146\"\n      data-caption=\"App component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb146-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/index.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb146-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb146-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> Component <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb146-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> select <span class=\"im\">as</span> d3Select<span class=\"op\" style=\"color: #666666;\">,</span> mouse <span class=\"im\">as</span> d3Mouse<span class=\"op\" style=\"color: #666666;\">,</span> touches <span class=\"im\">as</span> d3Touches <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;d3&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb146-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb146-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Particles <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./Particles&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb146-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Footer <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./Footer&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb146-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Header <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./Header&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb146-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb146-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb146-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb146-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb146-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb146-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"op\" style=\"color: #666666;\">&lt;</span>div onMouseDown<span class=\"op\" style=\"color: #666666;\">={</span>e <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">startTicker</span>()<span class=\"op\" style=\"color: #666666;\">}</span> style<span class=\"op\" style=\"color: #666666;\">={{</span><span class=\"dt\">overflow</span><span class=\"op\">:</span> <span class=\"st\">&#39;hidden&#39;</span><span class=\"op\">}}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb146-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">           <span class=\"op\" style=\"color: #666666;\">&lt;</span>Header /<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb146-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">           <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">svgWidth</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb146-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">svgHeight</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb146-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                ref<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;svg&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb146-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                style<span class=\"op\" style=\"color: #666666;\">={{</span><span class=\"dt\">background</span><span class=\"op\">:</span> <span class=\"st\">&#39;rgba(124, 224, 249, .3)&#39;</span><span class=\"op\">}}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb146-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">               <span class=\"op\" style=\"color: #666666;\">&lt;</span>Particles particles<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">particles</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb146-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">           &lt;/svg<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb146-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">           <span class=\"op\" style=\"color: #666666;\">&lt;</span>Footer N<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"va\" style=\"color: #19177c;\">particles</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb146-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">       &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb146-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb146-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb146-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb146-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb146-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> App<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      There’s more going on, but the gist is that we return a\n      <code style=\"white-space: pre-wrap;\">&lt;div&gt;</code> with a\n      <code style=\"white-space: pre-wrap;\">Header</code>, a\n      <code style=\"white-space: pre-wrap;\">Footer</code>, and an\n      <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code>. Inside\n      <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code>, we use\n      <code style=\"white-space: pre-wrap;\">Particles</code> to render many\n      circles. The Header and Footer components are just some helpful text.\n    </p>\n    <p>\n      Notice that the core of our rendering function only says\n      <em>“Put all Particles here, please”</em>. There’s nothing about what’s\n      moved, what’s new, or what’s no longer needed. We don’t have to worry\n      about that.\n    </p>\n    <p>\n      We get a list of coordinates and naively render some circles. React takes\n      care of the rest.\n    </p>\n    <p>\n      Oh, and we call\n      <code style=\"white-space: pre-wrap;\">startTicker()</code> when a user\n      clicks on our scene. No reason to have the clock running\n      <em>before</em> any particles exist.\n    </p>\n    <h4 id=\"d3-event-listeners\">D3 event listeners</h4>\n    <p>\n      To let users generate particles, we have to wire up some functions in\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code>. That looks\n      like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb147\"\n      data-caption=\"Event listeners\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb147-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/index.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb147-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb147-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    svgWrap <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">createRef</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb147-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> svg <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">d3Select</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svgWrap</span>.<span class=\"at\" style=\"color: #7d9029;\">current</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb147-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;mousedown&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateMousePos</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">startParticles</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;touchstart&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateTouchPos</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">startParticles</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;mousemove&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateMousePos</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;touchmove&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">updateTouchPos</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;mouseup&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">stopParticles</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;touchend&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">stopParticles</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;mouseleave&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">stopParticles</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb147-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb147-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">updateMousePos</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> [x<span class=\"op\" style=\"color: #666666;\">,</span> y] <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">d3Mouse</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svgWrap</span>.<span class=\"at\" style=\"color: #7d9029;\">current</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">updateMousePos</span>(x<span class=\"op\" style=\"color: #666666;\">,</span> y)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb147-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb147-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">updateTouchPos</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb147-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> [x<span class=\"op\" style=\"color: #666666;\">,</span> y] <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">d3Touches</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svgWrap</span>.<span class=\"at\" style=\"color: #7d9029;\">current</span>)[<span class=\"dv\" style=\"color: #40a070;\">0</span>]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">updateMousePos</span>(x<span class=\"op\" style=\"color: #666666;\">,</span> y)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb147-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>There are several events we take into account:</p>\n    <ul>\n      <li>\n        <code style=\"white-space: pre-wrap;\">mousedown</code> and\n        <code style=\"white-space: pre-wrap;\">touchstart</code> turn on particle\n        generation\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">mousemove</code> and\n        <code style=\"white-space: pre-wrap;\">touchmove</code> update the mouse\n        location\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">mouseup</code>,\n        <code style=\"white-space: pre-wrap;\">touchend</code>, and\n        <code style=\"white-space: pre-wrap;\">mouseleave</code> turn off\n        particle generation\n      </li>\n    </ul>\n    <p>\n      Inside our event callbacks, we use\n      <code style=\"white-space: pre-wrap;\">updateMousePos</code> and\n      <code style=\"white-space: pre-wrap;\">updateTouchPos</code> to update\n      Redux state. They use\n      <code style=\"white-space: pre-wrap;\">d3Mouse</code> and\n      <code style=\"white-space: pre-wrap;\">d3Touches</code> to get\n      <code style=\"white-space: pre-wrap;\">(x, y)</code> coordinates for new\n      particles relative to our SVG element and call Redux actions passed-in\n      via props. The particle generation step uses this data as each particle’s\n      initial position.\n    </p>\n    <p>\n      You’ll see that in the next section. I agree, it smells kind of\n      convoluted, but it’s for good reason: We need a reference to a mouse\n      event to get the cursor position, and we want to decouple particle\n      generation from event handling.\n    </p>\n    <p>\n      Remember, React isn’t smart enough to figure out mouse position relative\n      to our drawing area. React knows that we clicked a DOM node.\n      <a href=\"https://github.com/d3/d3-selection/blob/master/src/mouse.js\"\n        >D3 does some magic</a\n      >\n      to find exact coordinates.\n    </p>\n    <p>\n      Touch events return lists of coordinates. One for each finger. We use\n      only the first coordinate because shooting particles out of multiple\n      fingers would make this example too hard.\n    </p>\n    <p>\n      That’s it for rendering and user events.\n      <a\n        href=\"https://github.com/Swizec/react-particles-experiment/blob/svg-based-branch/src/components/index.jsx\"\n        >107 lines of code</a\n      >.\n    </p>"
        },
        {
          "lectureTitle": "6 Redux Actions",
          "lectureBody": "    <h2 id=\"redux-actions\">6 Redux Actions</h2>\n    <p>\n      Redux actions are a fancy way of saying <em>“Yo, a thing happened!”</em>.\n      They’re functions you call to get structured metadata that’s passed into\n      Redux reducers.\n    </p>\n    <p>Our particle generator uses 6 actions:</p>\n    <ol type=\"1\">\n      <li>\n        <code style=\"white-space: pre-wrap;\">tickTime</code> steps our\n        animation to the next frame\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">tickerStarted</code> fires when\n        everything begins\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">startParticles</code> fires when\n        we hold down the mouse\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">stopParticles</code> fires when we\n        release\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">updateMousePos</code> keeps mouse\n        position saved in state\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">resizeScreen</code> saves new\n        screen size so we know where edges lie\n      </li>\n    </ol>\n    <p>Our actions look something like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb148\"\n      data-caption=\"A Redux action\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb148-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> <span class=\"at\" style=\"color: #7d9029;\">updateMousePos</span>(x<span class=\"op\" style=\"color: #666666;\">,</span> y) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb148-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb148-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">type</span><span class=\"op\" style=\"color: #666666;\">:</span> UPDATE_MOUSE_POS<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb148-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> x<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb148-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> y</a>\n<a class=\"sourceLine\" id=\"cb148-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb148-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      A function that accepts params and returns an object with a type and meta\n      data. Technically this is an action generator and the object is an\n      action, but that distinction has long since been lost in the community.\n    </p>\n    <p>\n      Actions <em>must</em> have a\n      <code style=\"white-space: pre-wrap;\">type</code>. Reducers use the type\n      to decide what to do. The rest is optional.\n    </p>\n    <p>\n      You can see\n      <a\n        href=\"https://github.com/Swizec/react-particles-experiment/blob/master/src/actions/index.js\"\n        >all the actions on GitHub</a\n      >.\n    </p>\n    <p>\n      I find this to be the least elegant part of Redux. Makes sense in large\n      applications, but way too convoluted for small apps. Simpler alternatives\n      exist like doing it yourself with React Context.\n    </p>"
        },
        {
          "lectureTitle": "1 Container component",
          "lectureBody": "    <h2 id=\"container-component\">1 Container component</h2>\n    <p>Containers are React components that talk to the Redux data store.</p>\n    <p>\n      You can think of presentation components as templates that render stuff\n      and containers as smart-ish views that talk to controllers. Or maybe\n      they’re the controllers.\n    </p>\n    <p>\n      Sometimes it’s hard to tell. In theory presentation components render and\n      don’t think, containers communicate and don’t render. Redux reducers and\n      actions do the thinking.\n    </p>\n    <p>I’m not sure this separation is necessary in small projects.</p>\n    <p>\n      Maintaining it can be awkward and sometimes cumbersome in mid-size\n      projects, but I’m sure it makes total sense at Facebook scale. We’re\n      using it in this project because the community has decided that’s the way\n      to go.\n    </p>\n    <p>\n      We use the idiomatic\n      <code style=\"white-space: pre-wrap;\">connect()</code> approach. Like\n      this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb149\"\n      data-caption=\"Main container component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb149-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/containers/AppContainer.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb149-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb149-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> connect <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react-redux&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> Component <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;react&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"im\">as</span> d3 <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb149-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> App <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;../components&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb149-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    tickTime<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    tickerStarted<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    startParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    stopParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    updateMousePos</a>\n<a class=\"sourceLine\" id=\"cb149-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;../actions&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb149-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> AppContainer <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb149-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    startTicker <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb149-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> isTickerStarted <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb149-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"op\" style=\"color: #666666;\">!</span>isTickerStarted) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb149-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">console</span>.<span class=\"at\" style=\"color: #7d9029;\">log</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;Starting ticker&quot;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">tickerStarted</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">timer</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">tickTime</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb149-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb149-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb149-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb149-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> svgWidth<span class=\"op\" style=\"color: #666666;\">,</span> svgHeight<span class=\"op\" style=\"color: #666666;\">,</span> particles <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb149-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb149-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>App</a>\n<a class=\"sourceLine\" id=\"cb149-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                svgWidth<span class=\"op\" style=\"color: #666666;\">={</span>svgWidth<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb149-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                svgHeight<span class=\"op\" style=\"color: #666666;\">={</span>svgHeight<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb149-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                particles<span class=\"op\" style=\"color: #666666;\">={</span>particles<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb149-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                startTicker<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">startTicker</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb149-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                startParticles<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">startParticles</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb149-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                stopParticles<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">stopParticles</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb149-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                updateMousePos<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">updateMousePos</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb149-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            /&gt;</a>\n<a class=\"sourceLine\" id=\"cb149-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb149-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb149-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb149-44\" title=\"44\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> mapStateToProps <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb149-45\" title=\"45\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    generateParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-46\" title=\"46\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    mousePos<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-47\" title=\"47\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    particlesPerTick<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-48\" title=\"48\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    isTickerStarted<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-49\" title=\"49\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    svgWidth<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-50\" title=\"50\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    svgHeight<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-51\" title=\"51\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    particles</a>\n<a class=\"sourceLine\" id=\"cb149-52\" title=\"52\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb149-53\" title=\"53\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    generateParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-54\" title=\"54\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    mousePos<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-55\" title=\"55\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    particlesPerTick<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-56\" title=\"56\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    isTickerStarted<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-57\" title=\"57\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    svgWidth<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-58\" title=\"58\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    svgHeight<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-59\" title=\"59\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    particles</a>\n<a class=\"sourceLine\" id=\"cb149-60\" title=\"60\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb149-61\" title=\"61\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb149-62\" title=\"62\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> mapDispatchToProps <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb149-63\" title=\"63\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    tickTime<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-64\" title=\"64\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    tickerStarted<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-65\" title=\"65\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    startParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-66\" title=\"66\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    stopParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-67\" title=\"67\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    updateMousePos</a>\n<a class=\"sourceLine\" id=\"cb149-68\" title=\"68\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb149-69\" title=\"69\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb149-70\" title=\"70\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> <span class=\"at\" style=\"color: #7d9029;\">connect</span>(</a>\n<a class=\"sourceLine\" id=\"cb149-71\" title=\"71\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    mapStateToProps<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb149-72\" title=\"72\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    mapDispatchToProps</a>\n<a class=\"sourceLine\" id=\"cb149-73\" title=\"73\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)(AppContainer)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>I love the smell of boilerplate in the morning. 👃</p>\n    <p>\n      We import dependencies and define\n      <code style=\"white-space: pre-wrap;\">AppContainer</code> as a class-based\n      React <code style=\"white-space: pre-wrap;\">Component</code> so we have\n      somewhere to put the D3 interval. The render method outputs our\n      <code style=\"white-space: pre-wrap;\">&lt;App&gt;</code> component using a\n      bunch of props to pass relevant actions and values.\n    </p>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">startTicker</code> method is a\n      callback we pass into App. It runs on first click and starts the D3\n      interval if necessary. Each interval iteration triggers the\n      <code style=\"white-space: pre-wrap;\">tickTime</code> action.\n    </p>\n    <h3 id=\"appcontainer-talks-to-the-store\">\n      AppContainer talks to the store\n    </h3>\n    <div\n      class=\"sourceCode\"\n      id=\"cb150\"\n      data-caption=\"The Reduxy part\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb150-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/containers/AppContainer.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb150-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb150-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> mapStateToProps <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb150-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    generateParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    mousePos<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    particlesPerTick<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    isTickerStarted<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    svgWidth<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    svgHeight<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    particles</a>\n<a class=\"sourceLine\" id=\"cb150-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb150-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    generateParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    mousePos<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    particlesPerTick<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    isTickerStarted<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    svgWidth<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    svgHeight<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    particles</a>\n<a class=\"sourceLine\" id=\"cb150-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb150-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb150-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> mapDispatchToProps <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb150-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    tickTime<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    tickerStarted<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    startParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    stopParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    updateMousePos</a>\n<a class=\"sourceLine\" id=\"cb150-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb150-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb150-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> <span class=\"at\" style=\"color: #7d9029;\">connect</span>(</a>\n<a class=\"sourceLine\" id=\"cb150-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    mapStateToProps<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb150-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    mapDispatchToProps</a>\n<a class=\"sourceLine\" id=\"cb150-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">)(AppContainer)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We’re using the\n      <code style=\"white-space: pre-wrap;\">connect()</code> idiom to connect\n      our AppContainer to the Redux store. It’s a higher order component that\n      handles all the details of connection to the store and staying in sync.\n    </p>\n    <p>\n      We pass two arguments into connect. This returns a higher order component\n      function, which we wrap around AppContainer.\n    </p>\n    <p>\n      The first argument is <strong>mapStateToProps</strong>. It accepts\n      current state as an argument, which we immediately deconstruct into\n      interesting parts, and returns a key:value dictionary. Each key becomes a\n      component prop with the corresponding value.\n    </p>\n    <p>\n      You’d often use this opportunity to run ad-hoc calculations, or combine\n      parts of state into single props. No need for that in our case, just pass\n      it through.\n    </p>\n    <h4 id=\"dispatching-actions\">Dispatching actions</h4>\n    <p>\n      <strong>mapDispatchToProps</strong> is a dictionary that maps props to\n      actions. Each prop turns into an action generator wrapped in a\n      <code style=\"white-space: pre-wrap;\">store.dispatch()</code> call. To\n      fire an action inside a component we just call the function in that prop.\n    </p>\n    <p>\n      But Swiz, we’re not writing key:value dictionaries, we’re just listing\n      stuff!\n    </p>\n    <p>\n      That’s a syntax supported in most modern JavaScript environments, called\n      object literal property value shorthand. Our build system expands that\n      <code style=\"white-space: pre-wrap;\">mapDispatchToProps</code> dictionary\n      into something like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb151\"\n      data-caption=\"Compiler expands our dictionaries\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb151-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> mapDispatchToProps <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb151-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">tickTime</span><span class=\"op\" style=\"color: #666666;\">:</span> tickTime<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb151-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">tickerStarted</span><span class=\"op\" style=\"color: #666666;\">:</span> tickerStarted<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb151-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">startParticles</span><span class=\"op\" style=\"color: #666666;\">:</span> startParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb151-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">stopParticles</span><span class=\"op\" style=\"color: #666666;\">:</span> stopParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb151-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">updateMousePos</span><span class=\"op\" style=\"color: #666666;\">:</span> updateMousePos</a>\n<a class=\"sourceLine\" id=\"cb151-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      And you thought previous code had a lot of boilerplate … imagine if this\n      was how you’d do it in real life 😛\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">connect</code> wraps each of these\n      action generators in\n      <code style=\"white-space: pre-wrap;\">store.dispatch()</code> calls. You\n      can pass the resulting function into any component and fire actions by\n      calling that method.\n    </p>\n    <h4 id=\"the-redux-loop\">The Redux loop</h4>\n    <p>To make a change therefore, a Redux loop unfolds:</p>\n    <ol type=\"1\">\n      <li>Call our action triggerer, passed in through props</li>\n      <li>\n        Calls the generator, gets a\n        <code style=\"white-space: pre-wrap;\">{type: ...}</code> object\n      </li>\n      <li>Dispatches that object on the store</li>\n      <li>Redux calls the reducer</li>\n      <li>Reducer creates new state</li>\n      <li>\n        Store updates triggering React’s engine to flow updates through the\n        props\n      </li>\n    </ol>\n    <p>So that’s the container. 71 lines of boilerplate pretty code.</p>\n    <p>\n      The remaining piece of the puzzle is our reducer. Two reducers in fact.\n    </p>"
        },
        {
          "lectureTitle": "2 Redux Reducers",
          "lectureBody": "    <h2 id=\"redux-reducers\">2 Redux Reducers</h2>\n    <p>\n      With the actions firing and the drawing done, it’s time to look at the\n      business logic of our particle generator. We’ll get it done in just 33\n      lines of code and some change.\n    </p>\n    <p>\n      Well, it’s a bunch of change. But the 33 lines that make up\n      <code style=\"white-space: pre-wrap;\">CREATE_PARTICLES</code> and\n      <code style=\"white-space: pre-wrap;\">TIME_TICK</code> changes are the\n      most interesting. The rest just flips various flags.\n    </p>\n    <p>\n      All our logic and physics goes in the reducer.\n      <a href=\"https://redux.js.org/docs/basics/Reducers.html\"\n        >Dan Abramov says</a\n      >\n      to think of reducers as the function you’d put in\n      <code style=\"white-space: pre-wrap;\">.reduce()</code>. Given a state and\n      a set of changes, how do I create the new state?\n    </p>\n    <p>A “sum numbers” example would look like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb152\"\n      data-caption=\"Reducer concept\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb152-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> sum <span class=\"op\" style=\"color: #666666;\">=</span> [<span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">3</span><span class=\"op\" style=\"color: #666666;\">,</span><span class=\"dv\" style=\"color: #40a070;\">4</span>].<span class=\"at\" style=\"color: #7d9029;\">reduce</span>((sum<span class=\"op\" style=\"color: #666666;\">,</span> n) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> sum<span class=\"op\" style=\"color: #666666;\">+</span>n<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>For each number, take the previous sum and add the number.</p>\n    <p>\n      Our particle generator is a more advanced version of the same concept:\n      Takes current application state, incorporates an action, and returns new\n      application state.\n    </p>\n    <p>Start with a default state and some D3 random number helpers.</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb153\"\n      data-caption=\"Default state and constants\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb153-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> randomNormal <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb153-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb153-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Gravity <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"fl\" style=\"color: #40a070;\">0.5</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb153-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    randNormal <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">randomNormal</span>(<span class=\"fl\" style=\"color: #40a070;\">0.3</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">2</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb153-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    randNormal2 <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">randomNormal</span>(<span class=\"fl\" style=\"color: #40a070;\">0.5</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"fl\" style=\"color: #40a070;\">1.</span><span class=\"op\" style=\"color: #666666;\">:</span>sunglasses<span class=\"op\" style=\"color: #666666;\">:;</span></a>\n<a class=\"sourceLine\" id=\"cb153-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb153-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> initialState <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb153-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">particles</span><span class=\"op\" style=\"color: #666666;\">:</span> []<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb153-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">particleIndex</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb153-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">particlesPerTick</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">30</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb153-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">svgWidth</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">800</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb153-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">svgHeight</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">600</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb153-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">isTickerStarted</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">false</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb153-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">generateParticles</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">false</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb153-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">mousePos</span><span class=\"op\" style=\"color: #666666;\">:</span> [<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb153-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">lastFrameTime</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span></a>\n<a class=\"sourceLine\" id=\"cb153-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      Using D3’s\n      <code style=\"white-space: pre-wrap;\">randomNormal</code> random number\n      generator creates a better random distribution than using JavaScript’s\n      own <code style=\"white-space: pre-wrap;\">Math.random</code>. The rest is\n      a bunch of default state 👇\n    </p>\n    <ul>\n      <li>\n        <code style=\"white-space: pre-wrap;\">particles</code> holds an array of\n        particles to draw\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">particleIndex</code> defines the\n        ID of the next generated particle\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">particlesPerTick</code> defines\n        how many particles we create on each requestAnimationFrame\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">svgWidth</code> is the width of\n        our drawing area\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">svgHeigh</code> is the height\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">isTickerStarted</code> specifies\n        whether the animation is running\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">generateParticles</code> turns\n        particle generation on and off\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">mousePos</code> defines the\n        origination point for new particles\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">lastFrameTime</code> helps us\n        compensate for dropped frames\n      </li>\n    </ul>\n    <p>\n      To manipulate all this state, we use two reducers and manually combine\n      them. Redux does come with a\n      <code style=\"white-space: pre-wrap;\">combineReducers</code> function, but\n      I wanted to keep our state flat and that doesn’t fit\n      <code style=\"white-space: pre-wrap;\">combineReducers</code>’s view of how\n      life should work.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb154\"\n      data-caption=\"Combining two reducers\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb154-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/reducers/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb154-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb154-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// Manually combineReducers</span></a>\n<a class=\"sourceLine\" id=\"cb154-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span>(state <span class=\"op\" style=\"color: #666666;\">=</span> initialState<span class=\"op\" style=\"color: #666666;\">,</span> action) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb154-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb154-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        ...<span class=\"at\" style=\"color: #7d9029;\">appReducer</span>(state<span class=\"op\" style=\"color: #666666;\">,</span> action)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb154-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        ...<span class=\"at\" style=\"color: #7d9029;\">particlesReducer</span>(state<span class=\"op\" style=\"color: #666666;\">,</span> action)</a>\n<a class=\"sourceLine\" id=\"cb154-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb154-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      This is our reducer. It takes current\n      <code style=\"white-space: pre-wrap;\">state</code>, sets it to\n      <code style=\"white-space: pre-wrap;\">initialState</code> if undefined,\n      and an action. To create new state, it spreads the object returned from\n      <code style=\"white-space: pre-wrap;\">appReducer</code> and from\n      <code style=\"white-space: pre-wrap;\">particlesReducer</code> into a new\n      object. You can combine as many reducers as you want in this way.\n    </p>\n    <p>\n      The usual\n      <code style=\"white-space: pre-wrap;\">combineReducers</code> approach\n      leads to nested hierarchical state. That often works great, but I wanted\n      to keep our state flat.\n    </p>\n    <p>\n      Lesson here is that there are no rules. You can make your reducers\n      whatever you want. Combine them whichever way fits your use case. As long\n      as you take a state object and an action and return a new state object.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">appReducer</code> will handle the\n      constants and booleans and drive the metadata for our animation.\n      <code style=\"white-space: pre-wrap;\">particlesReducer</code> will do the\n      hard work of generating and animating particles.\n    </p>\n    <h3 id=\"driving-the-basics-with-appreducer\">\n      Driving the basics with appReducer\n    </h3>\n    <p>\n      Our <code style=\"white-space: pre-wrap;\">appReducer</code> handles the\n      boring actions with a big switch statement. These are common in the Redux\n      world. They help us decide what to do based on action type.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb155\"\n      data-caption=\"appReducer big switch\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb155-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/reducers/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb155-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> <span class=\"at\" style=\"color: #7d9029;\">appReducer</span>(state<span class=\"op\" style=\"color: #666666;\">,</span> action) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb155-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">switch</span> (<span class=\"va\" style=\"color: #19177c;\">action</span>.<span class=\"at\" style=\"color: #7d9029;\">type</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb155-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">case</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;TICKER_STARTED&quot;</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb155-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">Object</span>.<span class=\"at\" style=\"color: #7d9029;\">assign</span>(<span class=\"op\" style=\"color: #666666;\">{},</span> state<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb155-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">isTickerStarted</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb155-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">lastFrameTime</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Date</span>()</a>\n<a class=\"sourceLine\" id=\"cb155-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb155-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">case</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;START_PARTICLES&quot;</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb155-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">Object</span>.<span class=\"at\" style=\"color: #7d9029;\">assign</span>(<span class=\"op\" style=\"color: #666666;\">{},</span> state<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb155-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">generateParticles</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">true</span></a>\n<a class=\"sourceLine\" id=\"cb155-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb155-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">case</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;STOP_PARTICLES&quot;</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb155-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">Object</span>.<span class=\"at\" style=\"color: #7d9029;\">assign</span>(<span class=\"op\" style=\"color: #666666;\">{},</span> state<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb155-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">generateParticles</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">false</span></a>\n<a class=\"sourceLine\" id=\"cb155-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb155-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">case</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;UPDATE_MOUSE_POS&quot;</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb155-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">Object</span>.<span class=\"at\" style=\"color: #7d9029;\">assign</span>(<span class=\"op\" style=\"color: #666666;\">{},</span> state<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb155-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">mousePos</span><span class=\"op\" style=\"color: #666666;\">:</span> [<span class=\"va\" style=\"color: #19177c;\">action</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"va\" style=\"color: #19177c;\">action</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span>]</a>\n<a class=\"sourceLine\" id=\"cb155-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb155-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">case</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;RESIZE_SCREEN&quot;</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb155-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">Object</span>.<span class=\"at\" style=\"color: #7d9029;\">assign</span>(<span class=\"op\" style=\"color: #666666;\">{},</span> state<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb155-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">svgWidth</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">action</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb155-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">svgHeight</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">action</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span></a>\n<a class=\"sourceLine\" id=\"cb155-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb155-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">default</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb155-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> state<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb155-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb155-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>Gotta love that boilerplate 😛</p>\n    <p>\n      Even though we’re only changing values of boolean flags and two-digit\n      arrays, <em>we have to create a new state</em>. Redux relies on\n      application state being immutable.\n    </p>\n    <p>\n      Well, JavaScript doesn’t have real immutability. We pretend and make sure\n      to never change state without making a new copy first. There are\n      libraries that give you proper immutable data structures, but that’s a\n      whole different course.\n    </p>\n    <p>\n      We use\n      <code style=\"white-space: pre-wrap;\">Object.assign({}, ...</code> to\n      create a new empty object, fill it with the current state, then overwrite\n      specific values with new ones. This is fast enough even with large state\n      trees thanks to modern JavaScript engines.\n    </p>\n    <p>\n      Note that when a reducer doesn’t recognize an action, it has to return\n      the same state it received. Otherwise you end up wiping state. 😅\n    </p>\n    <p>\n      So that’s the boilerplatey state updates. Manages starting and stopping\n      the animation, flipping the particle generation switch, and resizing our\n      viewport.\n    </p>\n    <p>\n      The fun stuff happens in\n      <code style=\"white-space: pre-wrap;\">particleReducer</code>.\n    </p>\n    <h3 id=\"driving-particles-with-particlereducer\">\n      Driving particles with particleReducer\n    </h3>\n    <p>\n      Our particles live in an array. Each particle has an id, a position, and\n      a vector. That tells us where to draw the particle and how to move it to\n      its future position.\n    </p>\n    <p>On each tick of the animation we have to:</p>\n    <ol type=\"1\">\n      <li>Generate new particles</li>\n      <li>Remove particles outside the viewport</li>\n      <li>Move every particle by its vector</li>\n    </ol>\n    <p>We can do all that in one big reducer, like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb156\"\n      data-caption=\"The particles logic\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb156-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/reducers/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb156-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> <span class=\"at\" style=\"color: #7d9029;\">particlesReducer</span>(state<span class=\"op\" style=\"color: #666666;\">,</span> action) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb156-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">switch</span> (<span class=\"va\" style=\"color: #19177c;\">action</span>.<span class=\"at\" style=\"color: #7d9029;\">type</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb156-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">case</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;TIME_TICK&quot;</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb156-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb156-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    svgWidth<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    svgHeight<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    lastFrameTime<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    generateParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    particlesPerTick<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    particleIndex<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    mousePos</a>\n<a class=\"sourceLine\" id=\"cb156-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> state<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                newFrameTime <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Date</span>()<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                multiplier <span class=\"op\" style=\"color: #666666;\">=</span> (newFrameTime <span class=\"op\" style=\"color: #666666;\">-</span> lastFrameTime) / (<span class=\"dv\" style=\"color: #40a070;\">1000</span> / <span class=\"dv\" style=\"color: #40a070;\">60</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                newParticles <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"va\" style=\"color: #19177c;\">particles</span>.<span class=\"at\" style=\"color: #7d9029;\">slice</span>(<span class=\"dv\" style=\"color: #40a070;\">0</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb156-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (generateParticles) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb156-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">for</span> (<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> i <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">;</span> i <span class=\"op\" style=\"color: #666666;\">&lt;</span> particlesPerTick<span class=\"op\" style=\"color: #666666;\">;</span> i<span class=\"op\" style=\"color: #666666;\">++</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb156-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> particle <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb156-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"dt\" style=\"color: #902000;\">id</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">particleIndex</span> <span class=\"op\" style=\"color: #666666;\">+</span> i<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> mousePos[<span class=\"dv\" style=\"color: #40a070;\">0</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> mousePos[<span class=\"dv\" style=\"color: #40a070;\">1</span>]</a>\n<a class=\"sourceLine\" id=\"cb156-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb156-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb156-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"va\" style=\"color: #19177c;\">particle</span>.<span class=\"at\" style=\"color: #7d9029;\">vector</span> <span class=\"op\" style=\"color: #666666;\">=</span> [</a>\n<a class=\"sourceLine\" id=\"cb156-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"va\" style=\"color: #19177c;\">particle</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span> <span class=\"op\" style=\"color: #666666;\">%</span> <span class=\"dv\" style=\"color: #40a070;\">2</span> <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"op\" style=\"color: #666666;\">-</span><span class=\"at\" style=\"color: #7d9029;\">randNormal</span>() : <span class=\"at\" style=\"color: #7d9029;\">randNormal</span>()<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"op\" style=\"color: #666666;\">-</span><span class=\"at\" style=\"color: #7d9029;\">randNormal2</span>() <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"fl\" style=\"color: #40a070;\">3.3</span></a>\n<a class=\"sourceLine\" id=\"cb156-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    ]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb156-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"va\" style=\"color: #19177c;\">newParticles</span>.<span class=\"at\" style=\"color: #7d9029;\">unshift</span>(particle)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb156-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb156-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                particleIndex <span class=\"op\" style=\"color: #666666;\">=</span> particleIndex <span class=\"op\" style=\"color: #666666;\">+</span> particlesPerTick <span class=\"op\" style=\"color: #666666;\">+</span> <span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb156-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb156-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> movedParticles <span class=\"op\" style=\"color: #666666;\">=</span> newParticles</a>\n<a class=\"sourceLine\" id=\"cb156-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                .<span class=\"at\" style=\"color: #7d9029;\">filter</span>(p <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb156-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">!</span>(<span class=\"va\" style=\"color: #19177c;\">p</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span> <span class=\"op\" style=\"color: #666666;\">&gt;</span> svgHeight <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"va\" style=\"color: #19177c;\">p</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span> <span class=\"dv\" style=\"color: #40a070;\">0</span> <span class=\"op\" style=\"color: #666666;\">||</span> <span class=\"va\" style=\"color: #19177c;\">p</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span> <span class=\"op\" style=\"color: #666666;\">&gt;</span> svgWidth)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb156-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                .<span class=\"at\" style=\"color: #7d9029;\">map</span>(p <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb156-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> [vx<span class=\"op\" style=\"color: #666666;\">,</span> vy] <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">p</span>.<span class=\"at\" style=\"color: #7d9029;\">vector</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"va\" style=\"color: #19177c;\">p</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span> <span class=\"op\" style=\"color: #666666;\">+=</span> vx <span class=\"op\" style=\"color: #666666;\">*</span> multiplier<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-44\" title=\"44\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"va\" style=\"color: #19177c;\">p</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span> <span class=\"op\" style=\"color: #666666;\">+=</span> vy <span class=\"op\" style=\"color: #666666;\">*</span> multiplier<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-45\" title=\"45\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"va\" style=\"color: #19177c;\">p</span>.<span class=\"at\" style=\"color: #7d9029;\">vector</span>[<span class=\"dv\" style=\"color: #40a070;\">1</span>] <span class=\"op\" style=\"color: #666666;\">+=</span> Gravity <span class=\"op\" style=\"color: #666666;\">*</span> multiplier<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-46\" title=\"46\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> p<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-47\" title=\"47\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb156-48\" title=\"48\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb156-49\" title=\"49\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb156-50\" title=\"50\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">particles</span><span class=\"op\" style=\"color: #666666;\">:</span> movedParticles<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-51\" title=\"51\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">lastFrameTime</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Date</span>()<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-52\" title=\"52\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                particleIndex</a>\n<a class=\"sourceLine\" id=\"cb156-53\" title=\"53\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb156-54\" title=\"54\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">default</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb156-55\" title=\"55\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb156-56\" title=\"56\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">particles</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">particles</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-57\" title=\"57\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">lastFrameTime</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">lastFrameTime</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb156-58\" title=\"58\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">particleIndex</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">particleIndex</span></a>\n<a class=\"sourceLine\" id=\"cb156-59\" title=\"59\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb156-60\" title=\"60\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb156-61\" title=\"61\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>That’s a lot of code, I know. Let me explain 😃</p>\n    <p>\n      The first part takes important values out of\n      <code style=\"white-space: pre-wrap;\">state</code>, calculates the dropped\n      frame multiplier, and makes a new copy of the particles array with\n      <code style=\"white-space: pre-wrap;\">.slice(0)</code>. That was the\n      fastest way I could find.\n    </p>\n    <p>Then we generate new particles.</p>\n    <p>\n      We loop through\n      <code style=\"white-space: pre-wrap;\">particlesPerTick</code> particles,\n      create them at\n      <code style=\"white-space: pre-wrap;\">mousePos</code> coordinates, and\n      insert at the beginning of the array. In my tests that performed best.\n      Particles get random movement vectors.\n    </p>\n    <p>\n      This randomness is a Redux faux pas. Reducers are supposed to be\n      functionally pure: produce the same result every time they are called\n      with the same argument values. Randomness is impure.\n    </p>\n    <p>\n      We don’t need our particle vectors to be deterministic, so I think this\n      is fine. Let’s say our universe is stochastic instead 😄\n    </p>\n    <p>\n      {aside} Stochastic means that our universe/physic simulation is governed\n      by probabilities. You can still model such a universe and reason about\n      its behavior. A lot of real world physics is stochastic in nature.\n      {/aside}\n    </p>\n    <p>\n      We now have an array full of old and new particles. We remove all\n      out-of-bounds particles with a\n      <code style=\"white-space: pre-wrap;\">filter</code>, then walk through\n      what’s left to move each particle by its vector.\n    </p>\n    <p>\n      To simulate gravity, we update vectors’ vertical component using our\n      <code style=\"white-space: pre-wrap;\">Gravity</code> constant. That makes\n      particles fall down faster and faster creating a nice parabola.\n    </p>\n    <p>\n      Our reducer is done. Our particle generator works. Our thing animates\n      smoothly. \\o/\n    </p>"
        },
        {
          "lectureTitle": "What we learned",
          "lectureBody": "    <h2 id=\"what-we-learned\">What we learned</h2>\n    <p>\n      Building a particle generator in React and Redux, we made three important\n      discoveries:\n    </p>\n    <ol type=\"1\">\n      <li>\n        <strong>Redux is much faster than you’d think</strong>. Creating a new\n        copy of the state tree on each animation loop sounds crazy, but it\n        works. Most of our code creates shallow copies, which explains the\n        speed.\n      </li>\n      <li>\n        <strong>Adding to JavaScript arrays is slow</strong>. Once we hit about\n        300 particles, adding new ones becomes slow. Stop adding particles and\n        you get smooth animation. This indicates that something about creating\n        particles is slow: either adding to the array, or creating React\n        component instances, or creating SVG DOM nodes.\n      </li>\n      <li>\n        <strong>SVG is also slow</strong>. To test the above hypothesis, I made\n        the generator create 3000 particles on first click. The animation speed\n        is <em>terrible</em> at first and becomes okayish at around 1000\n        particles. This suggests that making shallow copies of big arrays and\n        moving existing SVG nodes around is faster than adding new DOM nodes\n        and array elements.\n        <a href=\"https://i.imgur.com/ug478Me.gif\">Here’s a gif</a>\n      </li>\n    </ol>\n    <hr />\n    <p>\n      There you go: Animating with React, Redux, and D3. Kind of a new\n      superpower 😉\n    </p>\n    <p>Here’s the recap:</p>\n    <ul>\n      <li>React handles rendering</li>\n      <li>D3 calculates stuff, detects mouse positions</li>\n      <li>Redux handles state</li>\n      <li>element coordinates are state</li>\n      <li>\n        change coordinates on every\n        <code style=\"white-space: pre-wrap;\">requestAnimationFrame</code>\n      </li>\n      <li>animation!</li>\n    </ul>\n    <p>\n      Now let’s render to canvas and push this sucker to 20,000 smoothly\n      animated elements. Even on a mobile phone.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Speed optimizations",
      "lectures": [
        {
          "lectureTitle": "Speed intro",
          "lectureBody": "    <h1 id=\"speed-optimizations\">Speed optimizations</h1>\n    <p>\n      Welcome to the speed optimization chapter. This is where we make our code\n      harder to read and faster to run.\n    </p>\n    <p>You might never need any techniques discussed here.</p>\n    <p>\n      You already know how to build performant data visualization components.\n      For 99% of applications, plain code that’s easy to read and understand is\n      faster than fast code that’s hard to read.\n    </p>\n    <p>\n      You and your team spend most of your time reading code. Optimize for\n      that. The faster you can code, the faster your system can evolve. Leave\n      runtime optimization to React and its ecosystem of library authors for as\n      long as you can get away with.\n    </p>\n    <p>\n      Do you really need to save that tenth of a second at runtime if it means\n      an extra hour of head scratching every time there’s a bug?\n    </p>\n    <p>Be honest. 😉</p>\n    <p>\n      That said, there <em>are</em> cases where faster code is also easier to\n      read. And there are cases where your visualization is so massive, that\n      you need every ounce of oomph you can get.\n    </p>\n    <p>For the most part, we’re going to talk about three things:</p>\n    <ul>\n      <li>using Canvas to speed up rendering</li>\n      <li>using React-like libraries to speed up the core rendering engine</li>\n      <li>avoiding unnecessary computation and redraws</li>\n      <li>reaching for WebGL when even Canvas isn’t fast enough</li>\n    </ul>\n    <p>\n      We’ll start with Canvas because it’s the best bang for buck improvement\n      you can make.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Using canvas",
      "lectures": [
        {
          "lectureTitle": "Intro",
          "lectureBody": "    <h1 id=\"using-canvas\">Using canvas</h1>\n    <p>\n      So far we’ve been rendering our visualizations with SVG. SVG is great\n      because it follows a familiar structure, offers infinitely scalable\n      vector graphics, and works everywhere. There are <em>some</em> advanced\n      SVG features you can’t use everywhere, but the core is solid.\n    </p>\n    <p>However, SVG has a big flaw: it’s slow.</p>\n    <p>\n      Anything more than a few hundred SVG nodes and your browser starts to\n      struggle. Especially if those thousands of elements move around.\n    </p>\n    <p>\n      A web animation panel moderator at ForwardJS once asked me,\n      <em>“But why would you want thousands of SVG elements?”</em>.\n    </p>\n    <p>\n      It was my first time participating in a panel, stage lights shining upon\n      me, a mildly disinterested audience staring into their phones … I bombed:\n      <em>“Errr … because you can?”</em>.\n    </p>\n    <p>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/2018/stage_lights.jpg\"\n      />\n    </p>\n    <p>\n      What I <em>should</em> have said was:\n      <em\n        >“Because there have been thousands of UFO sightings, there are\n        thousands of counties in the US, millions of taxi rides, hundreds of\n        millions of people having this or that datapoint. And you want to show\n        change over time.”</em\n      >\n    </p>\n    <p>That’s the real answer.</p>\n    <p>\n      Sometimes, when you’re visualizing data, you have a lot of data. The data\n      changes over time. Animation is the best way to show change over time.\n    </p>\n    <p>\n      Once upon a time, I worked on a\n      <a href=\"https://www.packtpub.com/web-development/mastering-d3js-video\"\n        >D3 video course</a\n      >\n      for Packt and used UFO sightings as an example. At peak UFO sighting,\n      right before smartphones become a thing, the animation takes up to 2\n      seconds to redraw a single frame.\n    </p>\n    <p>Terrible.</p>\n    <p>\n      So if SVG is slow and you need to animate thousands of elements, what are\n      you to do? HTML5 Canvas.\n    </p>"
        },
        {
          "lectureTitle": "Why canvas",
          "lectureBody": "    <h2 id=\"why-canvas\">Why Canvas</h2>\n    <p>\n      Unlike SVG, HTML5 Canvas lets you draw rasterized images. This means\n      you’re no longer operating at the level of shapes because you’re working\n      with pixels on the screen.\n    </p>\n    <p>\n      With SVG and other vector formats, you tell the browser <em>what</em> you\n      want to render. With Canvas and other raster formats, you tell the\n      browser <em>how</em> you want to render. The browser doesn’t know what\n      you’re doing; it gets a field of pixel colors and renders them as an\n      image.\n    </p>\n    <p>\n      That’s much faster for computers to handle. In some cases browsers can\n      even use hardware acceleration – the GPU – to render HTML5 Canvas\n      elements. With a bit of care, you can do almost anything you want, even\n      on a mobile phone.\n    </p>\n    <p>\n      Phones these days have amazing GPUs and kind of terrible CPUs in\n      comparison. The CPU burns more battery, works slower, warms up your phone\n      more, etc.\n    </p>\n    <p>\n      If SVG wasn’t so easy to use, I’d almost suggest going straight to Canvas\n      for any sort of complex animation. Mobile traffic is, what, 60% to 70% of\n      web traffic these days?\n    </p>"
        },
        {
          "lectureTitle": "Isn't canvas too hard?",
          "lectureBody": "    <h2 id=\"isnt-that-too-hard\">Isn’t that too hard?</h2>\n    <p>\n      You might think all this pixel stuff sounds complicated. We’ve stayed in\n      shape and component land so far. We didn’t care about any pixels or\n      rendering details. Draw a rectangle and a wild rectangle appears.\n    </p>\n    <p>\n      How do you know which pixel should do what when you render with Canvas?\n    </p>\n    <p>\n      HTML5 Canvas does offer some shape primitives. It has circles and\n      rectangles and things like that, but they suffer from the same problem\n      that SVG does. The browser has to use your CPU to calculate those, and at\n      around 10,000 elements, things break down.\n    </p>\n    <p>\n      10,000 elements is still a hell of a lot more than the 3,000 or so that\n      SVG gives you.\n    </p>\n    <p>\n      If your app allows it, you can use sprites: Tiny images copy-pasted on\n      the Canvas as bytestreams. I have yet to find an upper bound for those.\n      My JavaScript became the bottleneck 😄\n    </p>\n    <p>But I’m getting ahead of myself. We’ll talk about sprites later.</p>"
        },
        {
          "lectureTitle": "The trouble with Canvas",
          "lectureBody": "    <h2 id=\"the-trouble-with-html5-canvas\">The trouble with HTML5 Canvas</h2>\n    <p>\n      The tricky thing with HTML5 Canvas is that the API is low level and that\n      canvas is flat. As far as your JavaScript and React code are concerned,\n      it’s a flat image. It could be anything.\n    </p>\n    <p>\n      The lack of structure makes it difficult to detect clicks on elements,\n      interactions between shapes, when something covers something else, how\n      the user interacts with your stuff and so on Anything that requires\n      understanding what’s rendered.\n    </p>\n    <p>\n      You have to move most of that logic into your data store and manually\n      keep track.\n    </p>\n    <p>\n      As you can imagine, this becomes cumbersome. And you still can’t detect\n      user interaction because all you get is\n      <em>“User clicked on coordinate (x, y). Have fun.”</em>\n    </p>\n    <p>\n      At the same time, the low level API makes abstractions difficult. You\n      can’t create components for “this is a map” or “histogram goes here”.\n      You’re always down to circles and rectangles and basic shapes.\n    </p>\n    <p>\n      Your code soon looks like the D3.js spaghetti we tried to avoid in the\n      first place.\n    </p>"
        },
        {
          "lectureTitle": "Declarative Canvas with Konva and react-konva",
          "lectureBody": "    <h1 id=\"declarative-html5-canvas-with-konva-and-react-konva\">\n      Declarative HTML5 Canvas with Konva and react-konva\n    </h1>\n    <p>\n      Enter <a href=\"https://konvajs.github.io\">Konva</a> and react-konva. All\n      the benefits of declarative code, but rendered on the canvas.\n    </p>\n    <p>I’m gonna let Anton Lavrenov, the author of Konva, explain:</p>\n    <blockquote>\n      <p>\n        Konva is an HTML5 Canvas JavaScript framework that enables high\n        performance animations, transitions, node nesting, layering, filtering,\n        caching, event handling for desktop and mobile applications, and much\n        more.\n      </p>\n    </blockquote>\n    <blockquote>\n      <p>\n        You can draw things onto the stage, add event listeners to them, move\n        them, scale them, and rotate them independently from other shapes to\n        support high performance animations, even if your application uses\n        thousands of shapes. Served hot with a side of awesomeness.\n      </p>\n    </blockquote>\n    <p>That.</p>\n    <p>\n      It’s exactly what we need to push our animated React apps to thousands of\n      elements without spending too much time thinking about the\n      <em>how</em> of rendering. Best leave the hairy details to somebody else.\n    </p>\n    <p>Let’s try out two examples:</p>\n    <ol type=\"1\">\n      <li>Pushing our particle generator to 20,000 elements</li>\n      <li>An n-body collision simulator built with MobX</li>\n    </ol>"
        }
      ]
    },
    {
      "sectionTitle": "Smooth animation with 20,000+ elements",
      "lectures": [
        {
          "lectureTitle": "A particle generator pushed to the max",
          "lectureBody": "    <h2 id=\"canvas-react-redux\">\n      A particle generator pushed to 20,000 elements with Canvas\n    </h2>\n    <p>\n      Our\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906668#animating-react-redux\"\n        >SVG-based particle generator</a\n      >\n      caps out at a few thousand elements. Animation becomes slow as times\n      between iterations of our game loop increase.\n    </p>\n    <p>\n      Old elements leave the screen and get pruned faster than we can create\n      new ones. This creates a natural upper limit to how many elements we can\n      push into the page.\n    </p>\n    <p>\n      We can render many more elements if we take out SVG and use HTML5 Canvas\n      instead. I was able to push the code up to almost 20,000 smoothly\n      animated elements. Then JavaScript became the bottleneck.\n    </p>\n    <p>\n      Well, I say JavaScript was the bottleneck, but monitor size plays a role\n      too. It goes up to 20,000 on my laptop screen, juuuust grazes 30,000 on\n      my large desktop monitor, and averages about 17,000 on my iPhone 5SE.\n    </p>\n    <p>Friends with newer laptops got it up to 35,000.</p>\n    <p>\n      You can see it in action hosted on\n      <a href=\"https://swizec.github.io/react-particles-experiment/\"\n        >Github pages</a\n      >.\n    </p>\n    <p>\n      We’re keeping most of our existing code. The real changes happen in\n      <code style=\"white-space: pre-wrap;\">src/components/index.jsx</code>,\n      where a Konva stage replaces the\n      <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code> element, and in\n      <code style=\"white-space: pre-wrap;\">src/components/Particles.jsx</code>,\n      where we change what we render. There’s a small tweak in the reducer to\n      generate more particles per tick.\n    </p>\n    <p>\n      You should go into your particle generator directory, install Konva and\n      react-konva, and then make the changes below. Trying things out is better\n      than just reading my code 😉\n    </p>\n    <pre\n      data-caption=\"Install Konva\"\n    ><code style=\"white-space: pre-wrap;\">$ npm install --save konva react-konva</code></pre>\n    <p>\n      {aside} react-konva is a thin wrapper on Konva itself. There’s no need to\n      think about it as its own thing. For the most part, you can go into the\n      Konva docs, read about something, and it Just Works™ in react-konva.\n      {/aside}\n    </p>"
        },
        {
          "lectureTitle": "Prepare canvas layer",
          "lectureBody": "    <h3 id=\"preparing-a-canvas-layer\">Preparing a canvas layer</h3>\n    <p>\n      Our changes start in\n      <code style=\"white-space: pre-wrap;\">src/components/index.jsx</code>. We\n      have to throw away the\n      <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code> element and\n      replace it with a Konva stage.\n    </p>\n    <p>\n      You can think of a Konva stage as a Canvas element with a bunch of helper\n      methods attached. Some of them Konva uses internally; others are exposed\n      as an API. Functions like exporting to an image file, detecting\n      intersections, etc.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb158\"\n      data-caption=\"Import Konva and set the stage\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb158-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/index.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb158-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb158-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb158-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> Stage <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react-konva&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb158-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb158-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb158-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb158-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb158-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb158-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb158-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb158-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                     <span class=\"op\" style=\"color: #666666;\">&lt;</span>Stage width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">svgWidth</span><span class=\"op\" style=\"color: #666666;\">}</span> height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">svgHeight</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb158-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                         <span class=\"op\" style=\"color: #666666;\">&lt;</span>Particles particles<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">particles</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb158-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb158-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                     &lt;/Stage<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb158-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb158-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                 &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb158-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                 <span class=\"op\" style=\"color: #666666;\">&lt;</span>Footer N<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"va\" style=\"color: #19177c;\">particles</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb158-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb158-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb158-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb158-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We import <code style=\"white-space: pre-wrap;\">Stage</code> from\n      <code style=\"white-space: pre-wrap;\">react-konva</code>, then use it\n      instead of the\n      <code style=\"white-space: pre-wrap;\">&lt;svg&gt;</code> element in the\n      <code style=\"white-space: pre-wrap;\">render</code> method. It gets a\n      <code style=\"white-space: pre-wrap;\">width</code> and a\n      <code style=\"white-space: pre-wrap;\">height</code>.\n    </p>\n    <p>\n      Inside, we render the\n      <code style=\"white-space: pre-wrap;\">Particles</code> component. It’s\n      going to create a Konva layer and use low-level Canvas methods to render\n      particles as sprites.\n    </p>"
        },
        {
          "lectureTitle": "Use sprites for max redraw speed",
          "lectureBody": "    <h3 id=\"using-sprites-for-max-redraw-speed\">\n      Using sprites for max redraw speed\n    </h3>\n    <p>\n      Our\n      <a\n        href=\"https://swizec1.teachable.com/courses/react-for-data-visualization/lectures/6906670#svg-particles\"\n        >SVG-based Particles</a\n      >\n      component was simple. Iterate through a list of particles, render a\n      <code style=\"white-space: pre-wrap;\">&lt;Particle&gt;</code> component\n      for each.\n    </p>\n    <p>\n      We’re going to completely rewrite that. Our new approach goes like this:\n    </p>\n    <ol start=\"0\" type=\"1\">\n      <li>\n        Cache a sprite on\n        <code style=\"white-space: pre-wrap;\">componentDidMount</code>\n      </li>\n      <li>Clear canvas</li>\n      <li>Redraw all particles</li>\n      <li>Repeat</li>\n    </ol>\n    <p>\n      Because the new approach renders a flat image, and because we don’t care\n      about interaction with individual particles, we can get rid of the\n      <code style=\"white-space: pre-wrap;\">Particle</code> component. The\n      unnecessary layer of nesting was slowing us down.\n    </p>\n    <p>\n      The new <code style=\"white-space: pre-wrap;\">Particles</code> component\n      looks like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb159\"\n      data-caption=\"Sprite-based Particles component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb159-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Particles.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb159-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> Component <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> FastLayer <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react-konva&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Particles <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb159-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    layerRef <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">createRef</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb159-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">canvas</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">layerRef</span>.<span class=\"va\" style=\"color: #19177c;\">current</span>.<span class=\"va\" style=\"color: #19177c;\">canvas</span>.<span class=\"at\" style=\"color: #7d9029;\">_canvas</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">canvasContext</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">canvas</span>.<span class=\"at\" style=\"color: #7d9029;\">getContext</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;2d&#39;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">sprite</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Image</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">sprite</span>.<span class=\"at\" style=\"color: #7d9029;\">src</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;https://i.imgur.com/m5l6lhr.png&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb159-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">drawParticle</span>(particle) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb159-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> particle<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">canvasContext</span>.<span class=\"at\" style=\"color: #7d9029;\">drawImage</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">sprite</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">128</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">128</span><span class=\"op\" style=\"color: #666666;\">,</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">15</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">15</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb159-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidUpdate</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb159-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> particles <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">particles</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">console</span>.<span class=\"at\" style=\"color: #7d9029;\">time</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;drawing&#39;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">canvasContext</span>.<span class=\"at\" style=\"color: #7d9029;\">clearRect</span>(<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">canvas</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">canvas</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">for</span> (<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> i <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">;</span> i <span class=\"op\" style=\"color: #666666;\">&lt;</span> <span class=\"va\" style=\"color: #19177c;\">particles</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span><span class=\"op\" style=\"color: #666666;\">;</span> i<span class=\"op\" style=\"color: #666666;\">++</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb159-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">drawParticle</span>(particles[i])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb159-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">console</span>.<span class=\"at\" style=\"color: #7d9029;\">timeEnd</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;drawing&#39;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb159-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb159-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb159-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>FastLayer ref<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">layerRef</span><span class=\"op\" style=\"color: #666666;\">}</span> listening<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;false&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb159-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb159-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb159-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb159-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb159-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Particles<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      40 lines of code is a lot all at once. Let’s walk through step by step.\n    </p>\n    <h4 id=\"componentdidmount\">componentDidMount</h4>\n    <div\n      class=\"sourceCode\"\n      id=\"cb160\"\n      data-caption=\"componentDidMount method\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb160-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Particles.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb160-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb160-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb160-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb160-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">canvas</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">refs</span>.<span class=\"va\" style=\"color: #19177c;\">layer</span>.<span class=\"va\" style=\"color: #19177c;\">canvas</span>.<span class=\"at\" style=\"color: #7d9029;\">_canvas</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb160-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">canvasContext</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">canvas</span>.<span class=\"at\" style=\"color: #7d9029;\">getContext</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;2d&#39;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb160-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb160-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">sprite</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Image</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb160-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">sprite</span>.<span class=\"at\" style=\"color: #7d9029;\">src</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;https://i.imgur.com/m5l6lhr.png&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb160-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      React calls\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> when our\n      component first renders. We use it to set up 3 instance properties.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">this.canvas</code> is a reference to\n      the HTML5 Canvas element. We get it through a ref to the Konva layer,\n      then spelunk through Konva internals to get the canvas itself. As the\n      <code style=\"white-space: pre-wrap;\">_</code> prefix indicates, Anton\n      Lavrenov did not intend this to be a public API.\n    </p>\n    <p>Thanks to JavaScript’s permissiveness, we can use it anyway. 🙌</p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">this.canvasContext</code> is a\n      reference to our canvas’s\n      <a\n        href=\"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D\"\n        >CanvasRenderingContext2D</a\n      >. It’s the interface we use to draw basic shapes, perform\n      transformations, and so on. Context is the only part of canvas you ever\n      interact with as a developer.\n    </p>\n    <p>Why it’s not just Canvas, I don’t know.</p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">this.sprite</code> is a cached\n      image. A small minion that we are going to copy-paste all over as our\n      particle. Creating a new image object with\n      <code style=\"white-space: pre-wrap;\">new Image()</code> and setting the\n      <code style=\"white-space: pre-wrap;\">src</code> property downloads our\n      sprite from the internet into browser memory.\n    </p>\n    <p>It looks like this:</p>\n    <figure>\n      <img src=\"https://i.imgur.com/m5l6lhr.png\" alt=\"Our minion particle\" />\n      <figcaption>Our minion particle</figcaption>\n    </figure>\n    <p>\n      You might think it’s unsafe to copy references to rendered elements into\n      component properties like that, but it’s okay. Our render function always\n      renders the same thing, so the reference never changes. It just makes our\n      code cleaner.\n    </p>\n    <p>\n      Should our component unmount and re-mount, React will call\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> again and\n      update our reference.\n    </p>\n    <h4 id=\"drawparticle\">drawParticle</h4>\n    <div\n      class=\"sourceCode\"\n      id=\"cb161\"\n      data-caption=\"drawParticle code\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb161-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Particles.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb161-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb161-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb161-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">drawParticle</span>(particle) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb161-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> particle<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb161-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb161-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">canvasContext</span>.<span class=\"at\" style=\"color: #7d9029;\">drawImage</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">sprite</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">128</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">128</span><span class=\"op\" style=\"color: #666666;\">,</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">15</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">15</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb161-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      <code style=\"white-space: pre-wrap;\">drawParticle</code> draws a single\n      particle on the canvas. It gets coordinates from the\n      <code style=\"white-space: pre-wrap;\">particle</code> argument and uses\n      <code style=\"white-space: pre-wrap;\">drawImage</code> to copy our sprite\n      into position.\n    </p>\n    <p>\n      We use the whole sprite, corner\n      <code style=\"white-space: pre-wrap;\">(0, 0)</code> to corner\n      <code style=\"white-space: pre-wrap;\">(128, 128)</code>. That’s how big\n      our sprite is. And we copy it to position\n      <code style=\"white-space: pre-wrap;\">(x, y)</code> with a width and\n      height of <code style=\"white-space: pre-wrap;\">15</code> pixels.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">drawImage</code> is the fastest\n      method I’ve found to put pixels on canvas. I don’t know why it’s so fast,\n      but here’s a\n      <a href=\"https://jsperf.com/canvas-drawimage-vs-putimagedata/3\"\n        >helpful benchmark</a\n      >\n      so you can see for yourself.\n    </p>\n    <h4 id=\"componentdidupdate-1\">componentDidUpdate</h4>\n    <div\n      class=\"sourceCode\"\n      id=\"cb162\"\n      data-caption=\"componentDidUpdate code\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb162-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Particles.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb162-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb162-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb162-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">componentDidUpdate</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb162-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> particles <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">particles</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb162-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb162-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">console</span>.<span class=\"at\" style=\"color: #7d9029;\">time</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;drawing&#39;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb162-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">canvasContext</span>.<span class=\"at\" style=\"color: #7d9029;\">clearRect</span>(<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">canvas</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">canvas</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb162-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb162-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">for</span> (<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> i <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">;</span> i <span class=\"op\" style=\"color: #666666;\">&lt;</span> <span class=\"va\" style=\"color: #19177c;\">particles</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span><span class=\"op\" style=\"color: #666666;\">;</span> i<span class=\"op\" style=\"color: #666666;\">++</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb162-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">drawParticle</span>(particles[i])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb162-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb162-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">console</span>.<span class=\"at\" style=\"color: #7d9029;\">timeEnd</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;drawing&#39;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb162-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      <code style=\"white-space: pre-wrap;\">componentDidUpdate</code> is where\n      the magic happens. React calls this lifecycle method every time our list\n      of particles changes. <em>After</em> the\n      <code style=\"white-space: pre-wrap;\">render</code> method.\n    </p>\n    <p>\n      Just like the D3 blackbox approach, we move rendering out of the\n      <code style=\"white-space: pre-wrap;\">render</code> method and into\n      <code style=\"white-space: pre-wrap;\">componentDidUpdate</code>.\n    </p>\n    <p>Here’s how it works:</p>\n    <ol type=\"1\">\n      <li>\n        <code style=\"white-space: pre-wrap;\"\n          >this.canvasContext.clearRect</code\n        >\n        clears the entire canvas from coordinate\n        <code style=\"white-space: pre-wrap;\">(0, 0)</code> to coordinate\n        <code style=\"white-space: pre-wrap;\">(width, height)</code>. We delete\n        everything and make the canvas transparent.\n      </li>\n      <li>\n        We iterate our\n        <code style=\"white-space: pre-wrap;\">particles</code> list with a\n        <code style=\"white-space: pre-wrap;\">for</code> loop and call\n        <code style=\"white-space: pre-wrap;\">drawParticle</code> on each\n        element.\n      </li>\n    </ol>\n    <p>\n      Clearing and redrawing the canvas is faster than moving individual\n      particles. For loops are faster than\n      <code style=\"white-space: pre-wrap;\">.map</code> or any other form of\n      iteration. I tested. A lot.\n    </p>\n    <p>\n      Open your browser console and see how long each frame takes to draw. The\n      <code style=\"white-space: pre-wrap;\">console.time</code> -\n      <code style=\"white-space: pre-wrap;\">console.timeEnd</code> pair measures\n      how long it takes your code to get from\n      <code style=\"white-space: pre-wrap;\">time</code> to\n      <code style=\"white-space: pre-wrap;\">timeEnd</code>. You can have as many\n      of these timers running as you want as long as you give them different\n      names.\n    </p>\n    <h4 id=\"render-4\">render</h4>\n    <div\n      class=\"sourceCode\"\n      id=\"cb163\"\n      data-caption=\"render code\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb163-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Particles.jsx</span></a>\n<a class=\"sourceLine\" id=\"cb163-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb163-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb163-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb163-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb163-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>FastLayer ref<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">layerRef</span><span class=\"op\" style=\"color: #666666;\">}</span> listening<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;false&quot;</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb163-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb163-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      After all that work, our\n      <code style=\"white-space: pre-wrap;\">render</code> method is quite short.\n    </p>\n    <p>\n      We render a Konva <code style=\"white-space: pre-wrap;\">FastLayer</code>,\n      give it a <code style=\"white-space: pre-wrap;\">ref</code> and turn off\n      <code style=\"white-space: pre-wrap;\">listening</code> for mouse events.\n      That makes the fast layer even faster.\n    </p>\n    <p>\n      Ideas for this combination of settings came from Konva’s official\n      <a\n        href=\"https://konvajs.github.io/docs/performance/All_Performance_Tips.html\"\n        >performance tips</a\n      >\n      documentation. This makes sense when you think about it.\n    </p>\n    <p>\n      A <code style=\"white-space: pre-wrap;\">FastLayer</code> is faster than a\n      <code style=\"white-space: pre-wrap;\">Layer</code>. It’s in the name.\n      Ignoring mouse events means you don’t have to keep track of elements. It\n      reduces computation.\n    </p>\n    <p>\n      This was empirically the fastest solution with the most particles on\n      screen.\n    </p>"
        },
        {
          "lectureTitle": "But why so many elements?",
          "lectureBody": "    <h3 id=\"but-why-swizec\">But why, Swizec?</h3>\n    <p>\n      I’m glad you asked. This was a silly example. I devised the experiment\n      because at my first React+D3 workshop somebody asked,\n      <em\n        >“What if we have thousands of datapoints, and we want to animate all\n        of them?”</em\n      >. I didn’t have a good answer.\n    </p>\n    <p>\n      Now I do. You put them in Canvas. You drive the animation with a game\n      loop. You’re good.\n    </p>\n    <p>\n      You can even do it as an overlay. Have an SVG for your graphs and charts,\n      overlay with a transparent canvas for your high speed animation.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Build a small interactive canvas game",
      "lectures": [
        {
          "lectureTitle": "Simulating billiards with MobX, Canvas, and Konva",
          "lectureBody": "    <h2\n      id=\"build-a-declarative-billiards-simulation-with-mobx-canvas-and-konva\"\n    >\n      Build a declarative billiards simulation with MobX, Canvas, and Konva\n    </h2>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/billiards-start.png\"\n        alt=\"Billiards game\"\n      />\n      <figcaption>Billiards game</figcaption>\n    </figure>\n    <p>\n      We’re building a small game. You have 11 glass balls – marbles, if you\n      will. Grab one, throw it at the others, watch them bounce around. There\n      is no score, but it looks cool, and it’s a fun way to explore how Konva\n      and React give you interactive Canvas features.\n    </p>\n    <p>\n      We’re using React and Konva to render our 11 marbles on an HTML5 Canvas\n      element, MobX to drive the animation loop, and D3 to help with collision\n      detection. Because this example is declarative, we can split it into two\n      parts:\n    </p>\n    <ul>\n      <li>Part 1: Rendering the marbles</li>\n      <li>Part 2: Building the physics</li>\n    </ul>\n    <p>\n      You can see the finished\n      <a href=\"https://github.com/Swizec/declarative-canvas-react-konva\"\n        >code on Github</a\n      >\n      and play around with a\n      <a href=\"https://swizec.github.io/declarative-canvas-react-konva/\"\n        >hosted version</a\n      >\n      of the code you’re about to build.\n    </p>\n    <p>\n      I know this example comes late in the book, and you’re feeling like you\n      know all there is to React and visualizations. You can think of this\n      example as practice. Plus it’s a good way to learn the basics of MobX.\n    </p>"
        },
        {
          "lectureTitle": "Decorators",
          "lectureBody": "    <h3 id=\"decorators\">Decorators</h3>\n    <p>Before we begin, let me tell you about decorators.</p>\n    <p>\n      MobX embraces them to make its API easier to use. You can use MobX\n      without decorators, but decorators make it better.\n    </p>\n    <p>\n      A couple years ago, decorators got very close to becoming an official\n      spec, then got held back. I don’t know <em>why</em>, but they’re a great\n      feature whose syntax is unlikely to change. So even if MobX has to change\n      its implementation when decorators do land in the JavaScript spec, you’re\n      not likely to have to change anything.\n    </p>\n    <p>\n      You can think of decorators as function wrappers. Instead of code like\n      this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb164\"\n      data-caption=\"Decoratorless function wrapping\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb164-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">inject</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;store&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> (<span class=\"op\" style=\"color: #666666;\">{</span> store <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>div<span class=\"op\" style=\"color: #666666;\">&gt;</span>A thing <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">with</span> <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">store</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span><span class=\"op\" style=\"color: #666666;\">}</span>&lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>You can write the same code like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb165\"\n      data-caption=\"Function wrapping with decorators\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb165-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">@<span class=\"at\" style=\"color: #7d9029;\">inject</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;store&#39;</span>)</a>\n<a class=\"sourceLine\" id=\"cb165-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">(<span class=\"op\" style=\"color: #666666;\">{</span> store <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>div<span class=\"op\" style=\"color: #666666;\">&gt;</span>A thing <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">with</span> <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">store</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span><span class=\"op\" style=\"color: #666666;\">}</span>&lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a></code></pre>\n    </div>\n    <p>\n      Not much of a difference, but it becomes better looking when you work\n      with classes or combine multiple decorators. That’s when they shine. No\n      more <code style=\"white-space: pre-wrap;\">})))}))</code> at the end of\n      your functions.\n    </p>\n    <p>\n      By the way, <code style=\"white-space: pre-wrap;\">inject</code> is to MobX\n      much like <code style=\"white-space: pre-wrap;\">connect</code> is to\n      Redux. I’ll explain in a bit.\n    </p>"
        },
        {
          "lectureTitle": "Part 0: Some setup",
          "lectureBody": "    <h3 id=\"part-0-some-setup\">Part 0: Some setup</h3>\n    <p>\n      Because decorators aren’t in the JavaScript spec, we have to tweak how we\n      start our project. We can still use\n      <code style=\"white-space: pre-wrap;\">create-react-app</code>, but there’s\n      an additional step.\n    </p>\n    <p>You should start a new project like this:</p>\n    <pre\n      data-caption=\"Create the billiards game project\"\n    ><code style=\"white-space: pre-wrap;\">$ create-react-app billiards-game --scripts-version custom-react-scripts</code></pre>\n    <p>\n      This creates a new directory with a full setup for React. Just like\n      you’re used to.\n    </p>\n    <p>\n      The addition of\n      <code style=\"white-space: pre-wrap;\"\n        >--scripts-version custom-react-scripts</code\n      >\n      employs <span class=\"citation\" data-cites=\"kitze\">@kitze</span>’s\n      <a href=\"https://github.com/kitze/custom-react-scripts\"\n        >custom-react-scripts</a\n      >\n      project to give us more configuration options. Like the ability to enable\n      decorators.\n    </p>\n    <p>\n      We enable them in the\n      <code style=\"white-space: pre-wrap;\">.env</code> file. Add this line:\n    </p>\n    <pre\n      data-caption=\"Add to .env settings\"\n    ><code style=\"white-space: pre-wrap;\">// billiards-game/.env\n// ...\nREACT_APP_DECORATORS=true</code></pre>\n    <p>\n      No installation necessary. I think\n      <code style=\"white-space: pre-wrap;\">custom-react-scripts</code> uses the\n      <code style=\"white-space: pre-wrap;\">transform-decorators-legacy</code>\n      Babel plugin behind the scenes. It’s pre-installed, and we enable it with\n      that <code style=\"white-space: pre-wrap;\">.env</code> change.\n    </p>\n    <p>Before we begin, you should install some other dependencies as well:</p>\n    <pre\n      data-caption=\"Install libraries\"\n    ><code style=\"white-space: pre-wrap;\">$ npm install --save konva react-konva mobx mobx-react \\\n    d3-timer d3-scale d3-quadtree</code></pre>\n    <p>\n      This gives you Konva, MobX, and the parts of D3 that we need. You’re now\n      ready to build the billiards game.\n    </p>"
        },
        {
          "lectureTitle": "A quick MobX primer",
          "lectureBody": "    <h3 id=\"a-quick-mobx-primer\">A quick MobX primer</h3>\n    <p>\n      Explaining MobX in detail is beyond the scope of this book. You can learn\n      it by osmosis as you follow the code in our billiards example.\n    </p>\n    <p>That said, here’s a quick rundown of the concepts we’re using.</p>\n    <p>\n      MobX is based on reactive programming. There are values that are\n      observable and functions that react when those values change. MobX\n      ensures only the minimal possible set of observers is triggered on every\n      change.\n    </p>\n    <p>So, we have:</p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">@observable</code> – a property\n      whose changes observers subscribe to\n      <code style=\"white-space: pre-wrap;\">@observer</code> – a component whose\n      <code style=\"white-space: pre-wrap;\">render()</code> method observes\n      values <code style=\"white-space: pre-wrap;\">@computed</code> – a method\n      whose value can be fully derived from observables\n      <code style=\"white-space: pre-wrap;\">@action</code> – a method that\n      changes state, analogous to a Redux reducer\n      <code style=\"white-space: pre-wrap;\">@inject</code> – a decorator that\n      injects global stores into a component’s props\n    </p>\n    <p>\n      That’s all you need to know. Once your component is an\n      <code style=\"white-space: pre-wrap;\">@observer</code>, you never have to\n      worry about <em>what</em> it’s observing. MobX ensures it reacts to\n      changes in values used during rendering.\n    </p>\n    <p>\n      Making your component an observer and injecting the global store is the\n      same as using <code style=\"white-space: pre-wrap;\">connect</code> in\n      Redux. It gives your component access to your state, and it triggers a\n      re-render when something changes.\n    </p>\n    <p>\n      Importantly, it <em>doesn’t</em> trigger a re-render when something that\n      the component isn’t using changes. That little tidbit is what makes many\n      other reactive libraries difficult to use.\n    </p>"
        },
        {
          "lectureTitle": "Part 1: Rendering our marbles",
          "lectureBody": "    <h3 id=\"part-1-rendering-our-marbles\">Part 1: Rendering our marbles</h3>\n    <p>\n      Our marbles render on Canvas using Konva. Each marble is its own sprite\n      rendered as a Konva element. This makes it easier to implement user and\n      marble interactions.\n    </p>\n    <p>Rendering happens in 3 components:</p>\n    <ul>\n      <li>\n        <code style=\"white-space: pre-wrap;\">App</code> holds everything\n        together\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">MarbleList</code> renders a list\n        of marbles\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">Marble</code> renders an\n        individual marble\n      </li>\n    </ul>\n    <p>We’re also using 2 MobX stores:</p>\n    <ul>\n      <li>\n        <code style=\"white-space: pre-wrap;\">Sprite</code> to load the marble\n        sprite and define coordinates within\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">Physics</code> as our physics\n        engine\n      </li>\n    </ul>\n    <p>\n      <code style=\"white-space: pre-wrap;\">Sprite</code> and\n      <code style=\"white-space: pre-wrap;\">Physics</code> are hold almost all\n      of our game logic. A bit of drag &amp; drop logic goes in the\n      <code style=\"white-space: pre-wrap;\">Marble</code> component. Other than\n      that, all our components are presentational. They get props and render\n      stuff.\n    </p>\n    <p>\n      Let’s start with <code style=\"white-space: pre-wrap;\">App</code> and work\n      our way down.\n    </p>\n    <h4 id=\"app-1\">App</h4>\n    <p>\n      Our <code style=\"white-space: pre-wrap;\">App</code> component doesn’t do\n      much. It imports MobX stores, triggers sprite loading, and starts the\n      game loop.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb169\"\n      data-caption=\"The App component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb169-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb169-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb169-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> Component <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb169-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> Provider <span class=\"im\">as</span> MobXProvider<span class=\"op\" style=\"color: #666666;\">,</span> observer <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;mobx-react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb169-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb169-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Physics <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;../logic/Physics&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb169-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Sprite <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;../logic/Sprite&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb169-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> MarbleList <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./MarbleList&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb169-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb169-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">@observer</a>\n<a class=\"sourceLine\" id=\"cb169-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb169-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb169-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">Sprite</span>.<span class=\"at\" style=\"color: #7d9029;\">loadSprite</span>(() <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">Physics</span>.<span class=\"at\" style=\"color: #7d9029;\">startGameLoop</span>())<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb169-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb169-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb169-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb169-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb169-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App-header&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">&lt;</span>h2<span class=\"op\" style=\"color: #666666;\">&gt;</span>Elastic collisions&lt;/h2<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">&lt;</span>p<span class=\"op\" style=\"color: #666666;\">&gt;</span>Rendered on canvas<span class=\"op\" style=\"color: #666666;\">,</span> built <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">with</span> React and Konva&lt;/p<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>div className<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;App-intro&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">&lt;</span>MobXProvider physics<span class=\"op\" style=\"color: #666666;\">={</span>Physics<span class=\"op\" style=\"color: #666666;\">}</span> sprite<span class=\"op\" style=\"color: #666666;\">={</span>Sprite<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"op\" style=\"color: #666666;\">&lt;</span>MarbleList /<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    &lt;/MobXProvider<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/div<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb169-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb169-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb169-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb169-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb169-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> App<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We import our dependencies: React itself, a\n      <code style=\"white-space: pre-wrap;\">MobXProvider</code> that’s similar\n      to the Redux provider (puts stuff in react context), both of our MobX\n      stores which export singleton instances, and the main\n      <code style=\"white-space: pre-wrap;\">MarbleList</code> component.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">App</code> itself is a full featured\n      component that initiates sprite loading in\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code> and calls\n      <code style=\"white-space: pre-wrap;\">startGameLoop</code> when the sprite\n      is ready. We know the sprite is ready because it calls a callback. You’ll\n      see how that works in a bit.\n    </p>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">render</code> method outputs\n      some descriptive text and the\n      <code style=\"white-space: pre-wrap;\">MarbleList</code> component wrapped\n      in a <code style=\"white-space: pre-wrap;\">MobXProvider</code>. The\n      provider puts instances of our stores –\n      <code style=\"white-space: pre-wrap;\">sprite</code> and\n      <code style=\"white-space: pre-wrap;\">physics</code> – in React context.\n    </p>\n    <p>\n      This makes them available to all child components via the\n      <code style=\"white-space: pre-wrap;\">inject</code> decorator.\n    </p>\n    <h4 id=\"marblelist\">MarbleList</h4>\n    <p>\n      <code style=\"white-space: pre-wrap;\">MarbleList</code> is an important\n      component that renders the whole game, yet it can still be small and\n      functional. Every prop it needs comes from our two stores.\n    </p>\n    <p>Like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb170\"\n      data-caption=\"MarbleList component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb170-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/MarbleList.js</span></a>\n<a class=\"sourceLine\" id=\"cb170-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb170-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb170-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> inject<span class=\"op\" style=\"color: #666666;\">,</span> observer <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;mobx-react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb170-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> Stage<span class=\"op\" style=\"color: #666666;\">,</span> Layer<span class=\"op\" style=\"color: #666666;\">,</span> Group <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react-konva&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb170-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb170-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> Marble <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;./Marble&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb170-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb170-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> MarbleList <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">inject</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;physics&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;sprite&#39;</span>)(<span class=\"at\" style=\"color: #7d9029;\">observer</span>((<span class=\"op\" style=\"color: #666666;\">{</span> physics<span class=\"op\" style=\"color: #666666;\">,</span> sprite <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb170-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> width<span class=\"op\" style=\"color: #666666;\">,</span> height<span class=\"op\" style=\"color: #666666;\">,</span> marbles <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> physics<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb170-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> marbleTypes <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> sprite<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb170-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb170-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb170-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>Stage width<span class=\"op\" style=\"color: #666666;\">={</span>width<span class=\"op\" style=\"color: #666666;\">}</span> height<span class=\"op\" style=\"color: #666666;\">={</span>height<span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb170-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>Layer<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb170-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"op\" style=\"color: #666666;\">&lt;</span>Group<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb170-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    <span class=\"op\" style=\"color: #666666;\">{</span><span class=\"va\" style=\"color: #19177c;\">marbles</span>.<span class=\"at\" style=\"color: #7d9029;\">map</span>((<span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> id <span class=\"op\" style=\"color: #666666;\">},</span> i) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (</a>\n<a class=\"sourceLine\" id=\"cb170-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        <span class=\"op\" style=\"color: #666666;\">&lt;</span>Marble x<span class=\"op\" style=\"color: #666666;\">={</span>x<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb170-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                y<span class=\"op\" style=\"color: #666666;\">={</span>y<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb170-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                type<span class=\"op\" style=\"color: #666666;\">={</span>marbleTypes[i<span class=\"op\" style=\"color: #666666;\">%</span><span class=\"va\" style=\"color: #19177c;\">marbleTypes</span>.<span class=\"at\" style=\"color: #7d9029;\">length</span>]<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb170-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                draggable<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;true&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb170-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                id<span class=\"op\" style=\"color: #666666;\">={</span>id<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb170-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                key<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`marble-</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>id<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">`</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb170-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    ))<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb170-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                &lt;/Group<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb170-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            &lt;/Layer<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb170-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/Stage<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb170-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb170-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb170-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb170-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> MarbleList<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We import dependencies and create a\n      <code style=\"white-space: pre-wrap;\">MarbleList</code> component. Instead\n      of decorators, we’re using with functional composition.\n    </p>\n    <p>\n      This shows you that MobX <em>can</em> work without decorators, but\n      there’s no deep reason behind this choice. Over time, I’ve developed a\n      preference for composition for functional components and decorators for\n      class-based components.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">inject</code> takes values out of\n      context and puts them in component props.\n      <code style=\"white-space: pre-wrap;\">observer</code> declares that our\n      component observes those props and reacts to them.\n    </p>\n    <p>\n      It’s generally a good idea to use both\n      <code style=\"white-space: pre-wrap;\">inject</code> and\n      <code style=\"white-space: pre-wrap;\">observer</code> together. I have yet\n      to find a case where you need just one or the other.\n    </p>\n    <p>\n      The rendering itself takes values out of our stores and returns a Konva\n      <code style=\"white-space: pre-wrap;\">Stage</code> with a single\n      <code style=\"white-space: pre-wrap;\">Layer</code>, which contains a\n      <code style=\"white-space: pre-wrap;\">Group</code>. Inside this group is\n      our list of marbles.\n    </p>\n    <p>\n      Each marble gets a position, a\n      <code style=\"white-space: pre-wrap;\">type</code> that defines how it\n      looks, an <code style=\"white-space: pre-wrap;\">id</code>, and a\n      <code style=\"white-space: pre-wrap;\">key</code>. We set\n      <code style=\"white-space: pre-wrap;\">draggable</code> to\n      <code style=\"white-space: pre-wrap;\">true</code> so Konva knows that this\n      element is draggable.\n    </p>\n    <p>\n      Yes, that means we get draggability on an HTML5 Canvas without any extra\n      effort. I like that.\n    </p>\n    <h4 id=\"marble\">Marble</h4>\n    <p>\n      Each <code style=\"white-space: pre-wrap;\">Marble</code> component renders\n      a single marble and handles dragging and dropping. That’s how you “shoot”\n      marbles.\n    </p>\n    <p>\n      Dragging and dropping creates a vector that accelerates, or shoots, the\n      marble in a certain direction with a certain speed. Putting this logic in\n      the component itself makes sense because the rest of our game only cares\n      about that final vector.\n    </p>\n    <p>The Marble component looks like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb171\"\n      data-caption=\"Marble component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb171-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Marble.js</span></a>\n<a class=\"sourceLine\" id=\"cb171-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb171-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> React<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span> Component <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb171-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> Circle <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;react-konva&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb171-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> inject<span class=\"op\" style=\"color: #666666;\">,</span> observer <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;mobx-react&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb171-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb171-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">@<span class=\"at\" style=\"color: #7d9029;\">inject</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;physics&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;sprite&#39;</span>) @observer</a>\n<a class=\"sourceLine\" id=\"cb171-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Marble <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb171-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    onDragStart <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb171-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// set drag starting position</span></a>\n<a class=\"sourceLine\" id=\"cb171-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb171-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    onDragMove <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb171-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// update marble position</span></a>\n<a class=\"sourceLine\" id=\"cb171-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb171-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    onDragEnd <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb171-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// shoot the marble</span></a>\n<a class=\"sourceLine\" id=\"cb171-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb171-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb171-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> sprite<span class=\"op\" style=\"color: #666666;\">,</span> type<span class=\"op\" style=\"color: #666666;\">,</span> draggable<span class=\"op\" style=\"color: #666666;\">,</span> id<span class=\"op\" style=\"color: #666666;\">,</span> physics <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb171-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> MarbleDefinitions <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">sprite</span>.<span class=\"at\" style=\"color: #7d9029;\">marbleDefinitions</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb171-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> r <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">physics</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[id]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb171-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb171-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb171-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>Circle x<span class=\"op\" style=\"color: #666666;\">={</span>x<span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span>y<span class=\"op\" style=\"color: #666666;\">}</span> radius<span class=\"op\" style=\"color: #666666;\">={</span>r<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    fillPatternImage<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"va\" style=\"color: #19177c;\">sprite</span>.<span class=\"at\" style=\"color: #7d9029;\">sprite</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    fillPatternOffset<span class=\"op\" style=\"color: #666666;\">={</span>MarbleDefinitions[type]<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    fillPatternScale<span class=\"op\" style=\"color: #666666;\">={{</span> <span class=\"dt\">x</span><span class=\"op\">:</span> r<span class=\"op\">*</span><span class=\"dv\">2</span>/<span class=\"dv\">111</span><span class=\"op\">,</span> <span class=\"dt\">y</span><span class=\"op\">:</span> r<span class=\"op\">*</span><span class=\"dv\">2</span>/<span class=\"dv\">111</span> <span class=\"op\">}}</span></a>\n<a class=\"sourceLine\" id=\"cb171-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    shadowColor<span class=\"op\" style=\"color: #666666;\">={</span>MarbleDefinitions[type].<span class=\"at\" style=\"color: #7d9029;\">c</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    shadowBlur<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;15&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb171-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    shadowOpacity<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;1&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb171-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    draggable<span class=\"op\" style=\"color: #666666;\">={</span>draggable<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    onDragStart<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">onDragStart</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    onDragEnd<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">onDragEnd</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    onDragMove<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">onDragMove</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    ref<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;circle&quot;</span></a>\n<a class=\"sourceLine\" id=\"cb171-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                    /&gt;</a>\n<a class=\"sourceLine\" id=\"cb171-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb171-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb171-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb171-44\" title=\"44\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> Marble<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We <code style=\"white-space: pre-wrap;\">@inject</code> both stores into\n      our component and make it an\n      <code style=\"white-space: pre-wrap;\">@observer</code>. The\n      <code style=\"white-space: pre-wrap;\">render</code> method takes values\n      out of our stores and renders a Konva\n      <code style=\"white-space: pre-wrap;\">Circle</code>. The circle uses a\n      chunk of our sprite as its background, has a colorful shadow, and has a\n      bunch of drag callbacks.\n    </p>\n    <p>Those callbacks make our game playable.</p>\n    <p>\n      In <code style=\"white-space: pre-wrap;\">onDragStart</code>, we store the\n      starting position of the dragged marble. In\n      <code style=\"white-space: pre-wrap;\">onDragMove</code>, we update the\n      marble’s position in the store, which makes it possible for other marbles\n      to bounce off of ours while it’s moving, and in\n      <code style=\"white-space: pre-wrap;\">onDragEnd</code>, we shoot the\n      marble.\n    </p>\n    <p>\n      Shoot direction depends on how we dragged. That’s why we need the\n      starting positions.\n    </p>\n    <p>\n      Drag callbacks double as MobX actions. Makes our code simpler. Instead of\n      specifying an extra\n      <code style=\"white-space: pre-wrap;\">@action</code> in the MobX store, we\n      manipulate the values directly.\n    </p>\n    <p>\n      MobX makes this okay. It keeps everything in sync and our state easy to\n      understand. MobX even batches value changes before triggering re-renders.\n    </p>\n    <p>The code inside those callbacks is pretty mathsy.</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb172\"\n      data-caption=\"Dragging callbacks\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb172-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/components/Marble.js</span></a>\n<a class=\"sourceLine\" id=\"cb172-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb172-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Marble <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb172-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    onDragStart <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb172-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> physics<span class=\"op\" style=\"color: #666666;\">,</span> id <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb172-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb172-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb172-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">origX</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">physics</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[id].<span class=\"at\" style=\"color: #7d9029;\">x</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb172-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">origY</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">physics</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[id].<span class=\"at\" style=\"color: #7d9029;\">y</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb172-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">startTime</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Date</span>()</a>\n<a class=\"sourceLine\" id=\"cb172-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb172-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb172-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb172-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    onDragMove <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb172-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> physics<span class=\"op\" style=\"color: #666666;\">,</span> id <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb172-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">refs</span>.<span class=\"va\" style=\"color: #19177c;\">circle</span>.<span class=\"at\" style=\"color: #7d9029;\">attrs</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb172-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb172-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">physics</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[id].<span class=\"at\" style=\"color: #7d9029;\">x</span> <span class=\"op\" style=\"color: #666666;\">=</span> x<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb172-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">physics</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[id].<span class=\"at\" style=\"color: #7d9029;\">y</span> <span class=\"op\" style=\"color: #666666;\">=</span> y<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb172-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb172-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb172-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    onDragEnd <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb172-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> physics <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">props</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb172-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              circle <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">refs</span>.<span class=\"at\" style=\"color: #7d9029;\">circle</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb172-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              <span class=\"op\" style=\"color: #666666;\">{</span> origX<span class=\"op\" style=\"color: #666666;\">,</span> origY <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb172-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">circle</span>.<span class=\"at\" style=\"color: #7d9029;\">attrs</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb172-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb172-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb172-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> delta_t <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Date</span>() <span class=\"op\" style=\"color: #666666;\">-</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">startTime</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb172-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              dist <span class=\"op\" style=\"color: #666666;\">=</span> (x <span class=\"op\" style=\"color: #666666;\">-</span> origX) <span class=\"op\" style=\"color: #666666;\">**</span> <span class=\"dv\" style=\"color: #40a070;\">2</span> <span class=\"op\" style=\"color: #666666;\">+</span> (y <span class=\"op\" style=\"color: #666666;\">-</span> origY) <span class=\"op\" style=\"color: #666666;\">**</span> <span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb172-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              v <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">sqrt</span>(dist)/(delta_t/<span class=\"dv\" style=\"color: #40a070;\">16</span>)<span class=\"op\" style=\"color: #666666;\">;</span> <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// distance per frame (= 16ms)</span></a>\n<a class=\"sourceLine\" id=\"cb172-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb172-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">physics</span>.<span class=\"at\" style=\"color: #7d9029;\">shoot</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb172-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">           <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> x<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb172-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">           <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> y<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb172-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">           <span class=\"dt\" style=\"color: #902000;\">vx</span><span class=\"op\" style=\"color: #666666;\">:</span> (x <span class=\"op\" style=\"color: #666666;\">-</span> origX)/(v/<span class=\"dv\" style=\"color: #40a070;\">3</span>)<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// /3 is a speedup factor</span></a>\n<a class=\"sourceLine\" id=\"cb172-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">           <span class=\"dt\" style=\"color: #902000;\">vy</span><span class=\"op\" style=\"color: #666666;\">:</span> (y <span class=\"op\" style=\"color: #666666;\">-</span> origY)/(v/<span class=\"dv\" style=\"color: #40a070;\">3</span>)</a>\n<a class=\"sourceLine\" id=\"cb172-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">           <span class=\"op\" style=\"color: #666666;\">},</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">props</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb172-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb172-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb172-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb172-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      In <code style=\"white-space: pre-wrap;\">onDragStart</code>, we store\n      original coordinates and start time in local state. These are temporary\n      values that nothing outside this user action cares about. Local state\n      makes sense.\n    </p>\n    <p>We’ll use them to determine how far the user dragged our marble.</p>\n    <p>\n      In <code style=\"white-space: pre-wrap;\">onDragMove</code> we update the\n      MobX store with new coordinates for this particular marble. You might\n      think we’re messing with mutable state here, and we <em>might</em> be,\n      but these are MobX observables. They’re wrapped in setters that ensure\n      everything is kept in sync, changes logged, observers notified, etc.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">onDragEnd</code> shoots the marble.\n      We calculate drag speed and direction, then we call the\n      <code style=\"white-space: pre-wrap;\">shoot()</code> action on the\n      <code style=\"white-space: pre-wrap;\">physics</code> store.\n    </p>\n    <p>\n      The math we’re doing is called\n      <a href=\"https://en.wikipedia.org/wiki/Euclidean_distance\"\n        >euclidean distance</a\n      >\n      by the way. Distance between two points is the root of the sum of squares\n      of distance on each axis.\n    </p>\n    <h4 id=\"sprite-store\">Sprite store</h4>\n    <p>\n      Now that we know how rendering works, we need to load our sprite. It’s an\n      icon set I bought online. Can’t remember where or who from.\n    </p>\n    <p>Here’s what it looks like:</p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/monster-marbles-sprite-sheets.jpg\"\n        alt=\"Marbles sprite\"\n      />\n      <figcaption>Marbles sprite</figcaption>\n    </figure>\n    <p>To use this sprite, we need two things:</p>\n    <ol type=\"1\">\n      <li>A way to tell where on the image each marble lies</li>\n      <li>A MobX store that loads the image into memory</li>\n    </ol>\n    <p>\n      The first is a\n      <code style=\"white-space: pre-wrap;\">MarbleDefinitions</code> dictionary.\n      We used it in\n      <code style=\"white-space: pre-wrap;\">Marble</code> component’s render\n      method. If you’re playing along, you should copy paste this. Too much\n      typing 😃\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb173\"\n      data-caption=\"MarbleDefinitions dictionary\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb173-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/logic/Sprite.js</span></a>\n<a class=\"sourceLine\" id=\"cb173-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb173-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> MarbleDefinitions <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb173-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">dino</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-222</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-177</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">c</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;#8664d5&#39;</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb173-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">redHeart</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-222</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-299</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">c</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;#e47178&#39;</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb173-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">sun</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-222</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-420</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">c</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;#5c96ac&#39;</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb173-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb173-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">yellowHeart</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-400</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-177</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">c</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;#c8b405&#39;</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb173-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">mouse</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-400</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-299</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">c</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;#7d7e82&#39;</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb173-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">pumpkin</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-400</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-420</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">c</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;#fa9801&#39;</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb173-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb173-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">frog</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-576</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-177</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">c</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;#98b42b&#39;</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb173-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">moon</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-575</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-299</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">c</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;#b20717&#39;</span> <span class=\"op\" style=\"color: #666666;\">},</span></a>\n<a class=\"sourceLine\" id=\"cb173-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">bear</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-576</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">-421</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">c</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;#a88534&#39;</span> <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb173-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb173-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb173-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"op\" style=\"color: #666666;\">{</span> MarbleDefinitions <span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      Each type of marble has a name, a coordinate, and a color. The coordinate\n      tells us where on the sprite image it is, and the color helps us create a\n      nice shadow.\n    </p>\n    <p>All values painstakingly assembled by hand. You’re welcome. 😌</p>\n    <p>\n      The MobX store that loads our sprite into memory and helps us use it\n      looks like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb174\"\n      data-caption=\"Sprite store\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb174-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/logic/Sprite.js</span></a>\n<a class=\"sourceLine\" id=\"cb174-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb174-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> observable<span class=\"op\" style=\"color: #666666;\">,</span> action<span class=\"op\" style=\"color: #666666;\">,</span> computed <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;mobx&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb174-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> MarbleSprite <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;../monster-marbles-sprite-sheets.jpg&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb174-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb174-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Sprite <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb174-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @observable sprite <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb174-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb174-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @action <span class=\"at\" style=\"color: #7d9029;\">loadSprite</span>(callback <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb174-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> sprite <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Image</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb174-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">sprite</span>.<span class=\"at\" style=\"color: #7d9029;\">src</span> <span class=\"op\" style=\"color: #666666;\">=</span> MarbleSprite<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb174-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb174-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">sprite</span>.<span class=\"at\" style=\"color: #7d9029;\">onload</span> <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb174-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">sprite</span> <span class=\"op\" style=\"color: #666666;\">=</span> sprite<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb174-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb174-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"at\" style=\"color: #7d9029;\">callback</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb174-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb174-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb174-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb174-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @computed get <span class=\"at\" style=\"color: #7d9029;\">marbleTypes</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb174-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"va\" style=\"color: #19177c;\">Object</span>.<span class=\"at\" style=\"color: #7d9029;\">keys</span>(MarbleDefinitions)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb174-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb174-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb174-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @computed get <span class=\"at\" style=\"color: #7d9029;\">marbleDefinitions</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb174-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> MarbleDefinitions<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb174-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb174-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb174-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb174-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">new</span> <span class=\"at\" style=\"color: #7d9029;\">Sprite</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      A MobX store is a JavaScript object. It has\n      <code style=\"white-space: pre-wrap;\">@observable</code> values,\n      <code style=\"white-space: pre-wrap;\">@actions</code>, and\n      <code style=\"white-space: pre-wrap;\">@computed</code> getters. That’s all\n      there is to it.\n    </p>\n    <p>\n      No complicated reducers and action generators. Just JavaScript functions\n      and properties. There’s plenty going on behind the scenes, but we don’t\n      have to think about it.\n    </p>\n    <p>That’s why I like MobX more than Redux. Feels easier to use 🤫</p>\n    <p>\n      In the <code style=\"white-space: pre-wrap;\">Sprite</code> store, we have\n      an <code style=\"white-space: pre-wrap;\">@observable sprite</code>.\n      Changing this value triggers a re-render in al\n      <code style=\"white-space: pre-wrap;\">@observer</code> components that\n      rely on it. In our case that’s every marble.\n    </p>\n    <p>\n      Then we have a\n      <code style=\"white-space: pre-wrap;\">loadSprite</code> action. It creates\n      a new <code style=\"white-space: pre-wrap;\">Image</code> object and loads\n      the sprite. After the image loads, we set\n      <code style=\"white-space: pre-wrap;\">this.sprite</code>.\n    </p>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">@computed</code> getters make it\n      easier to access\n      <code style=\"white-space: pre-wrap;\">MarbleDefinitions</code>.\n      <code style=\"white-space: pre-wrap;\">marbleTypes</code> gives us a list\n      of available types of marbles and\n      <code style=\"white-space: pre-wrap;\">marbleDefinitions</code> returns the\n      definitions object.\n    </p>\n    <p>\n      Running your code won’t work just yet. We need the physics store first\n      because it defines marble positions.\n    </p>"
        },
        {
          "lectureTitle": "Part 2: Building the physics",
          "lectureBody": "    <h3 id=\"part-2-building-the-physics\">Part 2: Building the physics</h3>\n    <p>\n      Our whole physics engine fits into a single MobX store. It contains the\n      collision detection, marble movement calculations, and drives the game\n      loop itself.\n    </p>\n    <p>The general approach goes like this:</p>\n    <ol type=\"1\">\n      <li>Have an observable array of marbles</li>\n      <li>\n        Run a <code style=\"white-space: pre-wrap;\">simulationStep</code> on\n        each\n        <code style=\"white-space: pre-wrap;\">requestAnimationFrame</code> using\n        <code style=\"white-space: pre-wrap;\">d3.timer</code>\n      </li>\n      <li>Change marble positions and speed</li>\n      <li>\n        MobX observables and observers trigger re-renders of marbles that move\n      </li>\n    </ol>\n    <p>\n      The\n      <a\n        href=\"https://github.com/Swizec/declarative-canvas-react-konva/blob/master/src/logic/Physics.js\"\n        >whole Physics store</a\n      >\n      is some 120 lines of code. We’ll go slow. Here’s the skeleton:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb175\"\n      data-caption=\"Physics skeleton\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb175-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/logic/Physics.js</span></a>\n<a class=\"sourceLine\" id=\"cb175-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb175-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Physics <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb175-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @observable MarbleR <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">25</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb175-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @observable width <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">800</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb175-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @observable height <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">600</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb175-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @observable marbles <span class=\"op\" style=\"color: #666666;\">=</span> []<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb175-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    timer <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb175-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb175-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @computed get <span class=\"at\" style=\"color: #7d9029;\">initialPositions</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb175-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb175-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb175-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb175-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @action <span class=\"at\" style=\"color: #7d9029;\">startGameLoop</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb175-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb175-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb175-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb175-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @action <span class=\"at\" style=\"color: #7d9029;\">simulationStep</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb175-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb175-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb175-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb175-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @action <span class=\"at\" style=\"color: #7d9029;\">shoot</span>(<span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> vx<span class=\"op\" style=\"color: #666666;\">,</span> vy <span class=\"op\" style=\"color: #666666;\">},</span> i) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb175-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb175-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb175-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      We have four observable properties, a\n      <code style=\"white-space: pre-wrap;\">timer</code>, a\n      <code style=\"white-space: pre-wrap;\">@computed</code> property for\n      initial positions, and 3 actions.\n      <code style=\"white-space: pre-wrap;\">startGameLoop</code> starts our\n      game, <code style=\"white-space: pre-wrap;\">simulationStep</code> holds\n      the main logic, and\n      <code style=\"white-space: pre-wrap;\">shoot</code> shoots a particular\n      marble.\n    </p>\n    <p>Let’s walk through.</p>\n    <h4 id=\"initialpositions\">initialPositions</h4>\n    <div\n      class=\"sourceCode\"\n      id=\"cb176\"\n      data-caption=\"initialPositions function\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb176-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/logic/Physics.js</span></a>\n<a class=\"sourceLine\" id=\"cb176-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Physics <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb176-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb176-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @computed get <span class=\"at\" style=\"color: #7d9029;\">initialPositions</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb176-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> width<span class=\"op\" style=\"color: #666666;\">,</span> height<span class=\"op\" style=\"color: #666666;\">,</span> MarbleR <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              center <span class=\"op\" style=\"color: #666666;\">=</span> width/<span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb176-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb176-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> lines <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">4</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              maxY <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">200</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb176-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb176-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> marbles <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">range</span>(lines<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">-1</span>).<span class=\"at\" style=\"color: #7d9029;\">map</span>(y <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb176-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (y <span class=\"op\" style=\"color: #666666;\">===</span> lines) <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> [<span class=\"op\" style=\"color: #666666;\">{</span> <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> center<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> maxY<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                       <span class=\"dt\" style=\"color: #902000;\">vx</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">vy</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dt\" style=\"color: #902000;\">r</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">MarbleR</span><span class=\"op\" style=\"color: #666666;\">}</span>]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb176-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb176-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> left <span class=\"op\" style=\"color: #666666;\">=</span> center <span class=\"op\" style=\"color: #666666;\">-</span> y<span class=\"op\" style=\"color: #666666;\">*</span>(MarbleR<span class=\"op\" style=\"color: #666666;\">+</span><span class=\"dv\" style=\"color: #40a070;\">5</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                  right <span class=\"op\" style=\"color: #666666;\">=</span> center <span class=\"op\" style=\"color: #666666;\">+</span> y<span class=\"op\" style=\"color: #666666;\">*</span>(MarbleR<span class=\"op\" style=\"color: #666666;\">+</span><span class=\"dv\" style=\"color: #40a070;\">5</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb176-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb176-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">range</span>(left<span class=\"op\" style=\"color: #666666;\">,</span> right<span class=\"op\" style=\"color: #666666;\">,</span> MarbleR<span class=\"op\" style=\"color: #666666;\">*</span><span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">+</span><span class=\"dv\" style=\"color: #40a070;\">5</span>).<span class=\"at\" style=\"color: #7d9029;\">map</span>(x <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> (<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb176-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> x<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> maxY<span class=\"op\" style=\"color: #666666;\">-</span>y<span class=\"op\" style=\"color: #666666;\">*</span>(MarbleR<span class=\"op\" style=\"color: #666666;\">*</span><span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">+</span><span class=\"dv\" style=\"color: #40a070;\">5</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">vx</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">vy</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">r</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">MarbleR</span></a>\n<a class=\"sourceLine\" id=\"cb176-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">}</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb176-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>).<span class=\"at\" style=\"color: #7d9029;\">reduce</span>((acc<span class=\"op\" style=\"color: #666666;\">,</span> pos) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">acc</span>.<span class=\"at\" style=\"color: #7d9029;\">concat</span>(pos)<span class=\"op\" style=\"color: #666666;\">,</span> [])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb176-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb176-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        marbles <span class=\"op\" style=\"color: #666666;\">=</span> [].<span class=\"at\" style=\"color: #7d9029;\">concat</span>(marbles<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb176-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> width/<span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> height<span class=\"dv\" style=\"color: #40a070;\">-150</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">vx</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">vy</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb176-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">r</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">MarbleR</span></a>\n<a class=\"sourceLine\" id=\"cb176-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb176-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb176-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">marbles</span>.<span class=\"at\" style=\"color: #7d9029;\">forEach</span>((m<span class=\"op\" style=\"color: #666666;\">,</span> i) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> marbles[i].<span class=\"at\" style=\"color: #7d9029;\">id</span> <span class=\"op\" style=\"color: #666666;\">=</span> i)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb176-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb176-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> marbles<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb176-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb176-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb176-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Believe it or not, this is like one of those\n      <em>“Arrange things in a triangle”</em> puzzles you’d see in an old Learn\n      How To Program book. Or a whiteboard interview.\n    </p>\n    <p>It took me 3 hours to build. Easy to get wrong, fiddly to implement.</p>\n    <p>\n      We start with a <code style=\"white-space: pre-wrap;\">range</code> of\n      numbers. From <code style=\"white-space: pre-wrap;\">lines</code> to\n      <code style=\"white-space: pre-wrap;\">0</code> in descending order. We\n      iterate through this list of rows and change each into a list of marbles.\n    </p>\n    <p>\n      4 marbles in the first row, 3 in the next, all the way down to 1 in last\n      row.\n    </p>\n    <p>\n      For each row, we calculate how much space we have on the\n      <code style=\"white-space: pre-wrap;\">left</code> and\n      <code style=\"white-space: pre-wrap;\">right</code> of the center and make\n      a <code style=\"white-space: pre-wrap;\">range</code> of horizontal\n      positions from <code style=\"white-space: pre-wrap;\">left</code> to\n      <code style=\"white-space: pre-wrap;\">right</code> with a step of “1\n      marble size”. Using these positions and the known row, we create marbles\n      as needed.\n    </p>\n    <p>\n      We use a <code style=\"white-space: pre-wrap;\">.reduce</code> to flatten\n      nested arrays and add the last marble. That’s a corner case I couldn’t\n      solve elegantly, but I’m sure it’s possible.\n    </p>\n    <p>\n      In the end, we add an <code style=\"white-space: pre-wrap;\">id</code> to\n      each marble. We’re using index as the id, that’s true, but that still\n      ensures we use consistent values throughout our app. Positions in the\n      array may change.\n    </p>\n    <h4 id=\"shoot-and-startgameloop\">shoot and startGameLoop</h4>\n    <div\n      class=\"sourceCode\"\n      id=\"cb177\"\n      data-caption=\"shoot and startGameLoop functions\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb177-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/logic/Physics.js</span></a>\n<a class=\"sourceLine\" id=\"cb177-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> Physics <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb177-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb177-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb177-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @action <span class=\"at\" style=\"color: #7d9029;\">startGameLoop</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb177-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">initialPositions</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb177-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb177-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">timer</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">timer</span>(() <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">simulationStep</span>())<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb177-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb177-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb177-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb177-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb177-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    @action <span class=\"at\" style=\"color: #7d9029;\">shoot</span>(<span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> vx<span class=\"op\" style=\"color: #666666;\">,</span> vy <span class=\"op\" style=\"color: #666666;\">},</span> i) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb177-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> maxSpeed <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"dv\" style=\"color: #40a070;\">20</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb177-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb177-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">x</span> <span class=\"op\" style=\"color: #666666;\">=</span> x<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb177-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">y</span> <span class=\"op\" style=\"color: #666666;\">=</span> y<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb177-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">vx</span> <span class=\"op\" style=\"color: #666666;\">=</span> vx <span class=\"op\" style=\"color: #666666;\">&lt;</span> maxSpeed <span class=\"op\" style=\"color: #666666;\">?</span> vx : maxSpeed<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb177-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">vy</span> <span class=\"op\" style=\"color: #666666;\">=</span> vy <span class=\"op\" style=\"color: #666666;\">&lt;</span> maxSpeed <span class=\"op\" style=\"color: #666666;\">?</span> vy : maxSpeed<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb177-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb177-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      <code style=\"white-space: pre-wrap;\">shoot</code> and\n      <code style=\"white-space: pre-wrap;\">startGameLoop</code> are the\n      simplest functions in our physics engine.\n      <code style=\"white-space: pre-wrap;\">startGameLoop</code> gets the\n      initial <code style=\"white-space: pre-wrap;\">marbles</code> array and\n      starts a D3 timer.\n      <code style=\"white-space: pre-wrap;\">shoot</code> updates a specific\n      marble’s coordinates and speed vector.\n    </p>\n    <p>👌</p>"
        },
        {
          "lectureTitle": "Collision detection",
          "lectureBody": "    <h4 id=\"simulationstep-where-collisions-collision\">\n      simulationStep – where collisions collision\n    </h4>\n    <p>Here comes the fun part. The one with our game loop.</p>\n    <p>\n      There’s also a video explaining how this works 👉\n      <a href=\"https://www.youtube.com/watch?v=H84fmXjTElM\"\n        >Watch it on YouTube</a\n      >. With hand-drawn sketches that explain the math, and I think that’s\n      neat.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb178\"\n      data-caption=\"Full simulationStep function\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb178-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb178-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">@action <span class=\"at\" style=\"color: #7d9029;\">simulationStep</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb178-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> width<span class=\"op\" style=\"color: #666666;\">,</span> height<span class=\"op\" style=\"color: #666666;\">,</span> MarbleR <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb178-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> moveMarble <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span>x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> vx<span class=\"op\" style=\"color: #666666;\">,</span> vy<span class=\"op\" style=\"color: #666666;\">,</span> id<span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb178-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> _vx <span class=\"op\" style=\"color: #666666;\">=</span> ((x<span class=\"op\" style=\"color: #666666;\">+</span>vx <span class=\"op\" style=\"color: #666666;\">&lt;</span> MarbleR) <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"op\" style=\"color: #666666;\">-</span>vx : (x<span class=\"op\" style=\"color: #666666;\">+</span>vx <span class=\"op\" style=\"color: #666666;\">&gt;</span> width<span class=\"op\" style=\"color: #666666;\">-</span>MarbleR) <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"op\" style=\"color: #666666;\">-</span>vx : vx)<span class=\"op\" style=\"color: #666666;\">*</span>.<span class=\"dv\" style=\"color: #40a070;\">99</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            _vy <span class=\"op\" style=\"color: #666666;\">=</span> ((y<span class=\"op\" style=\"color: #666666;\">+</span>vy <span class=\"op\" style=\"color: #666666;\">&lt;</span> MarbleR) <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"op\" style=\"color: #666666;\">-</span>vy : (y<span class=\"op\" style=\"color: #666666;\">+</span>vy <span class=\"op\" style=\"color: #666666;\">&gt;</span> height<span class=\"op\" style=\"color: #666666;\">-</span>MarbleR) <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"op\" style=\"color: #666666;\">-</span>vy : vy)<span class=\"op\" style=\"color: #666666;\">*</span>.<span class=\"dv\" style=\"color: #40a070;\">99</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb178-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// nearest marble is a collision candidate</span></a>\n<a class=\"sourceLine\" id=\"cb178-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> subdividedSpace <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">quadtree</span>().<span class=\"at\" style=\"color: #7d9029;\">extent</span>([[<span class=\"op\" style=\"color: #666666;\">-</span><span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">-1</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                                   [<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span><span class=\"op\" style=\"color: #666666;\">+</span><span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span><span class=\"op\" style=\"color: #666666;\">+</span><span class=\"dv\" style=\"color: #40a070;\">1</span>]])</a>\n<a class=\"sourceLine\" id=\"cb178-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                          .<span class=\"at\" style=\"color: #7d9029;\">x</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">satisfied</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb178-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                          .<span class=\"at\" style=\"color: #7d9029;\">y</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span>)</a>\n<a class=\"sourceLine\" id=\"cb178-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                          .<span class=\"at\" style=\"color: #7d9029;\">addAll</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span></a>\n<a class=\"sourceLine\" id=\"cb178-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                                      .<span class=\"at\" style=\"color: #7d9029;\">filter</span>(m <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> id <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"va\" style=\"color: #19177c;\">m</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span>))<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              candidate <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">subdividedSpace</span>.<span class=\"at\" style=\"color: #7d9029;\">find</span>(x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> MarbleR<span class=\"op\" style=\"color: #666666;\">*</span><span class=\"dv\" style=\"color: #40a070;\">2</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb178-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (candidate) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb178-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb178-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// borrowing @air_hadoken&#39;s implementation from here:</span></a>\n<a class=\"sourceLine\" id=\"cb178-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// github.com/airhadoken/game_of_circles/</span></a>\n<a class=\"sourceLine\" id=\"cb178-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//   blob/master/circles.js#L64</span></a>\n<a class=\"sourceLine\" id=\"cb178-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> cx <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                  cy <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                  normx <span class=\"op\" style=\"color: #666666;\">=</span> cx <span class=\"op\" style=\"color: #666666;\">-</span> x<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                  normy <span class=\"op\" style=\"color: #666666;\">=</span> cy <span class=\"op\" style=\"color: #666666;\">-</span> y<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                  dist <span class=\"op\" style=\"color: #666666;\">=</span> (normx <span class=\"op\" style=\"color: #666666;\">**</span> <span class=\"dv\" style=\"color: #40a070;\">2</span> <span class=\"op\" style=\"color: #666666;\">+</span> normy <span class=\"op\" style=\"color: #666666;\">**</span> <span class=\"dv\" style=\"color: #40a070;\">2</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                  c <span class=\"op\" style=\"color: #666666;\">=</span> (_vx <span class=\"op\" style=\"color: #666666;\">*</span> normx <span class=\"op\" style=\"color: #666666;\">+</span> _vy <span class=\"op\" style=\"color: #666666;\">*</span> normy) / dist <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"fl\" style=\"color: #40a070;\">2.3</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb178-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            _vx <span class=\"op\" style=\"color: #666666;\">=</span> (_vx <span class=\"op\" style=\"color: #666666;\">-</span> c <span class=\"op\" style=\"color: #666666;\">*</span> normx)/<span class=\"fl\" style=\"color: #40a070;\">2.3</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            _vy <span class=\"op\" style=\"color: #666666;\">=</span> (_vy <span class=\"op\" style=\"color: #666666;\">-</span> c <span class=\"op\" style=\"color: #666666;\">*</span> normy)/<span class=\"fl\" style=\"color: #40a070;\">2.3</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb178-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">vx</span> <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"op\" style=\"color: #666666;\">-</span>_vx<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">vy</span> <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"op\" style=\"color: #666666;\">-</span>_vy<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span> <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"op\" style=\"color: #666666;\">-</span>_vx<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span> <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"op\" style=\"color: #666666;\">-</span>_vy<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb178-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb178-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb178-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> x <span class=\"op\" style=\"color: #666666;\">+</span> _vx<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> y <span class=\"op\" style=\"color: #666666;\">+</span> _vy<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">vx</span><span class=\"op\" style=\"color: #666666;\">:</span> _vx<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb178-43\" title=\"43\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"dt\" style=\"color: #902000;\">vy</span><span class=\"op\" style=\"color: #666666;\">:</span> _vy</a>\n<a class=\"sourceLine\" id=\"cb178-44\" title=\"44\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb178-45\" title=\"45\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb178-46\" title=\"46\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb178-47\" title=\"47\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">marbles</span>.<span class=\"at\" style=\"color: #7d9029;\">forEach</span>((marble<span class=\"op\" style=\"color: #666666;\">,</span> i) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb178-48\" title=\"48\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> vx<span class=\"op\" style=\"color: #666666;\">,</span> vy <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">moveMarble</span>(marble)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-49\" title=\"49\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb178-50\" title=\"50\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">x</span> <span class=\"op\" style=\"color: #666666;\">=</span> x<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-51\" title=\"51\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">y</span> <span class=\"op\" style=\"color: #666666;\">=</span> y<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-52\" title=\"52\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">vx</span> <span class=\"op\" style=\"color: #666666;\">=</span> vx<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-53\" title=\"53\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">vy</span> <span class=\"op\" style=\"color: #666666;\">=</span> vy<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-54\" title=\"54\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb178-55\" title=\"55\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>That’s a lot of code 😅. Let’s break it down.</p>\n    <p>\n      You can think of\n      <code style=\"white-space: pre-wrap;\">simulationStep</code> as a function\n      and a loop. At the bottom, there is a\n      <code style=\"white-space: pre-wrap;\">.forEach</code> that applies a\n      <code style=\"white-space: pre-wrap;\">moveMarble</code> function to each\n      marble.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb179\"\n      data-caption=\"Loop through marbles\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb179-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">marbles</span>.<span class=\"at\" style=\"color: #7d9029;\">forEach</span>((marble<span class=\"op\" style=\"color: #666666;\">,</span> i) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb179-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> vx<span class=\"op\" style=\"color: #666666;\">,</span> vy <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">moveMarble</span>(marble)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb179-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb179-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">x</span> <span class=\"op\" style=\"color: #666666;\">=</span> x<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb179-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">y</span> <span class=\"op\" style=\"color: #666666;\">=</span> y<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb179-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">vx</span> <span class=\"op\" style=\"color: #666666;\">=</span> vx<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb179-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span>[i].<span class=\"at\" style=\"color: #7d9029;\">vy</span> <span class=\"op\" style=\"color: #666666;\">=</span> vy<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb179-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We iterate over the list of marbles, feed them into\n      <code style=\"white-space: pre-wrap;\">moveMarble</code>, get new\n      properties, and save them in the main marbles array. MobX\n      <em>should</em> allows us to change these values inside\n      <code style=\"white-space: pre-wrap;\">moveMarble</code> and let MobX\n      observables do the heavy lifting, but more explicit code is easier to\n      read.\n    </p>\n    <h5 id=\"movemarble\">moveMarble</h5>\n    <p>\n      <code style=\"white-space: pre-wrap;\">moveMarble</code> is itself a hairy\n      function. Stuff happens in 3 steps:\n    </p>\n    <ol type=\"1\">\n      <li>Handle collisions with walls</li>\n      <li>Find collision with closest other marble</li>\n      <li>Handle collision with marble</li>\n    </ol>\n    <p>\n      <strong>Handling collisions with walls</strong> happens in two lines of\n      code. One per axis.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb180\"\n      data-caption=\"Detecting wall collisions\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb180-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> _vx <span class=\"op\" style=\"color: #666666;\">=</span> ((x<span class=\"op\" style=\"color: #666666;\">+</span>vx <span class=\"op\" style=\"color: #666666;\">&lt;</span> MarbleR) <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"op\" style=\"color: #666666;\">-</span>vx : (x<span class=\"op\" style=\"color: #666666;\">+</span>vx <span class=\"op\" style=\"color: #666666;\">&gt;</span> width<span class=\"op\" style=\"color: #666666;\">-</span>MarbleR) <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"op\" style=\"color: #666666;\">-</span>vx : vx)<span class=\"op\" style=\"color: #666666;\">*</span>.<span class=\"dv\" style=\"color: #40a070;\">99</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb180-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    _vy <span class=\"op\" style=\"color: #666666;\">=</span> ((y<span class=\"op\" style=\"color: #666666;\">+</span>vy <span class=\"op\" style=\"color: #666666;\">&lt;</span> MarbleR) <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"op\" style=\"color: #666666;\">-</span>vy : (y<span class=\"op\" style=\"color: #666666;\">+</span>vy <span class=\"op\" style=\"color: #666666;\">&gt;</span> height<span class=\"op\" style=\"color: #666666;\">-</span>MarbleR) <span class=\"op\" style=\"color: #666666;\">?</span> <span class=\"op\" style=\"color: #666666;\">-</span>vy : vy)<span class=\"op\" style=\"color: #666666;\">*</span>.<span class=\"dv\" style=\"color: #40a070;\">99</span><span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      Nested ternary expressions are kinda messy, but good enough. If a marble\n      is beyond any boundary, we reverse its direction. We\n      <em>always</em> apply a\n      <code style=\"white-space: pre-wrap;\">.99</code> friction coefficient so\n      that marbles slow down.\n    </p>\n    <p>\n      <strong>Finding collisions</strong> with the next closest marble happens\n      using a quadtree. Since we don’t have too many marbles, we can build a\n      new quadtree every time.\n    </p>\n    <p>\n      {aside} A quadtree is a way to subdivide space into areas. It lets us\n      answer the question of “What’s close enough to me to possibly touch me?”\n      without making too many position comparisons.\n    </p>\n    <p>\n      Checking every marble with every other marble produces 81 comparisons.\n      Versus 2 comparisons using a quadtree. {/aside}\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb181\"\n      data-caption=\"Finding collision candidates\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb181-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// nearest marble is a collision candidate</span></a>\n<a class=\"sourceLine\" id=\"cb181-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> subdividedSpace <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">quadtree</span>().<span class=\"at\" style=\"color: #7d9029;\">extent</span>([[<span class=\"op\" style=\"color: #666666;\">-</span><span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">-1</span>]<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb181-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                           [<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span><span class=\"op\" style=\"color: #666666;\">+</span><span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span><span class=\"op\" style=\"color: #666666;\">+</span><span class=\"dv\" style=\"color: #40a070;\">1</span>]])</a>\n<a class=\"sourceLine\" id=\"cb181-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                  .<span class=\"at\" style=\"color: #7d9029;\">x</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"op\" style=\"color: #666666;\">:</span>satisfied<span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb181-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                  .<span class=\"at\" style=\"color: #7d9029;\">y</span>(d <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">d</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span>)</a>\n<a class=\"sourceLine\" id=\"cb181-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                  .<span class=\"at\" style=\"color: #7d9029;\">addAll</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">marbles</span></a>\n<a class=\"sourceLine\" id=\"cb181-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                                              .<span class=\"at\" style=\"color: #7d9029;\">filter</span>(m <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> id <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"va\" style=\"color: #19177c;\">m</span>.<span class=\"at\" style=\"color: #7d9029;\">id</span>))<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb181-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      candidate <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">subdividedSpace</span>.<span class=\"at\" style=\"color: #7d9029;\">find</span>(x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> MarbleR<span class=\"op\" style=\"color: #666666;\">*</span><span class=\"dv\" style=\"color: #40a070;\">2</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We’re using\n      <a href=\"https://github.com/d3/d3-quadtree\"\n        ><code style=\"white-space: pre-wrap;\">d3-quadtree</code></a\n      >\n      for the quadtree implementation. It takes an\n      <code style=\"white-space: pre-wrap;\">extent</code>, which tells it how\n      big our space is. An <code style=\"white-space: pre-wrap;\">x</code> and\n      <code style=\"white-space: pre-wrap;\">y</code> accessor tells it how to\n      get coordinates out of our marble objects, and we use\n      <code style=\"white-space: pre-wrap;\">addAll</code> to fill the quadtree\n      with marbles.\n    </p>\n    <p>\n      To avoid detecting each marble as colliding with itself, we take each\n      marble out of our list before feeding the quadtree.\n    </p>\n    <p>\n      Once we have a quadtree, we use\n      <code style=\"white-space: pre-wrap;\">.find</code> to look for the nearest\n      marble within two radiuses –\n      <code style=\"white-space: pre-wrap;\">MarbleR*2</code> – of the current\n      marble. That’s exactly the one we’re colliding with! 😄\n    </p>\n    <p>\n      <strong>Handling collisions with marbles</strong> involves math. The sort\n      of thing you think you remember from high school, and suddenly realize\n      you don’t when the time comes to use it.\n    </p>\n    <p>Code looks like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb182\"\n      data-caption=\"Handling marble collisions\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb182-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (candidate) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb182-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb182-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// borrowing @air_hadoken&#39;s implementation from here:</span></a>\n<a class=\"sourceLine\" id=\"cb182-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// github.com/airhadoken/game_of_circles/</span></a>\n<a class=\"sourceLine\" id=\"cb182-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//   blob/master/circles.js#L64</span></a>\n<a class=\"sourceLine\" id=\"cb182-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> cx <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb182-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          cy <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb182-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          normx <span class=\"op\" style=\"color: #666666;\">=</span> cx <span class=\"op\" style=\"color: #666666;\">-</span> x<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb182-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          normy <span class=\"op\" style=\"color: #666666;\">=</span> cy <span class=\"op\" style=\"color: #666666;\">-</span> y<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb182-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          dist <span class=\"op\" style=\"color: #666666;\">=</span> (normx <span class=\"op\" style=\"color: #666666;\">**</span> <span class=\"dv\" style=\"color: #40a070;\">2</span> <span class=\"op\" style=\"color: #666666;\">+</span> normy <span class=\"op\" style=\"color: #666666;\">**</span> <span class=\"dv\" style=\"color: #40a070;\">2</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb182-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">          c <span class=\"op\" style=\"color: #666666;\">=</span> (_vx <span class=\"op\" style=\"color: #666666;\">*</span> normx <span class=\"op\" style=\"color: #666666;\">+</span> _vy <span class=\"op\" style=\"color: #666666;\">*</span> normy) / dist <span class=\"op\" style=\"color: #666666;\">*</span> <span class=\"fl\" style=\"color: #40a070;\">2.3</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb182-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb182-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    _vx <span class=\"op\" style=\"color: #666666;\">=</span> (_vx <span class=\"op\" style=\"color: #666666;\">-</span> c <span class=\"op\" style=\"color: #666666;\">*</span> normx)/<span class=\"fl\" style=\"color: #40a070;\">2.3</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb182-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    _vy <span class=\"op\" style=\"color: #666666;\">=</span> (_vy <span class=\"op\" style=\"color: #666666;\">-</span> c <span class=\"op\" style=\"color: #666666;\">*</span> normy)/<span class=\"fl\" style=\"color: #40a070;\">2.3</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb182-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb182-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">vx</span> <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"op\" style=\"color: #666666;\">-</span>_vx<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb182-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">vy</span> <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"op\" style=\"color: #666666;\">-</span>_vy<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb182-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">x</span> <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"op\" style=\"color: #666666;\">-</span>_vx<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb182-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">candidate</span>.<span class=\"at\" style=\"color: #7d9029;\">y</span> <span class=\"op\" style=\"color: #666666;\">+=</span> <span class=\"op\" style=\"color: #666666;\">-</span>_vy<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb182-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb182-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb182-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb182-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">x</span><span class=\"op\" style=\"color: #666666;\">:</span> x <span class=\"op\" style=\"color: #666666;\">+</span> _vx<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb182-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">y</span><span class=\"op\" style=\"color: #666666;\">:</span> y <span class=\"op\" style=\"color: #666666;\">+</span> _vy<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb182-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">vx</span><span class=\"op\" style=\"color: #666666;\">:</span> _vx<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb182-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">vy</span><span class=\"op\" style=\"color: #666666;\">:</span> _vy</a>\n<a class=\"sourceLine\" id=\"cb182-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      Ok, the <code style=\"white-space: pre-wrap;\">return</code> statement\n      isn’t about handling collisions. It updates the current marble.\n    </p>\n    <p>\n      The rest looks like magic. I implemented it and it still looks like\n      magic.\n    </p>\n    <p>\n      You can think of\n      <code style=\"white-space: pre-wrap;\">[normx, normy]</code> as a vector\n      that points from current marble to collision candidate. It gives us\n      bounce direction. We use the\n      <a href=\"https://en.wikipedia.org/wiki/Euclidean_distance\"\n        >euclidean distance</a\n      >\n      formula to calculate the length of this vector. The distance between the\n      centers of both marbles.\n    </p>\n    <p>\n      Then we calculate the\n      <a href=\"https://en.wikipedia.org/wiki/Dot_product\">dot product</a>\n      between our marble’s speed vector and the collision direction vector. And\n      we normalize it by distance. Multiplying distance by\n      <code style=\"white-space: pre-wrap;\">2</code> accounts for there being\n      two marbles in the collision. That extra\n      <code style=\"white-space: pre-wrap;\">.3</code> made the simulation look\n      better.\n    </p>\n    <p>\n      Fiddling and experimentation are your best tools for magic values like\n      that 😉\n    </p>\n    <p>\n      Then we use the dot product scalar to adjust the marble’s speed vector.\n      Dividing by <code style=\"white-space: pre-wrap;\">2</code> takes into\n      account that half the energy goes to the other marble. This is true\n      because we assume their masses are equal.\n    </p>\n    <p>\n      Finally, we update the\n      <code style=\"white-space: pre-wrap;\">candidate</code> marble and make\n      sure it bounces off as well. We do it additively because that’s how it\n      happens in real life.\n    </p>\n    <p>\n      Two marbles traveling towards each other in exactly opposite directions\n      with exactly the same speed, will stop dead and stay there. As soon as\n      there’s any misalignment, deflection happens. If one is stationary, it\n      starts moving. If it’s moving in the same direction, it speeds up… etc.\n    </p>\n    <p>\n      The end result is\n      <a href=\"https://swizec.github.io/declarative-canvas-react-konva/\"\n        >a decent-looking simulation of billiards</a\n      >.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Speedy React alternatives",
      "lectures": [
        {
          "lectureTitle": "Using a React alternative like Preact or Inferno",
          "lectureBody": "    <h1 id=\"fractal-tree\">Using a React alternative like Preact or Inferno</h1>\n    <p>\n      We’ve been using React so far, and that’s worked great. React is fast,\n      easy to use, and not too hard to understand. However, two alternative\n      frameworks promise the ease of React, but faster with a smaller\n      footprint.\n    </p>\n    <p>\n      <a href=\"https://github.com/developit/preact\"><strong>Preact</strong></a>\n      looks just like React when you’re using it, but the smaller code\n      footprint means your apps open faster. Performing fewer sanity checks at\n      runtime makes it faster to run too. Async rendering can make your apps\n      feel even faster.\n    </p>\n    <p>\n      <a href=\"https://github.com/infernojs/inferno\"\n        ><strong>Inferno</strong></a\n      >\n      also promises to look just like React when you’re using it, but its sole\n      purpose in life is to be faster. According to its maintainers, converting\n      to Inferno can improve performance of your real-world app by up to 110%.\n    </p>\n    <p>\n      Both Preact and Inferno have a\n      <code style=\"white-space: pre-wrap;\">-compat</code> project that lets you\n      convert existing React projects without any code modifications. While\n      React has gotten much faster in recent years, so have Preact and Inferno.\n      You should give them a try.\n    </p>\n    <p>I know Uber uses Preact for their Uber lite mobile app.</p>"
        },
        {
          "lectureTitle": "Stress test your framework with a recursive fractal",
          "lectureBody": "    <h2 id=\"stress-test-your-framework-with-a-recursive-fractal\">\n      Stress test your framework with a recursive fractal\n    </h2>\n    <p>\n      To show you how these speed improvements look in real life, I’ve devised\n      a stress test. A\n      <a href=\"https://en.wikipedia.org/wiki/Pythagoras_tree_(fractal)\"\n        >pythagorean fractal tree</a\n      >\n      that moves around when you move your mouse.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/pythagorean-tree.png\"\n        alt=\"Pythagorean tree\"\n      />\n      <figcaption>Pythagorean tree</figcaption>\n    </figure>\n    <p>\n      It’s a great stress test because a render like this is the worst case\n      scenario for tree-based rendering. You have 2048 SVG nodes, deeply\n      nested, that all change props and re-render with every change.\n    </p>\n    <p>\n      You can see\n      <a href=\"https://github.com/Swizec/react-fractals\"\n        >the full code on Github</a\n      >. We’re going to focus on the recursive\n      <code style=\"white-space: pre-wrap;\">&lt;Pythagoras&gt;</code> component.\n    </p>\n    <h3 id=\"how-you-too-can-build-a-dancing-tree-fractal\">\n      How you too can build a dancing tree fractal\n    </h3>\n    <p>\n      Equipped with basic trigonometry, you need 3 ingredients to build a\n      dancing tree:\n    </p>\n    <ul>\n      <li>\n        a recursive\n        <code style=\"white-space: pre-wrap;\">&lt;Pythagoras&gt;</code>\n        component\n      </li>\n      <li>a mousemove listener</li>\n      <li>a memoized next-step-props calculation function</li>\n    </ul>\n    <p>\n      We’re using a\n      <code style=\"white-space: pre-wrap;\">&lt;Pythagoras&gt;</code> component\n      for each square and its two children, a D3 mouse listener, and some math\n      that a reader helped me with. We need D3 because its mouse listeners\n      automatically calculate mouse position relative to SVG coordinates.\n      <a href=\"https://en.wikipedia.org/wiki/Memoization\">Memoization</a> in\n      the math function helps us keep our code faster.\n    </p>\n    <p>\n      The\n      <code style=\"white-space: pre-wrap;\">&lt;Pythagoras&gt;</code> component\n      looks like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb183\"\n      data-caption=\"Recursive &lt;Pythagoras&gt; component\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb183-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> Pythagoras <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span> w<span class=\"op\" style=\"color: #666666;\">,</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y<span class=\"op\" style=\"color: #666666;\">,</span> heightFactor<span class=\"op\" style=\"color: #666666;\">,</span> lean<span class=\"op\" style=\"color: #666666;\">,</span> left<span class=\"op\" style=\"color: #666666;\">,</span> right<span class=\"op\" style=\"color: #666666;\">,</span> lvl<span class=\"op\" style=\"color: #666666;\">,</span> maxlvl <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb183-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (lvl <span class=\"op\" style=\"color: #666666;\">&gt;=</span> maxlvl <span class=\"op\" style=\"color: #666666;\">||</span> w <span class=\"op\" style=\"color: #666666;\">&lt;</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb183-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">null</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb183-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb183-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> nextRight<span class=\"op\" style=\"color: #666666;\">,</span> nextLeft<span class=\"op\" style=\"color: #666666;\">,</span> A<span class=\"op\" style=\"color: #666666;\">,</span> B <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">memoizedCalc</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb183-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">w</span><span class=\"op\" style=\"color: #666666;\">:</span> w<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb183-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">heightFactor</span><span class=\"op\" style=\"color: #666666;\">:</span> heightFactor<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb183-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">lean</span><span class=\"op\" style=\"color: #666666;\">:</span> lean</a>\n<a class=\"sourceLine\" id=\"cb183-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb183-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb183-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> rotate <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb183-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb183-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (left) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb183-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        rotate <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"vs\" style=\"color: #4070a0;\">`rotate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span><span class=\"op\" style=\"color: #666666;\">-</span>A<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\"> 0 </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>w<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb183-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span><span class=\"cf\" style=\"color: #007020; font-weight: bold;\">else</span> <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (right) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb183-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        rotate <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"vs\" style=\"color: #4070a0;\">`rotate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>B<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\"> </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>w<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\"> </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>w<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb183-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb183-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (</a>\n<a class=\"sourceLine\" id=\"cb183-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">&lt;</span>g transform<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\"> </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">) </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>rotate<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">`</span><span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb183-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>rect width<span class=\"op\" style=\"color: #666666;\">={</span>w<span class=\"op\" style=\"color: #666666;\">}</span> height<span class=\"op\" style=\"color: #666666;\">={</span>w<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                  x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                  style<span class=\"op\" style=\"color: #666666;\">={{</span><span class=\"dt\">fill</span><span class=\"op\">:</span> <span class=\"at\">interpolateViridis</span>(lvl/maxlvl)<span class=\"op\">}}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb183-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb183-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>Pythagoras w<span class=\"op\" style=\"color: #666666;\">={</span>nextLeft<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={-</span>nextLeft<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        lvl<span class=\"op\" style=\"color: #666666;\">={</span>lvl<span class=\"op\" style=\"color: #666666;\">+</span><span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">}</span> maxlvl<span class=\"op\" style=\"color: #666666;\">={</span>maxlvl<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        heightFactor<span class=\"op\" style=\"color: #666666;\">={</span>heightFactor<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        lean<span class=\"op\" style=\"color: #666666;\">={</span>lean<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        left /<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb183-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb183-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">&lt;</span>Pythagoras w<span class=\"op\" style=\"color: #666666;\">={</span>nextRight<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        x<span class=\"op\" style=\"color: #666666;\">={</span>w<span class=\"op\" style=\"color: #666666;\">-</span>nextRight<span class=\"op\" style=\"color: #666666;\">}</span> y<span class=\"op\" style=\"color: #666666;\">={-</span>nextRight<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        lvl<span class=\"op\" style=\"color: #666666;\">={</span>lvl<span class=\"op\" style=\"color: #666666;\">+</span><span class=\"dv\" style=\"color: #40a070;\">1</span><span class=\"op\" style=\"color: #666666;\">}</span> maxlvl<span class=\"op\" style=\"color: #666666;\">={</span>maxlvl<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        heightFactor<span class=\"op\" style=\"color: #666666;\">={</span>heightFactor<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        lean<span class=\"op\" style=\"color: #666666;\">={</span>lean<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb183-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                        right /<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb183-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb183-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb183-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb183-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      We break out of recursion when we get too deep or try to draw an\n      invisible square. Otherwise we:\n    </p>\n    <ul>\n      <li>\n        use <code style=\"white-space: pre-wrap;\">memoizedCalc</code> to do the\n        mathematics\n      </li>\n      <li>\n        define different\n        <code style=\"white-space: pre-wrap;\">rotate()</code> transforms for the\n        <code style=\"white-space: pre-wrap;\">left</code> and\n        <code style=\"white-space: pre-wrap;\">right</code> branches\n      </li>\n      <li>\n        return an SVG\n        <code style=\"white-space: pre-wrap;\">&lt;rect&gt;</code> for the\n        current rectangle, and two\n        <code style=\"white-space: pre-wrap;\">&lt;Pythagoras&gt;</code> elements\n        for each branch.\n      </li>\n    </ul>\n    <p>\n      Most of this code deals with passing props to children, which isn’t the\n      most elegant approach, but it works. The rest is about positioning\n      branches so corners match up.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/pythagoras-corners-match-up.png\"\n        alt=\"Corners matching up\"\n      />\n      <figcaption>Corners matching up</figcaption>\n    </figure>\n    <h4 id=\"the-math\">The math</h4>\n    <p>\n      I don’t <em>really</em> understand this math, but I sort of know where\n      it’s coming from. It’s the\n      <a href=\"https://en.wikipedia.org/wiki/Law_of_sines\">sine law</a> applied\n      correctly. The part I failed at\n      <a href=\"https://swizec.com/blog/fractals-react/swizec/7233\"\n        >when I tried</a\n      >\n      to do it myself.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb184\"\n      data-caption=\"Trigonometry that moves our fractal\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb184-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> memoizedCalc <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> () <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb184-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> memo <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{};</span></a>\n<a class=\"sourceLine\" id=\"cb184-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb184-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> key <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span> w<span class=\"op\" style=\"color: #666666;\">,</span> heightFactor<span class=\"op\" style=\"color: #666666;\">,</span> lean <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> [w<span class=\"op\" style=\"color: #666666;\">,</span>heightFactor<span class=\"op\" style=\"color: #666666;\">,</span> lean].<span class=\"at\" style=\"color: #7d9029;\">join</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;-&#39;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb184-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb184-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> (args) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb184-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> memoKey <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">key</span>(args)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb184-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb184-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (memo[memoKey]) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb184-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> memo[memoKey]<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb184-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span><span class=\"cf\" style=\"color: #007020; font-weight: bold;\">else</span><span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb184-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> w<span class=\"op\" style=\"color: #666666;\">,</span> heightFactor<span class=\"op\" style=\"color: #666666;\">,</span> lean <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> args<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb184-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb184-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> trigH <span class=\"op\" style=\"color: #666666;\">=</span> heightFactor<span class=\"op\" style=\"color: #666666;\">*</span>w<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb184-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb184-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> result <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb184-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">nextRight</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">sqrt</span>(trigH<span class=\"op\" style=\"color: #666666;\">**</span><span class=\"dv\" style=\"color: #40a070;\">2</span> <span class=\"op\" style=\"color: #666666;\">+</span> (w <span class=\"op\" style=\"color: #666666;\">*</span> (.<span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">+</span>lean))<span class=\"op\" style=\"color: #666666;\">**</span><span class=\"dv\" style=\"color: #40a070;\">2</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb184-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">nextLeft</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">sqrt</span>(trigH<span class=\"op\" style=\"color: #666666;\">**</span><span class=\"dv\" style=\"color: #40a070;\">2</span> <span class=\"op\" style=\"color: #666666;\">+</span> (w <span class=\"op\" style=\"color: #666666;\">*</span> (.<span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">-</span>lean))<span class=\"op\" style=\"color: #666666;\">**</span><span class=\"dv\" style=\"color: #40a070;\">2</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb184-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">A</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">deg</span>(<span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">atan</span>(trigH / ((.<span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">-</span>lean) <span class=\"op\" style=\"color: #666666;\">*</span> w)))<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb184-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                <span class=\"dt\" style=\"color: #902000;\">B</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">deg</span>(<span class=\"va\" style=\"color: #19177c;\">Math</span>.<span class=\"at\" style=\"color: #7d9029;\">atan</span>(trigH / ((.<span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">+</span>lean) <span class=\"op\" style=\"color: #666666;\">*</span> w)))</a>\n<a class=\"sourceLine\" id=\"cb184-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb184-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb184-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            memo[memoKey] <span class=\"op\" style=\"color: #666666;\">=</span> result<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb184-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> result<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb184-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb184-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb184-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a></code></pre>\n    </div>\n    <p>\n      We expanded the basic law of sines with a dynamic\n      <code style=\"white-space: pre-wrap;\">heightFactor</code> and\n      <code style=\"white-space: pre-wrap;\">lean</code> adjustment. We’ll\n      control those with mouse movement.\n    </p>\n    <p>\n      To improve performance our\n      <code style=\"white-space: pre-wrap;\">memoizedCalc</code> function has an\n      internal data store that maintains a hash of every argument tuple and its\n      result. So when we call\n      <code style=\"white-space: pre-wrap;\">memoizedCalc</code> with the same\n      arguments multiple times, it reads from cache instead of recalculating.\n    </p>\n    <p>\n      At 11 levels of recursion,\n      <code style=\"white-space: pre-wrap;\">memoizedCalc</code> is called 2,048\n      times and only returns 11 different results. Great candidate for\n      memoization if I ever saw one.\n    </p>\n    <p>\n      Of course, a benchmark would be great here. Maybe\n      <code style=\"white-space: pre-wrap;\">sqrt</code>,\n      <code style=\"white-space: pre-wrap;\">atan</code>, and\n      <code style=\"white-space: pre-wrap;\">**</code> aren’t <em>that</em> slow,\n      and our real bottleneck is redrawing all those nodes on every mouse move.\n      Hint: it totally is.\n    </p>\n    <p>\n      Our ability to memoize calculation also means that we could, in theory,\n      flatten our rendering. Instead of recursion, we could use iteration and\n      render in layers. Squares at each level are the same, just at different\n      <code style=\"white-space: pre-wrap;\">(x, y)</code> coordinates.\n    </p>\n    <p>This, however, would be far too tricky to implement.</p>\n    <h4 id=\"the-mouse-listener\">The mouse listener</h4>\n    <p>\n      Inside\n      <a href=\"https://github.com/Swizec/react-fractals/blob/master/src/App.js\"\n        ><code style=\"white-space: pre-wrap;\">App.js</code></a\n      >, we add a mouse event listener. We use D3’s because it gives us\n      SVG-relative position calculation out of the box. With React’s, we’d have\n      to do the hard work ourselves.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb185\"\n      data-caption=\"Reacting to mouse movement\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb185-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// App.js</span></a>\n<a class=\"sourceLine\" id=\"cb185-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb185-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">currentMax</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb185-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">baseW</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">80</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb185-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">heightFactor</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb185-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">lean</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"dv\" style=\"color: #40a070;\">0</span></a>\n<a class=\"sourceLine\" id=\"cb185-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">};</span></a>\n<a class=\"sourceLine\" id=\"cb185-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb185-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb185-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">d3select</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">refs</span>.<span class=\"at\" style=\"color: #7d9029;\">svg</span>)</a>\n<a class=\"sourceLine\" id=\"cb185-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">     .<span class=\"at\" style=\"color: #7d9029;\">on</span>(<span class=\"st\" style=\"color: #4070a0;\">&quot;mousemove&quot;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">onMouseMove</span>.<span class=\"at\" style=\"color: #7d9029;\">bind</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb185-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb185-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb185-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">onMouseMove</span>(event) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb185-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> [x<span class=\"op\" style=\"color: #666666;\">,</span> y] <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">d3mouse</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">refs</span>.<span class=\"at\" style=\"color: #7d9029;\">svg</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb185-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb185-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  scaleFactor <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>().<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>])</a>\n<a class=\"sourceLine\" id=\"cb185-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                             .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> .<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">sunglasses</span><span class=\"op\" style=\"color: #666666;\">:</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb185-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb185-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  scaleLean <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>().<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span>/<span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span>])</a>\n<a class=\"sourceLine\" id=\"cb185-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           .<span class=\"at\" style=\"color: #7d9029;\">range</span>([.<span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"fl\" style=\"color: #40a070;\">-.5</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb185-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb185-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb185-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">heightFactor</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">scaleFactor</span>(y)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb185-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">lean</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">scaleLean</span>(<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">satisfied</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb185-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb185-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb185-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb185-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb185-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb185-31\" title=\"31\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb185-32\" title=\"32\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb185-33\" title=\"33\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg ref<span class=\"op\" style=\"color: #666666;\">=</span><span class=\"st\" style=\"color: #4070a0;\">&quot;svg&quot;</span><span class=\"op\" style=\"color: #666666;\">&gt;</span> <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//...</span></a>\n<a class=\"sourceLine\" id=\"cb185-34\" title=\"34\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">&lt;</span>Pythagoras w<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">baseW</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb185-35\" title=\"35\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              h<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">baseW</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb185-36\" title=\"36\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">              heightFactor<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">heightFactor</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb185-37\" title=\"37\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             lean<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">lean</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb185-38\" title=\"38\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             x<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span>/<span class=\"dv\" style=\"color: #40a070;\">2-40</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb185-39\" title=\"39\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             y<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span><span class=\"op\" style=\"color: #666666;\">-</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">baseW</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb185-40\" title=\"40\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             lvl<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb185-41\" title=\"41\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">             maxlvl<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">currentMax</span><span class=\"op\" style=\"color: #666666;\">}</span>/&gt;</a>\n<a class=\"sourceLine\" id=\"cb185-42\" title=\"42\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>A few things happen here:</p>\n    <ul>\n      <li>\n        we set initial <code style=\"white-space: pre-wrap;\">lean</code> and\n        <code style=\"white-space: pre-wrap;\">heightFactor</code> to\n        <code style=\"white-space: pre-wrap;\">0</code>\n      </li>\n      <li>\n        in <code style=\"white-space: pre-wrap;\">componentDidMount</code>, we\n        use <code style=\"white-space: pre-wrap;\">d3.select</code> and\n        <code style=\"white-space: pre-wrap;\">.on</code> to add a mouse listener\n      </li>\n      <li>\n        we define an\n        <code style=\"white-space: pre-wrap;\">onMouseMove</code> method as the\n        listener\n      </li>\n      <li>\n        render the first\n        <code style=\"white-space: pre-wrap;\">&lt;Pythagoras&gt;</code> using\n        values from <code style=\"white-space: pre-wrap;\">state</code>\n      </li>\n    </ul>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">lean</code> parameter tells us\n      which way the tree is leaning and how much, the\n      <code style=\"white-space: pre-wrap;\">heightFactor</code> tells us how\n      high those triangles should be. We control both with the mouse position.\n    </p>\n    <p>\n      That happens in <code style=\"white-space: pre-wrap;\">onMouseMove</code>:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb186\"\n      data-caption=\"Moving the fractal as user moves mouse\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb186-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">onMouseMove</span>(event) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb186-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> [x<span class=\"op\" style=\"color: #666666;\">,</span> y] <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">d3mouse</span>(<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">refs</span>.<span class=\"at\" style=\"color: #7d9029;\">svg</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb186-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb186-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  scaleFactor <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>().<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span>])</a>\n<a class=\"sourceLine\" id=\"cb186-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                             .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> .<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">sunglasses</span><span class=\"op\" style=\"color: #666666;\">:</span>)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb186-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb186-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  scaleLean <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>().<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span>/<span class=\"dv\" style=\"color: #40a070;\">2</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span>])</a>\n<a class=\"sourceLine\" id=\"cb186-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">                           .<span class=\"at\" style=\"color: #7d9029;\">range</span>([.<span class=\"dv\" style=\"color: #40a070;\">5</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"fl\" style=\"color: #40a070;\">-.5</span>])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb186-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb186-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb186-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">heightFactor</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">scaleFactor</span>(y)<span class=\"op\" style=\"color: #666666;\">,</span></a>\n<a class=\"sourceLine\" id=\"cb186-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"dt\" style=\"color: #902000;\">lean</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"at\" style=\"color: #7d9029;\">scaleLean</span>(<span class=\"op\" style=\"color: #666666;\">:</span><span class=\"dt\" style=\"color: #902000;\">satisfied</span><span class=\"op\" style=\"color: #666666;\">:</span></a>\n<a class=\"sourceLine\" id=\"cb186-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb186-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      <code style=\"white-space: pre-wrap;\">d3mouse</code> - an imported\n      <code style=\"white-space: pre-wrap;\">mouse</code> function from\n      <code style=\"white-space: pre-wrap;\">d3-selection</code> - gives us\n      cursor position relative to the SVG element. Two linear scales give us\n      <code style=\"white-space: pre-wrap;\">scaleFactor</code> and\n      <code style=\"white-space: pre-wrap;\">scaleLean</code> values, which we\n      put into component state.\n    </p>\n    <p>\n      When we feed a change to\n      <code style=\"white-space: pre-wrap;\">this.setState</code>, it triggers a\n      re-render of the entire tree, our\n      <code style=\"white-space: pre-wrap;\">memoizedCalc</code> function returns\n      new values, and the final result is a dancing tree.\n    </p>\n    <figure>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/pythagoras-dancing.gif\"\n        alt=\"Dancing Pythagoras tree\"\n      />\n      <figcaption>Dancing Pythagoras tree</figcaption>\n    </figure>\n    <p>Beautious. 😍</p>"
        },
        {
          "lectureTitle": "Stress testing Preact and Inferno",
          "lectureBody": "    <h2 id=\"trying-the-stress-test-in-preact-and-inferno\">\n      Trying the stress test in Preact and Inferno\n    </h2>\n    <p>\n      The Pythagoras tree example got converted into 6 different UI libraries:\n      React, Preact, Inferno, Vue, Angular 2, and CycleJS.\n    </p>\n    <p>\n      Mostly by the creators of those libraries themselves because they’re\n      awesome and much smarter than I am. You can see the result, in gifs, on\n      <a\n        href=\"https://swizec.com/blog/animating-svg-nodes-react-preact-inferno-vue/swizec/7311\"\n        >my blog here</a\n      >.\n    </p>\n    <p>\n      We’re focusing on React-like libraries, so here’s a rundown of changes\n      required for Preact and Inferno with links to full code.\n    </p>\n    <h3 id=\"preact\">Preact</h3>\n    <p>\n      Implemented by Jason Miller, creator of Preact.\n      <a href=\"https://github.com/developit/preact-fractals\"\n        >Full code on Github</a\n      >\n    </p>\n    <p>\n      <img\n        src=\"https://raw.githubusercontent.com/Swizec/react-d3js-es6-ebook/2018-version/manuscript/resources/images/es6v2/preact-pythagora.gif\"\n      />\n    </p>\n    <p>\n      Jason used the\n      <code style=\"white-space: pre-wrap;\">preact-compat</code> layer to make\n      Preact pretend that it’s React. This might impact performance.\n    </p>\n    <p>\n      What I love about the Preact example is that it uses async rendering to\n      look smoother. You can see the redraw cycle lag behind the mouse movement\n      producing curious effects.\n    </p>\n    <p>I like it.</p>\n    <p>\n      Here’s how he did it:\n      <a\n        href=\"https://github.com/Swizec/react-fractals/compare/master...developit:master\"\n        >full diff on github</a\n      >\n    </p>\n    <p>\n      In <code style=\"white-space: pre-wrap;\">package.json</code>, he added\n      <code style=\"white-space: pre-wrap;\">preact</code>,\n      <code style=\"white-space: pre-wrap;\">preact-compat</code>, and preact\n      -compat clones for React libraries. I guess you need the latter so you\n      don’t have to change your imports.\n    </p>\n    <p>\n      He changed the functional\n      <code style=\"white-space: pre-wrap;\">Pythagoras</code> component into a\n      stateful component to enable async rendering.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb187\"\n      data-caption=\"Change &lt;Pythagoras&gt; to a class\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb187-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/Pythagoras.js</span></a>\n<a class=\"sourceLine\" id=\"cb187-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">export</span> <span class=\"im\">default</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb187-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>(props) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb187-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"at\" style=\"color: #7d9029;\">Pythagoras</span>(props)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb187-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb187-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>And enabled debounced asynchronous rendering:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb188\"\n      data-caption=\"Debounce rendering\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb188-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/index.js</span></a>\n<a class=\"sourceLine\" id=\"cb188-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> options <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;preact&#39;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb188-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">options</span>.<span class=\"at\" style=\"color: #7d9029;\">syncComponentUpdates</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">false</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb188-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb188-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">//option 1:  rIC + setTimeout fallback</span></a>\n<a class=\"sourceLine\" id=\"cb188-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">let</span> timer<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb188-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"va\" style=\"color: #19177c;\">options</span>.<span class=\"at\" style=\"color: #7d9029;\">debounceRendering</span> <span class=\"op\" style=\"color: #666666;\">=</span> f <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb188-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">clearTimeout</span>(timer)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb188-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    timer <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">setTimeout</span>(f<span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">100</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb188-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">requestIdleCallback</span>(f)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb188-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      My favorite part is that you can use Preact as a drop-in replacement for\n      React and it Just Works™ <em>and</em> works well. This is promising for\n      anyone who wants a quick win in their codebase.\n    </p>\n    <h3 id=\"inferno\">Inferno</h3>\n    <p>\n      Implemented by Dominic Gannaway, creator of Inferno.\n      <a href=\"https://github.com/trueadm/inferno-fractals\"\n        >Full code on Github</a\n      >\n    </p>\n    <p>\n      You <em>can</em> use Inferno as a drop-in replacement for React, and I\n      did when I tried to build this myself. Dominic says that impacts\n      performance, though, so he made a proper fork. You can see the\n      <a\n        href=\"https://github.com/Swizec/react-fractals/compare/master...trueadm:master\"\n        >full diff on Github</a\n      >\n    </p>\n    <p>\n      Dominic changed all\n      <code style=\"white-space: pre-wrap;\">react-scripts</code> references to\n      <code style=\"white-space: pre-wrap;\">inferno-scripts</code>, and it’s a\n      good sign that such a thing exists. He also changed the\n      <code style=\"white-space: pre-wrap;\">react</code> dependency to\n      <code style=\"white-space: pre-wrap;\">inferno-beta36</code>, but I’m sure\n      it’s out of beta by the time you’re reading this. The experiment was done\n      in December 2016.\n    </p>\n    <p>\n      From there, the main changes are to the imports – React becomes Inferno\n      – and he changed some class methods to bound fat arrow functions.\n      Probably a stylistic choice.\n    </p>\n    <p>\n      He also had to change a string-based ref into a callback ref. Inferno\n      doesn’t do string-based refs for performance reasons, and we need refs so\n      we can use D3 to detect mouse position on SVG.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb189\"\n      data-caption=\"Change ref to callback\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb189-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// src/App.js</span></a>\n<a class=\"sourceLine\" id=\"cb189-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb189-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> App <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb189-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb189-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  svgElemeRef <span class=\"op\" style=\"color: #666666;\">=</span> (domNode) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb189-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">svgElement</span> <span class=\"op\" style=\"color: #666666;\">=</span> domNode<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb189-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb189-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb189-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb189-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ..</span></a>\n<a class=\"sourceLine\" id=\"cb189-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">&lt;</span>svg width<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">width</span><span class=\"op\" style=\"color: #666666;\">}</span> height<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">svg</span>.<span class=\"at\" style=\"color: #7d9029;\">height</span><span class=\"op\" style=\"color: #666666;\">}</span> ref<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">svgElemeRef</span> <span class=\"op\" style=\"color: #666666;\">}&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb189-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      In the core\n      <code style=\"white-space: pre-wrap;\">Pythagoras</code> component, he\n      added two Inferno-specific props:\n      <code style=\"white-space: pre-wrap;\">noNormalize</code> and\n      <code style=\"white-space: pre-wrap;\">hasNonKeyedChildren</code>.\n    </p>\n    <p>\n      According to\n      <a href=\"https://github.com/trueadm/inferno/issues/565\">this issue</a>,\n      <code style=\"white-space: pre-wrap;\">noNormalize</code> is a\n      benchmark-focused flag that improves performance, and I can’t figure out\n      what\n      <code style=\"white-space: pre-wrap;\">hasNonKeyedChildren</code> does. I\n      assume both are performance optimizations for the Virtual DOM diffing\n      algorithm.\n    </p>"
        }
      ]
    },
    {
      "sectionTitle": "Refactor your components with React Hooks",
      "lectures": [
        {
          "lectureTitle": "An intro to hooks",
          "lectureBody": "    <h1 id=\"refactor-your-components-with-react-hooks\">\n      Refactor your components with React Hooks\n    </h1>\n    <p>\n      Hooks launched with great fanfare and community excitement in February\n      2019. A whole new way to write React components.\n    </p>\n    <p>\n      Not a fundamental change, the React team would say, but a mind shift\n      after all. A change in how you think about state, side effects, and\n      component structure. You might not like hooks at first. With a little\n      practice they’re going to feel more natural than the component lifecycle\n      model you’re used to now.\n    </p>\n    <p>Hooks exist to:</p>\n    <ul>\n      <li>help you write less code for little bits of logic</li>\n      <li>help you move logic out of your components</li>\n      <li>help you reuse logic between components</li>\n    </ul>\n    <p>\n      Some say it removes complexity around the\n      <code style=\"white-space: pre-wrap;\">this</code> keyword in JavaScript\n      and I’m not sure that it does. Yes, there’s no more\n      <code style=\"white-space: pre-wrap;\">this</code> because everything is a\n      function, that’s true. But you replace that with passing a lot of\n      function arguments around and being careful about function scope.\n    </p>\n    <p>\n      My favorite React Hooks magic trick is that you can and should write your\n      own. Reusable or not, a custom hook almost always cleans up your code.\n    </p>\n    <p>\n      Oh and good news! Hooks are backwards compatible. You can write new stuff\n      with hooks and keep your old stuff unchanged. 👌\n    </p>\n    <p>\n      In this section we’re going to look at the core React hooks, talk about\n      the most important hook for dataviz, then refactor our big example from\n      earlier to use hooks.\n    </p>\n    <p>\n      You’ll need to upgrade React to at least version\n      <code style=\"white-space: pre-wrap;\">16.8.0</code> to use hooks.\n    </p>"
        },
        {
          "lectureTitle": "useState, useEffect, and useContext",
          "lectureBody": "    <h2 id=\"usestate-useeffect-and-usecontext\">\n      useState, useEffect, and useContext\n    </h2>\n    <p>\n      React comes with\n      <a href=\"https://reactjs.org/docs/hooks-reference.html\"\n        >a bunch of basic and advanced hooks</a\n      >. The core hooks are:\n    </p>\n    <ul>\n      <li>\n        <code style=\"white-space: pre-wrap;\">useState</code> for managing state\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">useEffect</code> for side-effects\n      </li>\n      <li>\n        <code style=\"white-space: pre-wrap;\">useContext</code> for React’s\n        context API\n      </li>\n    </ul>\n    <p>Here’s how to think about them in a nutshell 👇</p>\n    <h3 id=\"usestate\">useState</h3>\n    <p>\n      The <code style=\"white-space: pre-wrap;\">useState</code> hook replaces\n      pairs of state getters and setters.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb190\"\n      data-caption=\"State without hooks\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb190-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> myComponent <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">Component</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb190-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb190-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">value</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;default&#39;</span></a>\n<a class=\"sourceLine\" id=\"cb190-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb190-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb190-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    handleChange <span class=\"op\" style=\"color: #666666;\">=</span> (e) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb190-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">value</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">e</span>.<span class=\"va\" style=\"color: #19177c;\">target</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span></a>\n<a class=\"sourceLine\" id=\"cb190-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb190-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb190-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb190-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> value <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb190-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb190-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>input value<span class=\"op\" style=\"color: #666666;\">={</span>value<span class=\"op\" style=\"color: #666666;\">}</span> onChange<span class=\"op\" style=\"color: #666666;\">={</span>handleChange<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb190-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb190-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>👇</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb191\"\n      data-caption=\"useState hook\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb191-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> myComponent <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb191-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> [value<span class=\"op\" style=\"color: #666666;\">,</span> setValue] <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">useState</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;default&#39;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb191-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb191-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> handleChange <span class=\"op\" style=\"color: #666666;\">=</span> (e) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"at\" style=\"color: #7d9029;\">setValue</span>(<span class=\"va\" style=\"color: #19177c;\">e</span>.<span class=\"va\" style=\"color: #19177c;\">target</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span>)</a>\n<a class=\"sourceLine\" id=\"cb191-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb191-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>input value<span class=\"op\" style=\"color: #666666;\">={</span>value<span class=\"op\" style=\"color: #666666;\">}</span> onChange<span class=\"op\" style=\"color: #666666;\">={</span>handleChange<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb191-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>Less code to write and understand.</p>\n    <p>In a class component you:</p>\n    <ul>\n      <li>set a default value</li>\n      <li>\n        create an <code style=\"white-space: pre-wrap;\">onChange</code> callback\n        that fires <code style=\"white-space: pre-wrap;\">setState</code>\n      </li>\n      <li>read value from state before rendering etc.</li>\n    </ul>\n    <p>\n      Without modern fat arrow syntax you might run into trouble with binds.\n    </p>\n    <p>\n      The hook approach moves that boilerplate to React’s plate. You call\n      <code style=\"white-space: pre-wrap;\">useState</code>. It takes a default\n      value and returns a getter and a setter.\n    </p>\n    <p>You call that setter in your change handler.</p>\n    <p>\n      Behind the scenes React subscribes your component to that change. Your\n      component re-renders.\n    </p>\n    <h3 id=\"useeffect\">useEffect</h3>\n    <p>\n      <code style=\"white-space: pre-wrap;\">useEffect</code> replaces the\n      <code style=\"white-space: pre-wrap;\">componentDidMount</code>,\n      <code style=\"white-space: pre-wrap;\">componentDidUpdate</code>,\n      <code style=\"white-space: pre-wrap;\">shouldComponentUpdate</code>,\n      <code style=\"white-space: pre-wrap;\">componentWillUnmount</code>\n      quadfecta. It’s like a trifecta, but four.\n    </p>\n    <p>\n      Say you want a side-effect when your component updates, like make an API\n      call. Gotta run it on mount and update. Want to subscribe to a DOM event?\n      Gotta unsubscribe on unmount.\n    </p>\n    <p>\n      Wanna do all this only when certain props change? Gotta check for that.\n    </p>\n    <p>Class:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb192\"\n      data-caption=\"Side-effects without hooks\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb192-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">class</span> myComp <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">extends</span> Component <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb192-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb192-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">value</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;default&#39;</span></a>\n<a class=\"sourceLine\" id=\"cb192-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb192-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb192-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    handleChange <span class=\"op\" style=\"color: #666666;\">=</span> (e) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">setState</span>(<span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb192-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"dt\" style=\"color: #902000;\">value</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"va\" style=\"color: #19177c;\">e</span>.<span class=\"va\" style=\"color: #19177c;\">target</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span></a>\n<a class=\"sourceLine\" id=\"cb192-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb192-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb192-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    saveValue <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"at\" style=\"color: #7d9029;\">fetch</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;/my/endpoint&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb192-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">method</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;POST&#39;</span></a>\n<a class=\"sourceLine\" id=\"cb192-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">body</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span></a>\n<a class=\"sourceLine\" id=\"cb192-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb192-14\" title=\"14\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb192-15\" title=\"15\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidMount</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb192-16\" title=\"16\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">saveValue</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb192-17\" title=\"17\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb192-18\" title=\"18\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb192-19\" title=\"19\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">componentDidUpdate</span>(prevProps<span class=\"op\" style=\"color: #666666;\">,</span> prevState) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb192-20\" title=\"20\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">if</span> (<span class=\"va\" style=\"color: #19177c;\">prevState</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span> <span class=\"op\" style=\"color: #666666;\">!==</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"va\" style=\"color: #19177c;\">state</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb192-21\" title=\"21\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">saveValue</span>()</a>\n<a class=\"sourceLine\" id=\"cb192-22\" title=\"22\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb192-23\" title=\"23\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb192-24\" title=\"24\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb192-25\" title=\"25\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">render</span>() <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb192-26\" title=\"26\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> <span class=\"op\" style=\"color: #666666;\">{</span> value <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">this</span>.<span class=\"at\" style=\"color: #7d9029;\">state</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb192-27\" title=\"27\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb192-28\" title=\"28\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">      <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>input value<span class=\"op\" style=\"color: #666666;\">={</span>value<span class=\"op\" style=\"color: #666666;\">}</span> onChange<span class=\"op\" style=\"color: #666666;\">={</span>handleChange<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb192-29\" title=\"29\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb192-30\" title=\"30\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>👇</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb193\"\n      data-caption=\"useEffect hook\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb193-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> myComponent <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb193-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> [value<span class=\"op\" style=\"color: #666666;\">,</span> setValue] <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">useState</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;default&#39;</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb193-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb193-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> handleChange <span class=\"op\" style=\"color: #666666;\">=</span> (e) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"at\" style=\"color: #7d9029;\">setValue</span>(<span class=\"va\" style=\"color: #19177c;\">e</span>.<span class=\"va\" style=\"color: #19177c;\">target</span>.<span class=\"at\" style=\"color: #7d9029;\">value</span>)</a>\n<a class=\"sourceLine\" id=\"cb193-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> saveValue <span class=\"op\" style=\"color: #666666;\">=</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"at\" style=\"color: #7d9029;\">fetch</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;/my/endpoint&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb193-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">method</span><span class=\"op\" style=\"color: #666666;\">:</span> <span class=\"st\" style=\"color: #4070a0;\">&#39;POST&#39;</span></a>\n<a class=\"sourceLine\" id=\"cb193-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"dt\" style=\"color: #902000;\">body</span><span class=\"op\" style=\"color: #666666;\">:</span> value</a>\n<a class=\"sourceLine\" id=\"cb193-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"op\" style=\"color: #666666;\">}</span>)</a>\n<a class=\"sourceLine\" id=\"cb193-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb193-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"at\" style=\"color: #7d9029;\">useEffect</span>(saveValue<span class=\"op\" style=\"color: #666666;\">,</span> [value])<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb193-11\" title=\"11\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb193-12\" title=\"12\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>input value<span class=\"op\" style=\"color: #666666;\">={</span>value<span class=\"op\" style=\"color: #666666;\">}</span> onChange<span class=\"op\" style=\"color: #666666;\">={</span>handleChange<span class=\"op\" style=\"color: #666666;\">}</span> /&gt;</a>\n<a class=\"sourceLine\" id=\"cb193-13\" title=\"13\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>So much less code!</p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">useEffect</code> runs your function\n      on <code style=\"white-space: pre-wrap;\">componentDidMount</code> and\n      <code style=\"white-space: pre-wrap;\">componentDidUpdate</code>. And that\n      second argument, the\n      <code style=\"white-space: pre-wrap;\">[value]</code> part, tells it to run\n      only when <code style=\"white-space: pre-wrap;\">value</code> changes.\n    </p>\n    <p>\n      No need to double check with a conditional. If your effect updates the\n      component itself through a state setter, the second argument acts as a\n      <code style=\"white-space: pre-wrap;\">shouldComponentUpdate</code> of\n      sorts.\n    </p>\n    <p>\n      When you return a method from\n      <code style=\"white-space: pre-wrap;\">useEffect</code>, it acts as a\n      <code style=\"white-space: pre-wrap;\">componentWillUnmount</code>.\n      Listening to, say, your mouse position looks like this:\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb194\"\n      data-caption=\"A mouse listener hook\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb194-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> [mouseX<span class=\"op\" style=\"color: #666666;\">,</span> setMouseX] <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">useState</span>()<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb194-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> handleMouse <span class=\"op\" style=\"color: #666666;\">=</span> (e) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"at\" style=\"color: #7d9029;\">setMouseX</span>(<span class=\"va\" style=\"color: #19177c;\">e</span>.<span class=\"at\" style=\"color: #7d9029;\">screenX</span>)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb194-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb194-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"at\" style=\"color: #7d9029;\">useEffect</span>(() <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb194-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">window</span>.<span class=\"at\" style=\"color: #7d9029;\">addEventListener</span>(<span class=\"st\" style=\"color: #4070a0;\">&#39;mousemove&#39;</span><span class=\"op\" style=\"color: #666666;\">,</span> handleMouse)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb194-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> () <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"va\" style=\"color: #19177c;\">window</span>.<span class=\"at\" style=\"color: #7d9029;\">removeEventListener</span>(handleMouse)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb194-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span>)</a></code></pre>\n    </div>\n    <p>Neat :okay_hand:</p>\n    <h3 id=\"usecontext\">useContext</h3>\n    <p>\n      <code style=\"white-space: pre-wrap;\">useContext</code> cleans up your\n      render prop callbacky hell.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb195\"\n      data-caption=\"Context without hooks\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb195-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> SomeContext <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"va\" style=\"color: #19177c;\">React</span>.<span class=\"at\" style=\"color: #7d9029;\">createContext</span>()</a>\n<a class=\"sourceLine\" id=\"cb195-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb195-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb195-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb195-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">&lt;</span><span class=\"va\" style=\"color: #19177c;\">SomeContext</span>.<span class=\"at\" style=\"color: #7d9029;\">Consumer</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb195-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">  <span class=\"op\" style=\"color: #666666;\">{</span>state <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> ...<span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb195-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">&lt;/<span class=\"va\" style=\"color: #19177c;\">SomeContext</span>.<span class=\"at\" style=\"color: #7d9029;\">Consumer</span><span class=\"op\" style=\"color: #666666;\">&gt;</span></a></code></pre>\n    </div>\n    <p>👇</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb196\"\n      data-caption=\"Context with hooks\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb196-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> state <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">useContext</span>(SomeContext)</a></code></pre>\n    </div>\n    <p>\n      Context state becomes just a value in your function. React auto\n      subscribes to all updates.\n    </p>\n    <p>\n      And those are the core hooks. useState, useEffect, and useContext. You\n      can use them to build almost everything. :okay_hand:\n    </p>"
        },
        {
          "lectureTitle": "useMemo is your new best friend",
          "lectureBody": "    <h2 id=\"usememo-is-your-new-best-dataviz-friend\">\n      useMemo is your new best dataviz friend\n    </h2>\n    <p>\n      My favorite hook for making React and D3 work together is\n      <code style=\"white-space: pre-wrap;\">useMemo</code>. It’s like a\n      combination of <code style=\"white-space: pre-wrap;\">useEffect</code> and\n      <code style=\"white-space: pre-wrap;\">useState</code>.\n    </p>\n    <p>\n      Remember how the rest of this course focused on syncing D3’s internal\n      state with React’s internal state and complications around large datasets\n      and speeding up your D3 code to avoid recomputing on every render?\n    </p>\n    <p>\n      All that goes away with\n      <code style=\"white-space: pre-wrap;\">useMemo</code> – it memoizes values\n      returned from a function and recomputes them when particular props\n      change. Think of it like a cache.\n    </p>\n    <p>\n      Say you have a D3 linear scale. You want to update its range when your\n      component’s width changes.\n    </p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb197\"\n      data-caption=\"useMemo for a scale\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb197-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> <span class=\"at\" style=\"color: #7d9029;\">MyComponent</span>(<span class=\"op\" style=\"color: #666666;\">{</span> data<span class=\"op\" style=\"color: #666666;\">,</span> width <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb197-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> scale <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">useMemo</span>(() <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb197-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">        <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">scaleLinear</span>()</a>\n<a class=\"sourceLine\" id=\"cb197-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">domain</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> <span class=\"dv\" style=\"color: #40a070;\">1</span>])</a>\n<a class=\"sourceLine\" id=\"cb197-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">            .<span class=\"at\" style=\"color: #7d9029;\">range</span>([<span class=\"dv\" style=\"color: #40a070;\">0</span><span class=\"op\" style=\"color: #666666;\">,</span> width])</a>\n<a class=\"sourceLine\" id=\"cb197-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    )<span class=\"op\" style=\"color: #666666;\">,</span> [width])</a>\n<a class=\"sourceLine\" id=\"cb197-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb197-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>g<span class=\"op\" style=\"color: #666666;\">&gt;</span> ... &lt;/g<span class=\"op\" style=\"color: #666666;\">&gt;</span></a>\n<a class=\"sourceLine\" id=\"cb197-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a></code></pre>\n    </div>\n    <p>\n      <code style=\"white-space: pre-wrap;\">useMemo</code> takes a function that\n      returns a value to be memoized. In this case that’s the linear scale.\n    </p>\n    <p>\n      You create the scale same way you always would. Initiate a scale, set the\n      domain, update the range. No fancypants trickery.\n    </p>\n    <p>\n      <code style=\"white-space: pre-wrap;\">useMemo</code>’s second argument\n      works much like useEffect’s does: It tells React which values to observe\n      for change. When that value changes,\n      <code style=\"white-space: pre-wrap;\">useMemo</code> reruns your function\n      and gets a new scale.\n    </p>\n    <p>\n      Don’t rely on <code style=\"white-space: pre-wrap;\">useMemo</code> running\n      only once however. Memoization is meant as a performance optimization, a\n      hint if you will, not as a syntactical guarantee of uniqueness.\n    </p>\n    <p>\n      And that’s exactly what we want. No more futzing around with\n      <code style=\"white-space: pre-wrap;\">getDerivedStateFromProps</code> and\n      <code style=\"white-space: pre-wrap;\">this.state</code>. Just\n      <code style=\"white-space: pre-wrap;\">useMemo</code> and leave the rest to\n      React. ✌️\n    </p>"
        },
        {
          "lectureTitle": "my useD3 hook",
          "lectureBody": "    <h2 id=\"my-used3-hook\">my useD3 hook</h2>\n    <p>\n      Remember when we talked about D3 blackbox rendering? I built a hook for\n      that so you don’t have to mess around with HOCs anymore 😃\n    </p>\n    <p>\n      Read the full docs at\n      <a href=\"https://d3blackbox.com/\">d3blackbox.com</a>\n    </p>\n    <p>\n      It works as a combination of\n      <code style=\"white-space: pre-wrap;\">useRef</code> and\n      <code style=\"white-space: pre-wrap;\">useEffect</code>. Hooks into\n      component re-renders, gives you control of the anchor element, and\n      re-runs your D3 render function on every component render.\n    </p>\n    <p>You use it like this:</p>\n    <div\n      class=\"sourceCode\"\n      id=\"cb198\"\n      data-caption=\"useD3 for quick integrations\"\n      style=\"overflow: visible; margin: 1em 0;\"\n    >\n      <pre\n        class=\"sourceCode javascript\"\n        style=\"overflow: visible; margin: 0;\"\n      ><code class=\"sourceCode javascript\" style=\"overflow: visible; white-space: pre; position: relative;\"><a class=\"sourceLine\" id=\"cb198-1\" title=\"1\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"im\">import</span> <span class=\"op\" style=\"color: #666666;\">{</span> useD3 <span class=\"op\" style=\"color: #666666;\">}</span> <span class=\"im\">from</span> <span class=\"st\" style=\"color: #4070a0;\">&quot;d3blackbox&quot;</span><span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb198-2\" title=\"2\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">function</span> <span class=\"at\" style=\"color: #7d9029;\">renderSomeD3</span>(anchor) <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb198-3\" title=\"3\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"va\" style=\"color: #19177c;\">d3</span>.<span class=\"at\" style=\"color: #7d9029;\">select</span>(anchor)<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb198-4\" title=\"4\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"co\" style=\"color: #60a0b0; font-style: italic;\">// ...</span></a>\n<a class=\"sourceLine\" id=\"cb198-5\" title=\"5\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">}</span></a>\n<a class=\"sourceLine\" id=\"cb198-6\" title=\"6\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit; height: 1.2em;\"></a>\n<a class=\"sourceLine\" id=\"cb198-7\" title=\"7\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> MyD3Component <span class=\"op\" style=\"color: #666666;\">=</span> (<span class=\"op\" style=\"color: #666666;\">{</span> x<span class=\"op\" style=\"color: #666666;\">,</span> y <span class=\"op\" style=\"color: #666666;\">}</span>) <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"op\" style=\"color: #666666;\">{</span></a>\n<a class=\"sourceLine\" id=\"cb198-8\" title=\"8\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">const</span> refAnchor <span class=\"op\" style=\"color: #666666;\">=</span> <span class=\"at\" style=\"color: #7d9029;\">useD3</span>(anchor <span class=\"kw\" style=\"color: #007020; font-weight: bold;\">=&gt;</span> <span class=\"at\" style=\"color: #7d9029;\">renderSomeD3</span>(anchor))<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb198-9\" title=\"9\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\">    <span class=\"cf\" style=\"color: #007020; font-weight: bold;\">return</span> <span class=\"op\" style=\"color: #666666;\">&lt;</span>g ref<span class=\"op\" style=\"color: #666666;\">={</span>refAnchor<span class=\"op\" style=\"color: #666666;\">}</span> transform<span class=\"op\" style=\"color: #666666;\">={</span><span class=\"vs\" style=\"color: #4070a0;\">`translate(</span><span class=\"sc\" style=\"color: #4070a0;\">${</span>x<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">, </span><span class=\"sc\" style=\"color: #4070a0;\">${</span>y<span class=\"sc\" style=\"color: #4070a0;\">}</span><span class=\"vs\" style=\"color: #4070a0;\">)`</span><span class=\"op\" style=\"color: #666666;\">}</span> /&gt;<span class=\"op\" style=\"color: #666666;\">;</span></a>\n<a class=\"sourceLine\" id=\"cb198-10\" title=\"10\" style=\"display: inline-block; line-height: 1.25; pointer-events: none; color: inherit; text-decoration: inherit;\"><span class=\"op\" style=\"color: #666666;\">};</span></a></code></pre>\n    </div>\n    <p>\n      You’ll see how this works in more detail when we refactor the big example\n      to hooks. We’ll use <code style=\"white-space: pre-wrap;\">useD3</code> to\n      build axes.\n    </p>"
        },
        {
          "lectureTitle": "Refactoring our big example to hooks",
          "lectureBody": "    <h2 id=\"refactoring-our-big-example-to-hooks\">\n      Refactoring our big example to hooks\n    </h2>\n    <p>\n      I considered writing this section out as text, but I don’t think that’s\n      the best way to learn about refactoring. Too many moving pieces. You\n      should watch the videos 😃\n    </p>\n    <p>As always, they’re cut so you can enjoy bitesized pieces.</p>\n    <!--- end-section -->\n    <!--- end-section -->\n    <!--- begin-section title=\"You finished! 🚀\" -->\n    <!--- begin-lecture title=\"You're the best\" -->\n    <h1 id=\"conclusion\">Conclusion</h1>\n    <p>You finished the book! You’re my new favorite person \\o/</p>\n    <p>\n      You’ve built a really big interactive data visualization, a few silly\n      animations, learned the basics of Redux and MobX, looked into rendering\n      your stuff on canvas, and considered React alternatives.\n    </p>\n    <p>\n      Right now you might be thinking\n      <em\n        >“How the hell does this all fit together to help me build interactive\n        graphs and charts?”</em\n      >\n      You’ve learned the building blocks!\n    </p>\n    <p>\n      First, you learned the basics. How to make React and D3 like each other,\n      how to approach rendering, what to do with state. Then you built a big\n      project to see how it fits together.\n    </p>\n    <p>\n      Then you learned animation basics. How to approach updating components\n      with fine grained control and how to do transitions. You learned that\n      tricks from the gaming industry work here, too.\n    </p>\n    <p>You’re an expert React slinger now! I think that’s awesome.</p>\n    <p>\n      Even if you didn’t build the projects, you still learned the theory. When\n      the right problem presents itself, you’ll think of this book and remember\n      what to do. Or at least know where to look to find a solution.\n    </p>\n    <p>\n      At the very least, you know where to look to find a solution. This book\n      is yours forever.\n    </p>\n    <p>\n      I hope you have enjoyed this book. Tweet\n      <a href=\"https://twitter.com/Swizec\">@Swizec</a> and tell me what you’re\n      building. 😄\n    </p>\n    <p>\n      Questions? Poke me on twitter. I’m\n      <a href=\"https://twitter.com/Swizec\">@Swizec</a>. Or send me an email to\n      <a href=\"mailto:hi@swizec.com\">hi@swizec.com</a>. I read every email and\n      reply on a best effort basis.\n    </p>"
        }
      ]
    }
  ]
}
